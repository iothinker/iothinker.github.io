<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>é—²ç½®çš„æ‰‹æœºå¯ä»¥è¿™æ ·ç©</title>
      <link href="2021/04/14/mobile/"/>
      <url>2021/04/14/mobile/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç°åœ¨çš„å®¶é‡Œï¼Œè°è¿˜æ²¡æœ‰å‡ ä¸ªæ—§æ‰‹æœºå•Šï¼Œå¯æ˜¯æ—§æ‰‹æœºç”¨å§ï¼Œä¸æƒ³ç”¨ï¼Œæ‰”äº†å§åˆå¯æƒœã€‚æ¢ä¸é”ˆé’¢è„¸ç›†å§ï¼Œåˆæ€•ä¿¡æ¯æ³„éœ²ã€‚ä»Šå¤©å’±å°±æŠŠè¿™ä¸ªé—²ç½®çš„æ‰‹æœºåˆ©ç”¨å…¶èµ·æ¥ã€‚</p></blockquote><h3 id="0-å‡†å¤‡å·¥ä½œ"><a href="#0-å‡†å¤‡å·¥ä½œ" class="headerlink" title="0.å‡†å¤‡å·¥ä½œ"></a>0.å‡†å¤‡å·¥ä½œ</h3><hr><p>é¦–å…ˆå¾—ä¸‹è½½ä¸ªè½¯ä»¶ï¼Œåå­—å« <strong>IP æ‘„åƒå¤´</strong> æ‰¾æ‰¾ï¼Œåº”è¯¥æŒºå¤šçš„ã€‚æˆ‘ç”¨çš„æ˜¯ä¸‹é¢å›¾æ ‡çš„è½¯ä»¶</p><p><img src="/img/20210414/tubiao.png" alt="è½¯ä»¶å›¾æ ‡"></p><p>æˆ‘ç”¨çš„æ˜¯å…è´¹ç‰ˆçš„ï¼Œç›‘æ§æ˜¯å¤Ÿäº†ã€‚</p><p><img src="/img/20210414/jietu0.jpg" alt="è½¯ä»¶æˆªå›¾"></p><p>æ‰“å¼€è½¯ä»¶ï¼Œç‚¹å‡»ä¸‹æ–¹çš„æ‰“å¼€IPæ‘„åƒå¤´æœåŠ¡å™¨å°±è¡Œäº†ï¼Œåœ¨æ–°çš„é¡µé¢ä¸Šæœ‰æµè§ˆçš„åœ°å€ï¼Œåœ¨æµè§ˆä¸Šè¾“å…¥åœ°å€å°±èƒ½å¤Ÿçœ‹åˆ°å›¾åƒäº†ã€‚</p><h3 id="1-æ¥å…¥HA"><a href="#1-æ¥å…¥HA" class="headerlink" title="1.æ¥å…¥HA"></a>1.æ¥å…¥HA</h3><hr><p>æ¥å…¥HAå¾ˆç®€å•ï¼Œç…§ç€ä¸‹é¢é…ç½®ä¸€ä¸‹å°±è¡Œï¼Œä¿¡æ¯åœ¨æ‰“å¼€æœåŠ¡å™¨åä¼šåœ¨ä¸‹æ–¹æ˜¾ç¤ºçš„ã€‚ç”¨æä¾›çš„ä¿¡æ¯å¡«å†™å®Œæ•´å°±è¡Œã€‚ç”¨æˆ·åå¯†ç æ˜¯è‡ªå·±è®¾çš„ã€‚</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">android_ip_webcam</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> æ‰‹æœºçš„IPåœ°å€    <span class="token key atrule">port</span><span class="token punctuation">:</span> ç«¯å£    <span class="token key atrule">name</span><span class="token punctuation">:</span> IPCam0    <span class="token key atrule">username</span><span class="token punctuation">:</span> ç”¨æˆ·å    <span class="token key atrule">password</span><span class="token punctuation">:</span> å¯†ç <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‡å¯ä¸€ä¸‹HAï¼Œåœ¨é¡µé¢ä¸Šæ·»åŠ ä¸€ä¸‹è¿™ä¸ªä¼ æ„Ÿå™¨ã€‚å¦‚æœè¦å®ç°å®æ—¶é¢„è§ˆï¼Œå¯ä»¥ä½¿ç”¨ picture-entity è¿™ä¸ªå¡ç‰‡ï¼Œè®¾ç½®å¦‚ä¸‹</p><p><img src="/img/20210414/jietu1.png" alt="è½¯ä»¶æˆªå›¾"></p><p>è®°å¾—è¦é€‰ä¸Šliveå“¦ï¼Œåˆ°æ­¤HAæ¥å…¥å®Œæ¯•</p><h3 id="2-æ¥å…¥HB"><a href="#2-æ¥å…¥HB" class="headerlink" title="2.æ¥å…¥HB"></a>2.æ¥å…¥HB</h3><hr><p>æˆ‘åœ¨ç¾¤æ™–ä¸Šç”¨dockeræ­äº†ä¸ªHBï¼Œæ‰€ä»¥è‡ªç„¶ä¹Ÿæƒ³æ¥å…¥ä»–ï¼Œæ¥å…¥ä¹‹åå°±å¯ä»¥ä½¿ç”¨è‹¹æœçš„å®¶åº­æŸ¥çœ‹å½•åƒäº†ã€‚æ­å»ºHBçš„æ•™ç¨‹ç½‘ä¸Šæœ‰çš„ï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†ã€‚è¯´ä¸€ä¸‹æˆ‘å½“æ—¶æ¥å…¥çš„å‘å§ã€‚æˆ‘çš„HBæ­å»ºçš„æœ‰ç‚¹æ—©äº†ï¼Œnodejsçš„ç‰ˆæœ¬è¿˜å¾ˆä½çš„ï¼Œå¯¼è‡´æˆ‘è£…æ’ä»¶è£…äº†åŠå¤©éƒ½ä¸è¡Œï¼Œæ¢äº†å¥½å‡ ä¸ªå¹³å°éƒ½æ²¡ç”¨ï¼Œåé¢æ‹‰äº†ä¸€ä¸ªæ–°çš„é•œåƒå°±è¡Œäº†ï¼Œæ‰€ä»¥å»ºè®®å¤§å®¶è¿˜æ˜¯æ‹‰å–æœ€æ–°çš„é•œåƒå§ã€‚è¿™æ˜¯<a href="https://www.npmjs.com/package/homebridge-ip-camera">æ’ä»¶çš„ä»‹ç»é¡µ</a>å¤§å®¶å¯ä»¥å‚è€ƒç€é…ç½®å’Œå®‰è£…ã€‚ç»™å¤§å®¶çœ‹çœ‹æˆ‘çš„é…ç½®</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>         <span class="token property">"platform"</span><span class="token operator">:</span> <span class="token string">"Camera-IP"</span><span class="token punctuation">,</span>         <span class="token property">"cameras"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token punctuation">{</span>               <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"My Camera"</span><span class="token punctuation">,</span>               <span class="token property">"videoConfig"</span><span class="token operator">:</span> <span class="token punctuation">{</span>                   <span class="token property">"source"</span><span class="token operator">:</span> <span class="token string">"-re -i http://username:password@IP:PORT"</span><span class="token punctuation">,</span>                   <span class="token property">"maxStreams"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>                   <span class="token property">"maxWidth"</span><span class="token operator">:</span> <span class="token number">1280</span><span class="token punctuation">,</span>                   <span class="token property">"maxHeight"</span><span class="token operator">:</span> <span class="token number">720</span><span class="token punctuation">,</span>                   <span class="token property">"maxFPS"</span><span class="token operator">:</span> <span class="token number">60</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token punctuation">,</span>            <span class="token punctuation">{</span>               <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"My Camera0"</span><span class="token punctuation">,</span>               <span class="token property">"videoConfig"</span><span class="token operator">:</span> <span class="token punctuation">{</span>                   <span class="token property">"source"</span><span class="token operator">:</span> <span class="token string">"-re -i http://username:password@IP:PORT"</span><span class="token punctuation">,</span>                   <span class="token property">"maxStreams"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>                   <span class="token property">"maxWidth"</span><span class="token operator">:</span> <span class="token number">1280</span><span class="token punctuation">,</span>                   <span class="token property">"maxHeight"</span><span class="token operator">:</span> <span class="token number">720</span><span class="token punctuation">,</span>                   <span class="token property">"maxFPS"</span><span class="token operator">:</span> <span class="token number">60</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token punctuation">]</span>      <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‡å¯ä¹‹åç”¨è‹¹æœå®¶åº­æ·»åŠ æ–°è®¾å¤‡å°±è¡Œäº†ã€‚</p><p>çœ‹çœ‹æ¥å…¥åçš„æ•ˆæœï¼š</p><p><img src="/img/20210414/jietu2.jpg" alt="æ¥å…¥æˆªå›¾"></p><h3 id="3-æ€»ç»“"><a href="#3-æ€»ç»“" class="headerlink" title="3.æ€»ç»“"></a>3.æ€»ç»“</h3><hr><p>å¦‚æœè¦ä¸€ç›´èƒ½çœ‹åˆ°çš„è¯ï¼Œå°±å¾—ä¸€ç›´å¼€ç€æ‰‹æœºæ‰è¡Œçš„ã€‚å¯èƒ½æœ‰ç‚¹è´¹ç”µï¼Œä½†æ˜¯æ‰‹æœºè¿˜æ˜¯å‘æŒ¥äº†ä»–çš„ä½™çƒ­ã€‚å®¶é‡Œçš„å·²ç»åšäº†å†…ç½‘ç©¿é€ï¼ŒHAå¯ä»¥å¤–ç½‘è®¿é—®ï¼Œåœ¨å…¶ä¸­çš„æ‘„åƒå¤´è‡ªç„¶ä¹Ÿå¯ä»¥å¤–ç½‘è®¿é—®äº†ã€‚HBçš„è¯éœ€è¦å®¶é‡Œæœ‰ä¸€ä¸ªIPadï¼ŒHomePodæˆ–è€…å…¶ä»–æ”¯æŒçš„è®¾å¤‡ä½œä¸ºå®¶åº­ä¸­æ¢ï¼Œå°±å¯ä»¥åœ¨å¤–é¢ä¹Ÿå¯ä»¥è®¿é—®äº†ã€‚è¿˜æ˜¯å¾ˆæ£’çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ™ºèƒ½å®¶å±… </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HA </tag>
            
            <tag> é—²ç½®åˆ©ç”¨ </tag>
            
            <tag> æ‘„åƒå¤´ </tag>
            
            <tag> HB </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HAä¸­ç‡ƒæ’ä»¶</title>
      <link href="2021/04/13/gas/"/>
      <url>2021/04/13/gas/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è¿™æ˜¯ä¸­ç‡ƒçš„ç‡ƒæ°”æ’ä»¶ï¼ŒæŠ“åŒ…åçš„apiè¿˜æ˜¯æ¯”è¾ƒå‹å¥½çš„</p></blockquote><h3 id="0-æŠ“åŒ…"><a href="#0-æŠ“åŒ…" class="headerlink" title="0.æŠ“åŒ…"></a>0.æŠ“åŒ…</h3><hr><p>æŒ‰ç…§å›½é™…æƒ¯ä¾‹ï¼Œé¦–å…ˆæŠ“åŒ…ã€‚ä»å°ç¨‹åºå…¥æ‰‹ï¼Œå¾®ä¿¡æœç´¢ <strong>ä¸­ç‡ƒæ…§ç”Ÿæ´»</strong> ã€‚ç„¶åæ‰“å¼€æŠ“åŒ…å·¥å…·ï¼Œå¼€å§‹æŠ“åŒ…å³å¯</p><h3 id="1-åˆ†ææŠ“åŒ…æ•°æ®"><a href="#1-åˆ†ææŠ“åŒ…æ•°æ®" class="headerlink" title="1.åˆ†ææŠ“åŒ…æ•°æ®"></a>1.åˆ†ææŠ“åŒ…æ•°æ®</h3><hr><p>ä¸­ç‡ƒçš„æ¥å£è¿˜æ˜¯æŒºå‹å¥½çš„ï¼Œéƒ½æ˜¯jsonæ ¼å¼çš„ã€‚æŸ¥çœ‹æŠ“åŒ…çš„æ•°æ®ï¼Œæ‰¾åˆ°è¿™ä¹ˆä¸€ä¸ªåœ°å€ <strong><a href="https://zrds.zrhsh.com/controller/payfee/getcustomerMoneyListForMp.do">https://zrds.zrhsh.com/controller/payfee/getcustomerMoneyListForMp.do</a></strong> ï¼Œè¿™ä¸ªåœ°å€é‡Œé¢æœ‰å’±æƒ³è¦çš„æ•°æ®ã€‚æ•°æ®å’±å°±ä¸è´´äº†ï¼Œéƒ½æ˜¯çœ‹çš„åˆ°çš„ã€‚</p><h3 id="2-å¼€å‘æ’ä»¶"><a href="#2-å¼€å‘æ’ä»¶" class="headerlink" title="2.å¼€å‘æ’ä»¶"></a>2.å¼€å‘æ’ä»¶</h3><hr><p>åˆ†ææ•°æ®ï¼Œæ’ä»¶ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""Support for zhongran gas# Author:    freefitter# Created:    2020/9/2"""</span><span class="token keyword">import</span> logging<span class="token keyword">import</span> json<span class="token keyword">import</span> datetime<span class="token keyword">from</span> dateutil<span class="token punctuation">.</span>relativedelta <span class="token keyword">import</span> relativedelta <span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>const <span class="token keyword">import</span> <span class="token punctuation">(</span>    CONF_API_KEY<span class="token punctuation">,</span> CONF_NAME<span class="token punctuation">,</span> ATTR_ATTRIBUTION<span class="token punctuation">,</span> CONF_ID    <span class="token punctuation">)</span><span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>helpers<span class="token punctuation">.</span>entity <span class="token keyword">import</span> Entity<span class="token keyword">import</span> homeassistant<span class="token punctuation">.</span>helpers<span class="token punctuation">.</span>config_validation <span class="token keyword">as</span> cv<span class="token keyword">import</span> voluptuous <span class="token keyword">as</span> vol<span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>components<span class="token punctuation">.</span>sensor <span class="token keyword">import</span> PLATFORM_SCHEMA<span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup_Log<span class="token operator">=</span>logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>DEFAULT_NAME <span class="token operator">=</span> <span class="token string">'zrgas'</span>CUSTCODE <span class="token operator">=</span> <span class="token string">'custCode'</span>PLATFORM_SCHEMA <span class="token operator">=</span> PLATFORM_SCHEMA<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>    vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>CUSTCODE<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>    vol<span class="token punctuation">.</span>Optional<span class="token punctuation">(</span>CONF_NAME<span class="token punctuation">,</span> default<span class="token operator">=</span> DEFAULT_NAME<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>HEADERS <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">,</span>    <span class="token string">'Upgrade-Insecure-Requests'</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>    <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'</span><span class="token punctuation">,</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (iPhone; CPU iPhone OS 12_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 MicroMessenger/7.0.5(0x17000523) NetType/WIFI Language/zh_CN'</span><span class="token punctuation">}</span>API_URL <span class="token operator">=</span> <span class="token string">"https://zrds.zrhsh.com/controller/payfee/getcustomerMoneyListForMp.do"</span><span class="token keyword">def</span> <span class="token function">setup_platform</span><span class="token punctuation">(</span>hass<span class="token punctuation">,</span> config<span class="token punctuation">,</span> add_devices<span class="token punctuation">,</span> discovery_info<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    custCode <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>CUSTCODE<span class="token punctuation">)</span>    sensor_name <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>CONF_NAME<span class="token punctuation">)</span>    today <span class="token operator">=</span> datetime<span class="token punctuation">.</span>date<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span>    current_month <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span>today<span class="token punctuation">,</span> <span class="token string">"%Y%m"</span><span class="token punctuation">)</span>            last_2_month <span class="token operator">=</span> today <span class="token operator">+</span> relativedelta<span class="token punctuation">(</span>months<span class="token operator">=</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>    last_two_month <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span>last_2_month<span class="token punctuation">,</span> <span class="token string">"%Y%m"</span><span class="token punctuation">)</span>        data_dict <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">'custCode'</span><span class="token punctuation">:</span> custCode<span class="token punctuation">,</span>        <span class="token string">'envir'</span><span class="token punctuation">:</span><span class="token string">'2'</span><span class="token punctuation">,</span>        <span class="token string">'startTime'</span><span class="token punctuation">:</span>last_two_month<span class="token punctuation">,</span>        <span class="token string">'endTime'</span><span class="token punctuation">:</span>current_month<span class="token punctuation">,</span>    <span class="token punctuation">}</span>    add_devices<span class="token punctuation">(</span><span class="token punctuation">[</span>ZRGas<span class="token punctuation">(</span>sensor_name<span class="token punctuation">,</span>data_dict<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">ZRGas</span><span class="token punctuation">(</span>Entity<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Representation of a Nanjing water """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>sensor_name<span class="token punctuation">,</span>data_dict<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>attributes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token boolean">None</span>        self<span class="token punctuation">.</span>_data_dict <span class="token operator">=</span> data_dict        self<span class="token punctuation">.</span>_name <span class="token operator">=</span> sensor_name    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the name of the sensor."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_name    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">state</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the state of the sensor."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_state    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">icon</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""è¿”å›mdiå›¾æ ‡."""</span>        <span class="token keyword">return</span> <span class="token string">'mdi:fire'</span>    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">device_state_attributes</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the state attributes."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>attributes    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">unit_of_measurement</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the unit this state is expressed in."""</span>        <span class="token keyword">return</span> <span class="token string">"å…ƒ"</span>    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>API_URL<span class="token punctuation">,</span>params<span class="token operator">=</span>self<span class="token punctuation">.</span>_data_dict<span class="token punctuation">,</span>headers <span class="token operator">=</span> HEADERS<span class="token punctuation">)</span>        <span class="token keyword">except</span> ReadTimeout<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Connection timeout...."</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> ConnectionError<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Connection Error...."</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> RequestException<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Unknown Error"</span><span class="token punctuation">)</span>        res <span class="token operator">=</span> response<span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>res<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"receivable"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'recordMonth'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"recordMonth"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'curRecord'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"curRecord"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'curQty'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"curQty"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'balance'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"balance"</span><span class="token punctuation">]</span>         self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'received'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"received"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'laterFee'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"laterFee"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'lastRecord'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"lastRecord"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'timeCurRecord'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"timeCurRecord"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-é…ç½®HA"><a href="#4-é…ç½®HA" class="headerlink" title="4.é…ç½®HA"></a>4.é…ç½®HA</h3><hr><p>æ’ä»¶éœ€è¦å®¢æˆ·å·ï¼Œä¸Šé¢æŠ“åŒ…çš„è¯·æ±‚å°±æœ‰ï¼Œæ‹¿å°±å®Œäº‹äº†ã€‚æ¥ç€ç…§ç€ä¸‹é¢é…ç½®å°±è¡Œã€‚é…ç½®å®Œæˆåï¼Œé‡å¯HAå°±è¡Œäº†</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> zrgas    <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'ç‡ƒæ°”è´¹'</span>    <span class="token key atrule">custCode</span><span class="token punctuation">:</span> <span class="token string">'XXXXXXX'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="5-æˆæœå±•ç¤º"><a href="#5-æˆæœå±•ç¤º" class="headerlink" title="5.æˆæœå±•ç¤º"></a>5.æˆæœå±•ç¤º</h3><p><img src="/img/20210413/gas.jpg" alt="æ’ä»¶å±•ç¤º"></p><p>è‡³æ­¤ï¼Œå®¶é‡Œçš„æ°´ç”µç‡ƒæ°”å·²ç»æ¥å…¥å®Œæ¯•ï¼Œåé¢å†æŠŠå…¶ä»–çš„æ•´ç†æ•´ç†ï¼Œåˆ†äº«å‡ºæ¥ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ™ºèƒ½å®¶å±… </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HA </tag>
            
            <tag> python </tag>
            
            <tag> æ’ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘¨æœ«è®°äº‹</title>
      <link href="2021/04/12/dayshare21412/"/>
      <url>2021/04/12/dayshare21412/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åˆæ˜¯ä¸€ä¸ªå¹³å¸¸çš„å‘¨æœ«ï¼Œå‘¨æœ«å°±è¯¥å¸¦å¨ƒï¼Œé›å¨ƒï¼Œå¤šå›¾å’Œè§†é¢‘é¢„è­¦</p></blockquote><h3 id="0-ç¬¬ä¸€å¤©"><a href="#0-ç¬¬ä¸€å¤©" class="headerlink" title="0.ç¬¬ä¸€å¤©"></a>0.ç¬¬ä¸€å¤©</h3><p>å‘¨å…­æ˜¯ä¸€èŠ‚äº²å­è¯¾ï¼Œ9:00ä¸Šè¯¾ã€‚å¿™å¿™å¼„å¼„è¿˜æ˜¯è¿Ÿåˆ°äº†ä¸€ä¼šã€‚å­¦ä¹ è·¯çº¿å’Œå¾€å¸¸ä¸€æ ·ï¼Œè’™æ°çº¿ï¼Œç„¶åæ˜¯å„¿æ­Œç¯èŠ‚ï¼Œæ¥ç€æ˜¯ç©å…·çš„æ•™å­¦ï¼Œæœ€åä¸€ä¸ªå¤§åŠ¨ä½œã€‚è¿™æ¬¡ç©å…·æ˜¯å¥—æ¯ï¼Œè®©å¥¹æ„ŸçŸ¥å¤§å°ã€‚å¤§åŠ¨ä½œæ˜¯æµ·æ´‹çƒçš„æŠ•æ·ï¼Œå°±æ˜¯å°†æµ·æ´‹çƒæŠ•æ·è¿‡å¤§åœ†ç¯ã€‚</p><p>ä¸€å¼€å§‹çš„è‡ªæˆ‘ä»‹ç»ï¼Œ</p><p><img src="/img/20210412/1.0.jpg" alt="è®¤çœŸå¬è¯¾"></p><p>ä¸­é—´çš„ç©å…·å…‰é™ªå¥¹ç©äº†ï¼Œæ²¡æ‹ç…§ã€‚å¤§åŠ¨ä½œçš„æ—¶å€™æ‹äº†ï¼Œæ„Ÿè§‰å¥¹ä¸å–œæ¬¢æŠ•æ·ï¼Œæ›´å–œæ¬¢å¤§åœ†ç¯æœ¬èº«<span class="github-emoji"><span>ğŸ˜‚</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> </p><p><img src="/img/20210412/1.1.jpg" alt="çˆ±ç©å¤§åœ†ç¯"></p><p>ä¸Šè¯¾ç»“æŸåè¦å»è¶Ÿæ±Ÿå—ï¼Œå¼€è½¦å®åœ¨æ˜¯å µï¼Œä¹Ÿä¸å¥½åœè½¦ï¼Œæ‰€ä»¥å°±å‡†å¤‡å¼€è½¦å»ã€‚è¿™æ˜¯å°å®¶ä¼™ç¬¬äºŒæ¬¡ååœ°é“ã€‚æ„Ÿè§‰æ¯”ç¬¬ä¸€æ¬¡å¥½å¾ˆå¤šäº†ã€‚åœ°é“ä¸Šæœ‰ä¸ªå¤§å“¥å“¥ç»™æˆ‘ä»¬è®©äº†åº§ï¼Œåä¸‹æ¥çš„å½¤å½¤è¿˜æ˜¯å¾ˆä¹–çš„å“¦ã€‚</p><p><img src="/img/20210412/1.2.jpg" alt="ååœ°é“çš„å½¤å½¤"></p><p>åˆ°äº†ä¹‹åï¼Œå¦ˆå¦ˆå»çœ‹äº†å½¤å½¤å¤–å©†äº†ï¼Œæˆ‘è´Ÿè´£åœ¨æ¥¼ä¸‹å¸¦ç€å¥¹ï¼Œä¸€å¼€å§‹å–ç€æœæ±ï¼Œè¿˜æ˜¯å¾ˆä¹–çš„ï¼Œæœæ±å–å®Œäº†ä¹‹åå°±è¦ä¸‹æ¥è·‘ã€‚ä¸‹æ¥ä¹‹åï¼Œå¥¹å°±æ˜¯è„±ç¼°çš„é‡é©¬ï¼Œå››å¤„è·‘ï¼Œæˆ‘æ ¹æœ¬æ— æš‡é¡¾åŠå…¶ä»–ï¼Œå°è½¦æ”¾åœ¨ä¸€è¾¹ã€‚ä¸‹é¢çœ‹çœ‹è·‘åŠ¨çš„å½¤ã€‚äººåƒæ¨¡å¼æ²¡Pï¼Œé¢œå€¼å¾ˆæ˜¯èƒ½æ‰“çš„å§ï¼Œ<span class="github-emoji"><span>ğŸ˜†</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f606.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> </p><p><img src="/img/20210412/1.3.jpg" alt="è·‘åŠ¨ä¸­çš„å½¤"></p><p>äº‹æƒ…åŠå®Œä¹‹åå°±å»é€›äº†é€›å•†åœºã€‚é€›å®Œä¹‹åä¹Ÿä¸æ—©äº†ï¼Œå°±åœ¨é‚£è¾¹åƒäº†ä¸ªæ™šé¥­ã€‚ä¸‹é¢çœ‹çœ‹ç¥åŒæ­¥çš„çœ¼ç¥</p><p><img src="/img/20210412/1.4.jpg" alt="ç¥åŒæ­¥"></p><p><img src="/img/20210412/1.5.jpg" alt="ç¥åŒæ­¥"></p><p>ä»Šå¤©ç©å¾—å¤ªæ™šäº†ï¼Œå›å®¶æ¾¡éƒ½ä¸æ„¿æ„æ´—ã€‚</p><h3 id="1-ç¬¬äºŒå¤©"><a href="#1-ç¬¬äºŒå¤©" class="headerlink" title="1.ç¬¬äºŒå¤©"></a>1.ç¬¬äºŒå¤©</h3><p>å‘¨æ—¥æ˜¯æ„Ÿç»Ÿè¯¾ï¼Œæ—©ä¸Šèµ·æ¥ä¹‹åå¸¦å¥¹ç©ç©ç»™ä»–å¼„ä¸ªåˆé¥­ï¼Œç¡ä¸ªåˆè§‰å°±å‡ºå‘äº†ã€‚è¿™æ¬¡æ²¡è¿Ÿåˆ°ï¼Œæ—©æ—©åˆ°äº†ã€‚ä»Šå¤©çš„æ„Ÿç»Ÿè¯¾æ˜¯é”»ç‚¼æ‰‹è‡‚åŠ›é‡ã€‚è¿˜æ˜¯å¥—åœˆï¼Œèµ°ç»ç’ƒçš„æ–œå¡ï¼Œè¹¦åºŠï¼Œä¹‹åå°±æ˜¯çˆ¬æ»šç­’ã€‚è¿™æ¬¡çš„æ„Ÿç»Ÿè¯¾å½¤å½¤è¡¨ç°çš„éƒ½å¾ˆå¥½ï¼Œå¾ˆå¤šèƒ½å¤Ÿè‡ªå·±ç‹¬ç«‹å®Œæˆã€‚å®Œæˆå¤§æ¸¸æˆä¹‹åå°±æ˜¯æ³¡æ³¡ç¯èŠ‚ï¼Œå¸Œæœ›ä»–ä»¬èƒ½å¤Ÿç”¨è‡ªå·±çš„ä¸€æ ¹æ‰‹æŒ‡å¤´å»æ¥ä½æ³¡æ³¡ï¼Œé”»ç‚¼ä»–ä»¬çš„äº”æŒ‡åˆ†åŒ–èƒ½åŠ›ã€‚</p><p><img src="/img/20210412/2.0.jpg" alt="å¥—åœˆçš„å°å§‘å¨˜"></p><p><img src="/img/20210412/2.1.jpg" alt="èµ°ç»ç’ƒ"></p><p><img src="/img/20210412/2.2.jpg" alt="å¼€å¿ƒçš„æ³¡æ³¡ç¯èŠ‚"></p><p><img src="/img/20210412/2.3.jpg" alt="å¼€å¿ƒçš„æ³¡æ³¡ç¯èŠ‚"></p><p>ä¸‹é¢æ˜¯é­”æ€§çš„liveæŠ“æ³¡æ³¡</p><p><video src="/img/20210412/0.MOV" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><p><video src="/img/20210412/1.MOV" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><p><video src="/img/20210412/2.MOV" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><h3 id="3-ç»“è¯­"><a href="#3-ç»“è¯­" class="headerlink" title="3.ç»“è¯­"></a>3.ç»“è¯­</h3><p>å‘¨æœ«è¿˜æ˜¯å¾ˆå……å®çš„ï¼Œå½¤å½¤ç°åœ¨è¶Šæ¥è¶Šå‰å®³äº†ã€‚ä¸è¦ä¸€æˆä¸å˜ï¼Œè¦å˜å¾—æ›´å¥½ã€‚åŠ æ²¹ï¼</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®å® </tag>
            
            <tag> æ—©æ•™ </tag>
            
            <tag> å‘¨æœ« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ”¶è—ç½‘ç«™åˆ—è¡¨</title>
      <link href="2021/04/09/urlLists/"/>
      <url>2021/04/09/urlLists/</url>
      
        <content type="html"><![CDATA[<h3 id="0-ç´ æç±»ç½‘å€"><a href="#0-ç´ æç±»ç½‘å€" class="headerlink" title="0.ç´ æç±»ç½‘å€"></a>0.ç´ æç±»ç½‘å€</h3><ul><li><a href="https://www.pexels.com/zh-cn/">å…è´¹ç´ æå›¾ç‰‡</a></li><li><a href="https://www.flaticon.com/">å…è´¹SVGå›¾æ ‡</a></li><li><a href="http://tool.c7sky.com/webcolor/">ç½‘é¡µè®¾è®¡å¸¸ç”¨è‰²å½©æ­é…è¡¨</a></li><li><a href="https://www.17sucai.com/">17ç´ æç½‘</a></li></ul><h3 id="1-å·¥å…·ç±»ç½‘ç«™"><a href="#1-å·¥å…·ç±»ç½‘ç«™" class="headerlink" title="1.å·¥å…·ç±»ç½‘ç«™"></a>1.å·¥å…·ç±»ç½‘ç«™</h3><ul><li><a href="http://www.bejson.com/jsoneditoronline/">JSONåœ¨çº¿ç¼–è¾‘å™¨</a></li><li><a href="https://picsvg.com/">å…è´¹SVGè½¬æ¢</a></li><li><a href="http://playground.tensorflow.org/">ç¥ç»ç½‘ç»œ</a></li></ul><h3 id="2-å…è´¹API"><a href="#2-å…è´¹API" class="headerlink" title="2.å…è´¹API"></a>2.å…è´¹API</h3><ul><li><a href="http://zhwnlapi.etouch.cn/Ecalender/api/v2/weather?citykey=101190101">åé£æ–°å¤©æ°”API</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> å¤‡å¿˜ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½‘å€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQTT,Node-REDåˆæ¢</title>
      <link href="2021/04/08/mqttsensor/"/>
      <url>2021/04/08/mqttsensor/</url>
      
        <content type="html"><![CDATA[<h3 id="0-ç®€ä»‹"><a href="#0-ç®€ä»‹" class="headerlink" title="0.ç®€ä»‹"></a>0.ç®€ä»‹</h3><hr><p>MQTT ç®€ä»‹</p><blockquote><p>MQTT(æ¶ˆæ¯é˜Ÿåˆ—é¥æµ‹ä¼ è¾“)æ˜¯ISO æ ‡å‡†(ISO/IEC PRF 20922)ä¸‹åŸºäºå‘å¸ƒ/è®¢é˜…èŒƒå¼çš„æ¶ˆæ¯åè®®ã€‚å®ƒå·¥ä½œåœ¨ TCP/IPåè®®æ—ä¸Šï¼Œæ˜¯ä¸ºç¡¬ä»¶æ€§èƒ½ä½ä¸‹çš„è¿œç¨‹è®¾å¤‡ä»¥åŠç½‘ç»œçŠ¶å†µç³Ÿç³•çš„æƒ…å†µä¸‹è€Œè®¾è®¡çš„å‘å¸ƒ/è®¢é˜…å‹æ¶ˆæ¯åè®®ï¼Œä¸ºæ­¤ï¼Œå®ƒéœ€è¦ä¸€ä¸ªæ¶ˆæ¯ä¸­é—´ä»¶ ã€‚<br>MQTTæ˜¯ä¸€ä¸ªåŸºäºå®¢æˆ·ç«¯-æœåŠ¡å™¨çš„æ¶ˆæ¯å‘å¸ƒ/è®¢é˜…ä¼ è¾“åè®®ã€‚MQTTåè®®æ˜¯è½»é‡ã€ç®€å•ã€å¼€æ”¾å’Œæ˜“äºå®ç°çš„ï¼Œè¿™äº›ç‰¹ç‚¹ä½¿å®ƒé€‚ç”¨èŒƒå›´éå¸¸å¹¿æ³›ã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼ŒåŒ…æ‹¬å—é™çš„ç¯å¢ƒä¸­ï¼Œå¦‚ï¼šæœºå™¨ä¸æœºå™¨ï¼ˆM2Mï¼‰é€šä¿¡å’Œç‰©è”ç½‘ï¼ˆIoTï¼‰ã€‚å…¶åœ¨ï¼Œé€šè¿‡å«æ˜Ÿé“¾è·¯é€šä¿¡ä¼ æ„Ÿå™¨ã€å¶å°”æ‹¨å·çš„åŒ»ç–—è®¾å¤‡ã€æ™ºèƒ½å®¶å±…ã€åŠä¸€äº›å°å‹åŒ–è®¾å¤‡ä¸­å·²å¹¿æ³›ä½¿ç”¨ã€‚</p></blockquote><p>Node-REDç®€ä»‹</p><blockquote><p>Node-REDæ˜¯ä¸€æ¬¾åŸºäºNodeJSçš„æ„å»ºç‰©è”ç½‘åº”ç”¨ç¨‹åºçš„å¼ºå¤§å·¥å…·,å…¶é‡ç‚¹æ˜¯ç®€åŒ–ä»£ç å—çš„â€œè¿æ¥â€ä»¥æ‰§è¡Œä»»åŠ¡ã€‚å®ƒä½¿ç”¨å¯è§†åŒ–ç¼–ç¨‹æ–¹æ³•ï¼Œå…è®¸å¼€å‘äººå‘˜å°†é¢„å®šä¹‰çš„ä»£ç å—ï¼ˆç§°ä¸ºâ€œèŠ‚ç‚¹â€ï¼ŒNodeï¼‰è¿æ¥èµ·æ¥æ‰§è¡Œä»»åŠ¡ã€‚è¿æ¥çš„èŠ‚ç‚¹ï¼Œé€šå¸¸æ˜¯è¾“å…¥èŠ‚ç‚¹ã€å¤„ç†èŠ‚ç‚¹å’Œè¾“å‡ºèŠ‚ç‚¹çš„ç»„åˆï¼Œå½“å®ƒä»¬è¿æ¥åœ¨ä¸€èµ·æ—¶ï¼Œæ„æˆä¸€ä¸ªâ€œæµâ€(Flows)ã€‚<br>Node-REDæœ€åˆæ˜¯IBMåœ¨2013å¹´æœ«å¼€å‘çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œä»¥æ»¡è¶³ä»–ä»¬å¿«é€Ÿè¿æ¥ç¡¬ä»¶å’Œè®¾å¤‡åˆ°WebæœåŠ¡å’Œå…¶ä»–è½¯ä»¶çš„éœ€æ±‚â€”â€”ä½œä¸ºç‰©è”ç½‘çš„ä¸€ç§ç²˜åˆå‰‚ï¼Œå®ƒå¾ˆå¿«å‘å±•æˆä¸ºä¸€ç§é€šç”¨çš„ç‰©è”ç½‘ç¼–ç¨‹å·¥å…·ã€‚é‡è¦çš„æ˜¯ï¼ŒNode-REDå·²ç»è¿…é€Ÿå½¢æˆä¸€ä¸ªé‡è¦çš„ã€ä¸æ–­å¢é•¿çš„ç”¨æˆ·åŸºç¡€å’Œä¸€ä¸ªæ´»è·ƒçš„å¼€å‘äººå‘˜ç¤¾åŒºï¼Œä»–ä»¬æ­£åœ¨å¼€å‘æ–°çš„èŠ‚ç‚¹ï¼ŒåŒæ—¶å…è®¸ç¨‹åºå‘˜å¤ç”¨Node-REDä»£ç æ¥å®Œæˆå„ç§å„æ ·çš„ä»»åŠ¡ã€‚</p></blockquote><h3 id="1-é…ç½®HAä¸­çš„MQTT"><a href="#1-é…ç½®HAä¸­çš„MQTT" class="headerlink" title="1.é…ç½®HAä¸­çš„MQTT"></a>1.é…ç½®HAä¸­çš„MQTT</h3><hr><p>åœ¨ <strong>configuration.yaml</strong> ä¸­é…ç½®å¦‚ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">mqtt</span><span class="token punctuation">:</span>  <span class="token key atrule">discovery</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">discovery_prefix</span><span class="token punctuation">:</span> homeassistant  <span class="token key atrule">password</span><span class="token punctuation">:</span> XXXXXXX<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å…·ä½“é…ç½®å¯ä»¥å‚çœ‹ <a href="https://www.home-assistant.io/docs/mqtt/">å®˜æ–¹æ–‡æ¡£</a> ã€‚ é‡å¯HAå°±å¯ä»¥äº†ã€‚</p><h3 id="2-é…ç½®Node-RED"><a href="#2-é…ç½®Node-RED" class="headerlink" title="2.é…ç½®Node-RED"></a>2.é…ç½®Node-RED</h3><hr><p>è‡ªå·±å®‰è£…ä¸‹Node-Redã€‚æˆ‘æ˜¯åœ¨ç¾¤æ™–dockeré‡Œé¢è£…çš„ï¼Œ<a href="https://registry.hub.docker.com/r/nodered/node-red-docker/">é•œåƒè¯´æ˜</a> æ˜¯è¿™ä¸ªã€‚è¿™è¾¹æ˜¯ç½‘ä¸Šçš„<a href="https://www.feeus.com/%E7%BE%A4%E6%99%96%E4%BD%BF%E7%94%A8docker%E5%AE%89%E8%A3%85node-red/">å®‰è£…æ•™ç¨‹</a>å¯ä»¥å‚ç…§ç€å®‰è£…</p><p>å®‰è£…å¥½äº†æµè§ˆå™¨è¾“å…¥ <a href="http://192.168.xxx.xxx:1880/">http://192.168.XXX.XXX:1880/</a> å°±å¯ä»¥çœ‹åˆ°ç•Œé¢äº†ã€‚</p><p><img src="/img/20210408/nodered.png" alt="Node-REDç•Œé¢"></p><p>é…ç½®brokerï¼Œè¾“å…¥MQTTçš„IPå’Œç«¯å£ï¼Œä¸Šé¢é…ç½®äº†å¯†ç ï¼Œæ‰€ä»¥å®‰å…¨ä¸­è¦è¾“å…¥ä¸‹</p><p><img src="/img/20210408/mqtt0.png" alt="MQTTé…ç½®"></p><p><img src="/img/20210408/mqtt1.png" alt="MQTTé…ç½®"></p><p>é…ç½®å®Œäº†å°±å¯ä»¥ä½¿ç”¨äº†ã€‚</p><h3 id="3-ç»™ä¼ æ„Ÿå™¨æ³¨å…¥çµé­‚"><a href="#3-ç»™ä¼ æ„Ÿå™¨æ³¨å…¥çµé­‚" class="headerlink" title="3.ç»™ä¼ æ„Ÿå™¨æ³¨å…¥çµé­‚"></a>3.ç»™ä¼ æ„Ÿå™¨æ³¨å…¥çµé­‚</h3><hr><p>æŒ‰ç…§å›¾ç¤ºæ‹–æ‹½ç›¸å…³çš„èŠ‚ç‚¹</p><p><img src="/img/20210408/flow.jpg" alt="æµ"></p><p>ä¸‹é¢ä»¥å¾®åšçƒ­æœä¸ºä¾‹</p><p><a href="https://s.weibo.com/ajax/jsonp/gettopsug?uid=&amp;ref=PC_topsug&amp;url=https://s.weibo.com/weibo/%2525E7%2525BC%252585%2525E7%252594%2525B8%2525E4%2525BB%2525B0%2525E5%252585%252589%2525E9%252583%2525A8%2525E5%252588%252586%2525E5%25259C%2525B0%2525E5%25258C%2525BA%2525E5%2525AE%25259E%2525E6%252596%2525BD%2525E5%252586%25259B%2525E4%2525BA%25258B%2525E7%2525AE%2525A1%2525E5%252588%2525B6?topnav=1&amp;wvr=6&amp;Refer=top_button&amp;Mozilla=Mozilla/5.0%20(Windows%20NT%2010.0;%20Win64;%20x64)%20AppleWebKit/537.36%20(KHTML,%20like%20Gecko)%20Chrome/89.0.4389.82%20Safari/537.36&amp;_cb=STK_16157756566583">çƒ­æœæ¥å£åœ°å€</a> é€šè¿‡Getè¯·æ±‚åˆ°ç›¸å…³æ•°æ®ã€‚æ•°æ®ä¸æ˜¯Jsonæ ¼å¼çš„ï¼Œéœ€è¦è½¬åŒ–</p><p>è½¬åŒ–æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> respText <span class="token operator">=</span> msg<span class="token punctuation">.</span>payload<span class="token punctuation">;</span><span class="token keyword">var</span> str <span class="token operator">=</span> respText<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"try{window.STK_16157756566583&amp;STK_16157756566583("</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">")}catch(e){}"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>msg<span class="token punctuation">.</span>payload <span class="token operator">=</span> str<span class="token keyword">return</span> msg<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨å†Œä¼ æ„Ÿå™¨æ•°æ®å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">msg<span class="token punctuation">.</span>payload <span class="token operator">=</span> <span class="token punctuation">{</span>    unique_id<span class="token operator">:</span> <span class="token string">"HA-sensor_wbhot"</span><span class="token punctuation">,</span>    name<span class="token operator">:</span> <span class="token string">"wbhot"</span><span class="token punctuation">,</span>    icon<span class="token operator">:</span> <span class="token string">"mdi:sina-weibo"</span><span class="token punctuation">,</span>    state_topic<span class="token operator">:</span> <span class="token string">"device20210312/sensor_wbhot/state"</span><span class="token punctuation">,</span>    json_attributes_topic<span class="token operator">:</span> <span class="token string">"device20210312/sensor_wbhot/attributes"</span><span class="token punctuation">,</span>    unit_of_measurement<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>    device<span class="token operator">:</span> <span class="token punctuation">{</span>        identifiers<span class="token operator">:</span> <span class="token string">"20210312"</span><span class="token punctuation">,</span>        manufacturer<span class="token operator">:</span> <span class="token string">"MQTT_Sensor"</span><span class="token punctuation">,</span>        model<span class="token operator">:</span> <span class="token string">"HA"</span><span class="token punctuation">,</span>        name<span class="token operator">:</span> <span class="token string">"å¾®åšçƒ­æœ"</span><span class="token punctuation">,</span>        sw_version<span class="token operator">:</span> <span class="token string">"1.0"</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">return</span> msg<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨å†ŒçŠ¶æ€æ•°æ®å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">note <span class="token operator">=</span> msg<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>data<span class="token punctuation">.</span>list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>notemsg<span class="token punctuation">.</span>payload <span class="token operator">=</span> note<span class="token keyword">return</span> msg<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ³¨å†Œå±æ€§æ•°æ®å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> jsonArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">var</span> dataList <span class="token operator">=</span> msg<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>data<span class="token punctuation">.</span>list<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>     <span class="token keyword">var</span> jsObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    jsObj<span class="token punctuation">.</span>name <span class="token operator">=</span> dataList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>note<span class="token punctuation">;</span>    jsObj<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token string">"https://s.weibo.com/weibo?q=%23"</span> <span class="token operator">+</span> dataList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>note <span class="token operator">+</span> <span class="token string">"%23&amp;Refer=top"</span><span class="token punctuation">;</span>    jsObj<span class="token punctuation">.</span>num <span class="token operator">=</span> dataList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>num    jsonArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>jsObj<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">var</span> retList <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>retList<span class="token punctuation">.</span>lists <span class="token operator">=</span> jsonArraymsg<span class="token punctuation">.</span>payload <span class="token operator">=</span> retList<span class="token punctuation">;</span><span class="token keyword">return</span> msg<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å±æ€§æ•°æ®ç”¨çš„æ˜¯Jsonå¯¹è±¡ï¼Œä»¥ä¾¿åé¢å±•ç¤ºç”¨ã€‚å½“ç„¶ä¹Ÿå¯ä»¥å¼„æˆå­—ç¬¦ä¸²ï¼Œè‡ªç”±å‘æŒ¥ã€‚</p><h3 id="4-æ•ˆæœå±•ç¤º"><a href="#4-æ•ˆæœå±•ç¤º" class="headerlink" title="4.æ•ˆæœå±•ç¤º"></a>4.æ•ˆæœå±•ç¤º</h3><hr><p>å±•ç¤ºç•Œé¢æ¯”è¾ƒç®€é™‹ï¼Œç”¨çš„vueï¼Œä¹‹å‰å·²ç»æ”¾è¿‡ç»“æœå›¾äº†ã€‚æ•°æ®æ˜¯é€šè¿‡HAçš„apiæ¥è·å–çš„ã€‚ç•Œé¢å°±ä¸è´´äº†ï¼Œå¤ªç®€é™‹ã€‚è„šæœ¬å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span><span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span>info<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>lists<span class="token operator">:</span> <span class="token keyword">null</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/states/sensor.wbhot'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>  headers <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">'Authorization'</span><span class="token operator">:</span> <span class="token string">"Bearer XXXXXXXX"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>lists <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>attributes<span class="token punctuation">.</span>lists<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†ç›—ç”¨ä¸‹ä¹‹å‰çš„å›¾å§</p><p><img src="/img/20210406/info.png" alt="MQTTæ’ä»¶å±•ç¤º"></p>]]></content>
      
      
      <categories>
          
          <category> æ™ºèƒ½å®¶å±… </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HA </tag>
            
            <tag> mqtt </tag>
            
            <tag> Node-red </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Scratché£èŠ±ä»¤</title>
      <link href="2021/04/07/fhl/"/>
      <url>2021/04/07/fhl/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è¿™æ˜¯ä¸€ä¸ªScratchçš„é£èŠ±ä»¤æ•™ç¨‹</p></blockquote><h3 id="0-èƒŒæ™¯"><a href="#0-èƒŒæ™¯" class="headerlink" title="0.èƒŒæ™¯"></a>0.èƒŒæ™¯</h3><hr><p>è€å©†çš„å­¦æ ¡æœ‰ä¸ªæ•™å­¦çŸ­è§†é¢‘åˆ¶ä½œçš„æ¯”èµ›ï¼Œå¥¹ä¸çŸ¥é“åšä»€ä¹ˆï¼Œæˆ‘å°±æè®®å°†ç¼–ç¨‹å’Œæ•™å­¦è”åˆèµ·æ¥ã€‚å°å­¦ç”Ÿç°åœ¨éƒ½æµè¡Œå›¾å½¢åŒ–ç¼–ç¨‹ï¼ŒScratchå°±æ˜¯å…¶ä¸­ä¸€ä¸ªï¼Œæ‰€ä»¥æˆ‘å°±æƒ³æŠŠè¿™ä¸¤ä¸ªç»“åˆèµ·æ¥ï¼Œåšä¸ªä¸œè¥¿ã€‚</p><h3 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1.ç®€ä»‹"></a>1.ç®€ä»‹</h3><hr><p>ä¸‹é¢æ˜¯é£èŠ±ä»¤å’ŒScratchçš„ç®€ä»‹</p><blockquote><p>é£èŠ±ä»¤ï¼ŒåŸæœ¬æ˜¯å¤äººè¡Œé…’ä»¤æ—¶çš„ä¸€ä¸ªæ–‡å­—æ¸¸æˆï¼Œæºè‡ªå¤äººçš„è¯—è¯ä¹‹è¶£ï¼Œå¾—åäºå”ä»£è¯—äººéŸ©ç¿ƒã€Šå¯’é£Ÿã€‹ä¸­çš„åå¥â€œæ˜¥åŸæ— å¤„ä¸é£èŠ±â€ã€‚è¡Œé£èŠ±ä»¤æ—¶å¯é€‰ç”¨è¯—è¯æ›²ä¸­çš„å¥å­ï¼Œä½†é€‰æ‹©çš„å¥å­ä¸€èˆ¬ä¸è¶…è¿‡ä¸ƒä¸ªå­—ã€‚</p></blockquote><blockquote><p>Scratchæ˜¯éº»çœç†å·¥å­¦é™¢çš„â€œç»ˆèº«å¹¼å„¿å›­å›¢é˜Ÿâ€å¼€å‘çš„å›¾å½¢åŒ–ç¼–ç¨‹å·¥å…·ï¼Œä¸»è¦é¢å¯¹é’å°‘å¹´å¼€æ”¾ã€‚</p></blockquote><h3 id="2-åˆ¶ä½œè¿‡ç¨‹"><a href="#2-åˆ¶ä½œè¿‡ç¨‹" class="headerlink" title="2.åˆ¶ä½œè¿‡ç¨‹"></a>2.åˆ¶ä½œè¿‡ç¨‹</h3><hr><p><img src="/img/20210407/fhl0.jpg" alt="é£èŠ±ä»¤"></p><p><img src="/img/20210407/fhl1.jpg" alt="é£èŠ±ä»¤"></p><p><img src="/img/20210407/fhl2.jpg" alt="é£èŠ±ä»¤"></p><p><img src="/img/20210407/fhl3.jpg" alt="é£èŠ±ä»¤"></p><h3 id="3-æˆæœå±•ç¤º"><a href="#3-æˆæœå±•ç¤º" class="headerlink" title="3.æˆæœå±•ç¤º"></a>3.æˆæœå±•ç¤º</h3><hr><p><video src="/img/20210407/fhl.mp4" width="100%" controls="controls"></video></p><h3 id="4-æ¯”èµ›ç»“æœ"><a href="#4-æ¯”èµ›ç»“æœ" class="headerlink" title="4.æ¯”èµ›ç»“æœ"></a>4.æ¯”èµ›ç»“æœ</h3><hr><p>è¿™æ¬¡æ¯”èµ›è·å¾—äº†ç²¾å“ä½œå“å¥–</p><p><img src="/img/20210407/zs.png" alt="è£èª‰è¯ä¹¦"></p><p>è¿˜æ˜¯ä¸é”™çš„ï¼Œä»¥åç»§ç»­åŠ æ²¹å§!</p>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Scratch </tag>
            
            <tag> ç¼–ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”Ÿæ´»è®°äº‹</title>
      <link href="2021/04/07/life-20210407/"/>
      <url>2021/04/07/life-20210407/</url>
      
        <content type="html"><![CDATA[<h3 id="0-ç…§ç‰‡åˆ†äº«"><a href="#0-ç…§ç‰‡åˆ†äº«" class="headerlink" title="0.ç…§ç‰‡åˆ†äº«"></a>0.ç…§ç‰‡åˆ†äº«</h3><hr><p>ä¸‹ç­åå½¤å½¤å°±åˆ°å°åŒºé—¨å£æ¥æˆ‘ä»¬ï¼Œæ¥ç€å»æ‹¿äº†ä¸ªå¿«é€’ã€‚ä»¥ä¸‹æ˜¯å½¤å¦ˆæ‹çš„æ¼‚äº®å½¤</p><p><img src="/img/20210407/0.jpg" alt="æ¼‚äº®å¯çˆ±çš„å®å®"></p><p><img src="/img/20210407/1.jpg" alt="æ¼‚äº®å¯çˆ±çš„å®å®"></p><p><img src="/img/20210407/2.jpg" alt="æ¼‚äº®å¯çˆ±çš„å®å®"></p><h3 id="1-è¯´åœ¨æœ€å"><a href="#1-è¯´åœ¨æœ€å" class="headerlink" title="1.è¯´åœ¨æœ€å"></a>1.è¯´åœ¨æœ€å</h3><hr><p>å°å­©çš„é­”åŠ›çœŸçš„å¾ˆå¤§ï¼Œå¾ˆèƒ½æ„ŸæŸ“ä½ ã€‚å®¶äººå¯èƒ½ä¼šä¸ºäº†å®å®çš„æˆé•¿æœ‰äº›è®¸åˆ†æ­§ï¼Œä½†æ˜¯ç›®æ ‡æ€»æ˜¯å¸Œæœ›å¥¹å¥åº·å¿«ä¹æˆé•¿ã€‚ç”Ÿæ´»å°±æ˜¯è¿™æ ·ï¼Œå¥½å¥½äº«å—è¿™ä¸ªè¿‡ç¨‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®å® </tag>
            
            <tag> ç…§ç‰‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº¤æ˜“åˆ¶ä½œå·¥å…·</title>
      <link href="2021/04/07/maketranstool/"/>
      <url>2021/04/07/maketranstool/</url>
      
        <content type="html"><![CDATA[<h3 id="0-å·¥å…·ç®€ä»‹"><a href="#0-å·¥å…·ç®€ä»‹" class="headerlink" title="0.å·¥å…·ç®€ä»‹"></a>0.å·¥å…·ç®€ä»‹</h3><hr><p>ç”±äºå¼€å‘äº¤æ˜“æ˜¯å›ºå®šç¹ççš„åŠ¨ä½œï¼Œæ‰€ä»¥æƒ³å¼€å‘ä¸€æ¬¾äº¤æ˜“åˆ¶ä½œå·¥å…·æ¥è¾¾åˆ°æé«˜ç”Ÿäº§åŠ›ã€‚æœ‰æ›´å¤šçš„æ—¶é—´å»åšæ›´æœ‰æ„ä¹‰çš„äº‹æƒ…ã€‚å·¥å…·å®šåˆ¶æ€§æ¯”è¾ƒå¼ºï¼Œå¯èƒ½éƒ½ä¸èƒ½ç”¨ã€‚ä½†æ˜¯å¯ä»¥å…±äº«å…¶ä¸­çš„æƒ³æ³•å’Œæ€è·¯ã€‚æ˜¯18å¹´å†™çš„ï¼Œä¹Ÿè¿è¡Œäº†å‡ å¹´äº†ï¼Œæ²¡å‡ºä»€ä¹ˆå¤§é—®é¢˜ï¼Œè¿è¡Œè¿˜ç®—ç¨³å®šã€‚å°å·¥å…·é‡‡ç”¨VBSç¼–ç ï¼Œæ¯”è¾ƒè½»ä¾¿ï¼Œèƒ½å¤Ÿåœ¨Windowså¹³å°ä¸‹é¡ºåˆ©è¿è¡Œï¼Œä¹Ÿä¸å ç”¨ç³»ç»Ÿç©ºé—´ã€‚è¿™ä¸ªå°ç¨‹åºä¸»è¦ä½¿ç”¨äº† æ¨¡æ‹ŸPOSTè¯·æ±‚ï¼Œä½¿ç”¨Sqlpluså’Œæ•°æ®åº“è¿›è¡Œäº¤äº’ï¼Œxmlæ–‡ä»¶è§£æå’Œæ–‡ä»¶çš„è¯»å†™æ“ä½œä»¥åŠç§»åŠ¨ã€‚ä»£ç ä¸æ˜¯å¾ˆå¤æ‚</p><h3 id="1-ç›®å½•ç»“æ„"><a href="#1-ç›®å½•ç»“æ„" class="headerlink" title="1.ç›®å½•ç»“æ„"></a>1.ç›®å½•ç»“æ„</h3><hr><p>|   MakeTrans.vbs     â€”&gt;  å°å·¥å…·çš„è¿è¡Œç¨‹åº,åŒå‡»å³å¯è¿è¡Œ<br>|<br>|   CheckIsValid.vbs  â€”&gt;  æ£€æŸ¥XMLæŠ¥æ–‡æ˜¯å¦åˆæ³•[è¦åœ¨æ–‡ä»¶éƒ½ä¿®æ”¹å®Œæˆåæ£€æµ‹]<br>|<br>+â€”Log                       â€”&gt;  æ—¥å¿—è¾“å‡ºæ–‡ä»¶å¤¹<br>|       Run-[20180417092345].log        â€”&gt;   æ—¥å¿—æ–‡ä»¶<br>|    Script.log            â€”&gt;   åè®®ç›¸å…³è„šæœ¬<br>|<br>+â€”traninfo.txt      â€”&gt;  äº¤æ˜“ç²˜è´´å¤„<br>|<br>+â€”Metadata          â€”&gt;  å…ƒæ•°æ®è¾“å‡ºæ–‡ä»¶å¤¹<br>|       3001300000333-metadata.zip      â€”&gt;   å…ƒæ•°æ®æ–‡ä»¶<br>|       service       â€”&gt;  æ¨¡æ¿ä¿®æ”¹åçš„æ–‡ä»¶ä¼šå‡ºç°åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹<br>|<br>+â€”Template          â€”&gt;  æ¨¡æ¿æ–‡ä»¶å¤¹<br>|       BIBPS.xml     â€”&gt;  ä¼šå°†æ‹†ç»„æŠ¥æ–‡ä»¶ä¸­çš„Bodyå†…çš„å†…å®¹æ›¿æ¢æ¨¡æ¿ä¸­çš„ XXXXXXXXXXXXXXXXXXXX å†…å®¹<br>|<br>+â€”Tmp                                 â€”&gt;  ä¸´æ—¶æ–‡ä»¶å¤¹[ç”¨äºå­˜å‚¨ä»SVNä¸­æ‹·è´è¿‡æ¥çš„æ–‡ä»¶]<br>|       metadata.xml             â€”&gt;  ä¿®æ”¹çš„å…ƒæ•°æ®æ–‡ä»¶<br>|       serviceIdentify.xml    â€”&gt;  ä¿®åçš„æœåŠ¡è¯†åˆ«æ–‡ä»¶<br>|       systemIdentify.xml    â€”&gt;  ä¿®æ”¹åçš„ç³»ç»Ÿè¯†åˆ«<br>|<br>-â€“SQLScript                               â€”&gt;  å·¥å…·ä¸­ç”¨åˆ°çš„SQLè„šæœ¬æ–‡ä»¶å¤¹[å‹¿åˆ å‹¿æ”¹]<br>        CheckTran.sql                   â€”&gt;   æ£€æŸ¥äº¤æ˜“æ˜¯å¦ä¸ºå­˜é‡è„šæœ¬<br>        GetInfo.sql                         â€”&gt;   è·å¾—ä¸‹è½½Metadataçš„å‚æ•°<br>        GetName.sql                     â€”&gt;   è·å¾—ç³»ç»Ÿåå¯¹åº”çš„ç®€ç§°<br>        AddChannel.sql                â€”&gt;   æ·»åŠ æ–°å¢æ¸ é“<br>        AddSystem.sql                  â€”&gt;   æ·»åŠ æ–°å¢ç³»ç»Ÿæ–¹<br>        GetCHName.sql                â€”&gt;   è·å¾—ä¸­æ–‡æè¿°</p><h3 id="2-åŠŸèƒ½ä»‹ç»"><a href="#2-åŠŸèƒ½ä»‹ç»" class="headerlink" title="2.åŠŸèƒ½ä»‹ç»"></a>2.åŠŸèƒ½ä»‹ç»</h3><hr><p><strong>0ã€ æ›´æ–°SVN[éœ€è¦å®‰è£…svnå‘½ä»¤è¡Œ]<br>1ã€ ç™»å½•æœåŠ¡æ²»ç†å¹³å°ä¸‹è½½è„šæœ¬ä»¥åŠé…ç½®æ–‡ä»¶<br>2ã€ å°†ä¸‹è½½å¥½çš„è„šæœ¬å…¥åº“<br>3ã€ æ£€æŸ¥äº¤æ˜“çš„ç±»å‹[å­˜é‡æˆ–è€…æ–°å¢]<br>4ã€ å°†é…ç½®æ–‡ä»¶æ‹·è´è‡³æœ¬åœ°SVN[æ ¹æ®äº¤æ˜“ç±»å‹è¿›è¡Œæ‹·è´]<br>5ã€ æ¯”å¯¹å…ƒæ•°æ®å¹¶ä¿®æ”¹<br>6ã€ ä¿®æ”¹å…¬å…±æ–‡ä»¶[æœåŠ¡è¯†åˆ«ï¼Œç³»ç»Ÿè¯†åˆ«]<br>7ã€ æ ¹æ®æ¨¡æ¿æ–‡ä»¶ä¿®æ”¹æ‹†ç»„åŒ…æŠ¥æ–‡<br>8ã€ å¢åŠ XMLå¯ç”¨æ€§æ£€æµ‹[ç”±äºå¤šæ¬¡å‡ºç°ä½çº§é”™è¯¯ï¼Œæ•…æ·»åŠ ]<br>9ã€ å¯é€‰æ‹©æ‰§è¡Œçš„æ­¥éª¤</strong></p><h3 id="3-å¸¸è§é—®é¢˜"><a href="#3-å¸¸è§é—®é¢˜" class="headerlink" title="3.å¸¸è§é—®é¢˜"></a>3.å¸¸è§é—®é¢˜</h3><hr><p>Qï¼šæ¢åˆ°å…¶ä»–æœºå™¨ä¸Šæ—¶å‡ºç°é”™è¯¯ï¼ŒåŸå› æ˜¯sqlplusè¿æ¥å‡ºç°ä¹±ç <br>Aï¼šå¯ä»¥ä½¿ç”¨ echo %NLS_LANG% æŸ¥çœ‹ï¼Œå¹¶é…ç½®è¯¥ç¯å¢ƒå˜é‡<br>    C:\Users\XXXXX&gt;echo %NLS_LANG%<br>    AMERICAN_AMERICA.ZHS32GB18030</p><p>Q: å‡ºç° BComp.exe ä¸æ˜¯å‘½ä»¤<br>A: ä½¿ç”¨BCompareå·¥å…·æ—¶éœ€è¦æ·»åŠ ç¯å¢ƒå˜é‡</p><p>Q: å‡ºç°ä¸èƒ½è§£å‹æ–‡ä»¶æ—¶<br>A: éœ€è¦å°†winraråŠ å…¥ç¯å¢ƒå˜é‡</p><h3 id="4-ä»£ç å±•ç¤º"><a href="#4-ä»£ç å±•ç¤º" class="headerlink" title="4.ä»£ç å±•ç¤º"></a>4.ä»£ç å±•ç¤º</h3><hr><pre class="line-numbers language-vbscript" data-language="vbscript"><code class="language-vbscript">'Author:wangxingyang'Date:20180413'write at nanjing bankSet http=CreateObject("MSXML2.XMLHTTP")Set html = CreateObject("htmlfile")Set wshshell = CreateObject("wscript.shell")Set xdoc = CreateObject("MSXML2.DOMDocument")Set logfso = CreateObject("Scripting.FileSystemObject")Set tranfso = CreateObject("Scripting.FileSystemObject")Set scriptfdo = CreateObject("Scripting.FileSystemObject")Set attrDict = CreateObject("Scripting.Dictionary")nowdate = Now()nowdate = Year(nowdate) &amp; Right("0" &amp; Month(nowdate),2)&amp; Right("0" &amp; Day(nowdate),2)&amp; Right("0" &amp; Hour(nowdate),2)&amp; Right("0" &amp; Minute(nowdate),2)&amp;  Right("0" &amp; Second(nowdate),2)logpath = "Log/Run-[" &amp; nowdate &amp; "].log"tranpath = "Log/Tran-[" &amp; nowdate &amp; "].log"scriptpath1 = "Log/Script.log"Set logfile = logfso.CreateTextFile(logpath,True)Set tranfile = tranfso.CreateTextFile(tranpath,True)Set scriptfile = scriptfdo.CreateTextFile(scriptpath1,True)Dim cookies'---------æœåŠ¡æ²»ç†æ§åˆ¶å°åœ°å€----------- [ æ³¨æ„:éœ€è¦æ–œæ  ]mainurl = "http://159.1.XXX.XXX:PPPP/"'---------è·‘åº“çš„è¿æ¥åœ°å€---------------linkurl33 = "XXXX/XXXX@159.1.XX.XXX:PPPP/RFRFR"linkurl39 = "XXXX/XXXXX@159.1.XX.XXX:PPPP/DEDEE"'---------æœåŠ¡æ²»ç†åº“åœ°å€---------------serviceurl = "SSS/SSS@159.1.XX.XXX:PPPP/SESES"'---------ç”Ÿæˆä¸´æ—¶æ–‡ä»¶----------------- [ æ³¨æ„:éœ€è¦æ–œæ  ]commpath = "Tmp\"'---------è„šæœ¬å­˜æ”¾ç›®å½•----------------- [ æ³¨æ„:éœ€è¦æ–œæ  ]scriptpath = "SQLScript\"'---------å…ƒæ•°æ®å­˜æ”¾ç›®å½•--------------- [ æ³¨æ„:éœ€è¦æ–œæ  ]metadatapath = "Metadata\"'---------svn metadata-----------------'---------svnè·¯å¾„----------------------svnpath = "Z:\WorkSpace\SmartESB\configs"inconfpath = svnpath &amp; "\in_conf\"outconfpath = svnpath &amp; "\out_conf\"svndestin = inconfpath &amp; "metadata\"svndestout = outconfpath &amp; "metadata\"svnmetadata = svndestin &amp; "metadata.xml"'---------æœåŠ¡å®šä¹‰æ–‡ä»¶-----------------newpath = "C:\Users\WWW\Desktop\äº¤æ˜“åˆ¶ä½œå·¥å…·\Metadata\"'å­˜æ”¾æ•°æ®å­—å…¸ä¸­æ‰€æœ‰å­—æ®µåç§°alldata = ""'å­˜æ”¾éœ€è¦å¢åŠ çš„è¯­å¥allNewData = ""'----------æ˜¯å¦ä¸ºå­˜é‡äº¤æ˜“æ ‡è¯†-----------'True  å­˜é‡'False æ–°å¢å¤ç”¨isExistFlag = True  totalNum = 0'======================='ç‰ˆæœ¬æ›´æ–°æ—¥å¿—æ‰“å°'=======================Sub versionLog()logfile.WriteLine("------------------" &amp; Now() &amp; "---------------------" &amp; Chr(13) &amp; Chr(13) &amp; Chr(13))logfile.WriteLine("=============================================================" &amp; Chr(13))logfile.WriteLine("ï¸»â”³â•ä¸€ " &amp; Now() &amp; "---&gt;Author : wangxingyang")logfile.WriteLine("ï¸»â”³â•ä¸€ " &amp; Now() &amp; "---&gt;Date : 2018/04/13")    logfile.WriteLine("ï¸»â”³â•ä¸€ " &amp; Now() &amp; "---&gt;Contact : freefitter@163.com")logfile.WriteLine("=============================================================" &amp; Chr(13))logfile.WriteLine(Now() &amp; "---&gt;Version : v1.0 At 2018/04/13")logfile.WriteLine(Now() &amp; "---&gt;1ã€ æ£€æŸ¥äº¤æ˜“æ˜¯å¦ä¸ºæ–°å¢")logfile.WriteLine(Now() &amp; "---&gt;2ã€ å¯¼å‡ºå¹¶åªæ‰§è¡Œè„šæœ¬")logfile.WriteLine(Now() &amp; "---&gt;3ã€ å¯¼å‡ºç›¸å…³é…ç½®æ–‡ä»¶")logfile.WriteLine(Now() &amp; "---&gt;4ã€ ä¿®æ”¹å…¬å…±æ–‡ä»¶ç»“æ„")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.0 At 2018/04/16")logfile.WriteLine(Now() &amp; "---&gt;1ã€ å¢åŠ è§£å‹æ–‡ä»¶åŠŸèƒ½")logfile.WriteLine(Now() &amp; "---&gt;2ã€ å¢åŠ æ¯”è¾ƒå…ƒæ•°æ®åŠŸèƒ½")logfile.WriteLine(Now() &amp; "---&gt;3ã€ å¢åŠ æ‹·è´è‡³é…ç½®åº“åŠŸèƒ½")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.1 At 2018/05/04")logfile.WriteLine(Now() &amp; "---&gt;1ã€ ä¿®æ”¹å¼¹å‡ºæ¡†BUG[å¼¹å‡ºæ¡†æœ‰é•¿åº¦é™åˆ¶ï¼Œå¯¼è‡´å¤„ç†äº¤æ˜“æŠ¥é”™]")logfile.WriteLine(Now() &amp; "---&gt;2ã€ ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿåç§°å°å†™é—®é¢˜")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.2 At 2018/05/06")logfile.WriteLine(Now() &amp; "---&gt;1ã€ å¢åŠ äº¤æ˜“æ‰§è¡Œåˆ¤æ–­æ—¥å¿—")logfile.WriteLine(Now() &amp; "---&gt;2ã€ å¢åŠ è¯»æ–‡ä»¶è¿›è¡Œå¤„ç†äº¤æ˜“")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.3 At 2018/05/10")logfile.WriteLine(Now() &amp; "---&gt;1ã€ ä¿®æ”¹å…ƒæ•°æ®æ£€æŸ¥ä¸å‡ºæ–°å¢çš„BUG")logfile.WriteLine(Now() &amp; "---&gt;2ã€ ä¿®æ”¹é‡å¤æ·»åŠ å…ƒæ•°æ®BUG")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.4 At 2018/05/14")logfile.WriteLine(Now() &amp; "---&gt;1ã€ ä¿®æ”¹å½“å…ƒæ•°æ®ä¸­åŒ…å«å…ƒæ•°æ®æ—¶ä¸èƒ½æ·»åŠ çš„é—®é¢˜")logfile.WriteLine(Now() &amp; "---&gt;2ã€ æ–°å¢ä¿®æ”¹å…ƒæ•°æ®æ–‡ä»¶åŠŸèƒ½")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.5 At 2018/05/15")logfile.WriteLine(Now() &amp; "---&gt;1ã€ å¢åŠ æ–‡ä»¶æ¯”å¯¹åŠŸèƒ½ï¼Œä½¿ç”¨BCompareæ‰“å¼€éœ€è¦æ¯”è¾ƒçš„å·¥å…·")logfile.WriteLine(Now() &amp; "---&gt;2ã€ æœåŠ¡å®šä¹‰æ–‡ä»¶ä¸­ï¼Œä¸å­˜åœ¨çš„è°ƒç”¨å…³ç³»ä¼šæ–°å¢")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.6 At 2018/05/17")logfile.WriteLine(Now() &amp; "---&gt;1ã€ æ–°å¢æ ¹æ®äº¤æ˜“ç±»å‹åˆ¤æ–­æ˜¯å¦è·‘åº“")logfile.WriteLine(Now() &amp; "---&gt;2ã€ æ·»åŠ äº¤æ˜“ç®€ç§°æŸ¥è¯¢ç¼“å­˜ï¼Œåœ¨ä¸€æ¬¡è¿è¡Œä¸­ç›¸åŒåç§°å€¼æ£€æŸ¥ä¸€æ¬¡")logfile.WriteLine(Now() &amp; "---&gt;3ã€ æ–°å¢æ¸ é“ä¼šè‡ªåŠ¨æ–°å¢æœåŠ¡è¯†åˆ«å¹¶è·‘æ–°å¢è„šæœ¬")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.7 At 2018/05/13")logfile.WriteLine(Now() &amp; "---&gt;1ã€ æ–°å¢æ ¹æ®æ¨¡æ¿æ›¿æ¢æ‹†ç»„æŠ¥æ–‡ä»¶åŠŸèƒ½")logfile.WriteLine(Now() &amp; "---&gt;2ã€ æ–°å¢æ‹¼æ¥æ›´æ–°é€‚é…å™¨SQLåŠŸèƒ½")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.8 At 2018/05/30")logfile.WriteLine(Now() &amp; "---&gt;1ã€ æ–°å¢é€‰æ‹©æ‰§è¡ŒæŒ‡å®šæµç¨‹")logfile.WriteLine(Now() &amp; "---&gt;2ã€ ä¼˜åŒ–è·¯å¾„ï¼Œå°½é‡å°‘æ›´æ”¹è·¯å¾„")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.9 At 2018/06/12")logfile.WriteLine(Now() &amp; "---&gt;1ã€ ä¿®æ”¹å…ƒæ•°æ®å°‘æ·»åŠ çš„BUG")logfile.WriteLine(Now() &amp; "---&gt;Version : v3.0 At 2018/11/15")logfile.WriteLine(Now() &amp; "---&gt;1ã€ ä¿®æ”¹æŸ¥è¯¢å…ƒæ•°æ®æ¯”å¯¹å †æ ˆæº¢å‡ºBUG")logfile.WriteLine(Now() &amp; "---&gt;2ã€ å¢åŠ ç²˜è´´æ ¼å¼æ ¡éªŒ")logfile.WriteLine("------------------" &amp; Now() &amp; "---------------------" &amp; vbcrlf &amp; vbcrlf)End Sub'======================='ç™»å½•æœåŠ¡æ²»ç†ç³»ç»Ÿ'=======================Sub login(username,password)url = mainurl &amp; "login/"http.Open "POST",url,Falsehttp.setRequestHeader "Content-Type","application/x-www-form-urlencoded; charset=UTF-8"http.Send "username=" &amp; username &amp; "&amp;password=" &amp; passwordstrHtml = http.responsetextcookies = http.getResponseHeader("Set-Cookie")logfile.WriteLine(Now() &amp; "---&gt;ç™»å½•æœåŠ¡æ²»ç†æˆåŠŸ")End Sub'======================='æ£€æŸ¥äº¤æ˜“æ˜¯å¦æ˜¯æ–°å¢å¤ç”¨'=======================Sub checkTran(code,from,dest)logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹æŸ¥çœ‹["&amp; code &amp;"]æ˜¯å¦æ˜¯å…¨æ–°äº¤æ˜“")cmdstr = "sqlplus "&amp; linkurl33 &amp;" @" &amp; scriptpath &amp; "CheckTran.sql" &amp; " " &amp; codeSet exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()logfile.WriteLine(Now() &amp; "---&gt;æŸ¥è¯¢ç»“æœå¦‚ä¸‹:")logfile.WriteLine(Now() &amp; "---&gt;"&amp; retmsg)If InStr(retmsg,"no rows") = 0 Thenlogfile.WriteLine(Now() &amp; "---&gt;äº¤æ˜“[" &amp; code &amp; "]ä¸ºæ–°å¢å¤ç”¨äº¤æ˜“!!!")fromname = queryName(from)tranfile.WriteLine("äº¤æ˜“[" &amp; code &amp; "] ------&gt; æ–°å¢å¤ç”¨ï¼Œè°ƒç”¨å…³ç³»ä¸º: [ " &amp; from &amp; " = " &amp; fromname &amp;" ] -&gt; " &amp; code &amp; " -&gt; [ " &amp; dest &amp; " ]")isExistFlag = TruetotalNum = totalNum + 2Elselogfile.WriteLine(Now() &amp; "---&gt;äº¤æ˜“[" &amp; code &amp; "]ä¸ºå…¨æ–°äº¤æ˜“!!!")fromname = queryName(from)tranfile.WriteLine("äº¤æ˜“[" &amp; code &amp; "] ------&gt; å…¨æ–°ï¼Œè°ƒç”¨å…³ç³»ä¸º: [ " &amp; from &amp; " = " &amp; fromname &amp;" ] -&gt; " &amp; code &amp; " -&gt; [ " &amp; dest &amp; " ]")isExistFlag = FalsetotalNum = totalNum + 6End Iflogfile.WriteLine(Now() &amp; "---&gt;æŸ¥çœ‹["&amp; code &amp;"]æ˜¯å¦æ˜¯å…¨æ–°äº¤æ˜“ç»“æŸ")End Sub'======================='å¯¼å‡ºå¹¶æ‰§è¡Œè„šæœ¬'=======================Sub exportAndRunSQLOne(tranId)'--------å¯¼å‡ºè„šæœ¬--------------'åˆ¤æ–­æ˜¯å¦æ˜¯å­˜é‡ï¼Œå¦‚æœæ˜¯å­˜é‡ï¼Œä¸ç”¨è·‘æ•°æ®åº“è„šæœ¬If isExistFlag Thenlogfile.WriteLine(Now() &amp; "---&gt;äº¤æ˜“[" &amp; tranId &amp; "]ä¸ºæ–°å¢å¤ç”¨äº¤æ˜“ï¼Œä¸è·‘è„šæœ¬ã€‚ç›´æ¥é€€å‡ºï¼")Exit SubEnd Iflogfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹å¯¼å‡º[" &amp; tranId &amp; "]SQLè„šæœ¬")type1 = "service"operationIds = tranIdurl = mainurl &amp; "esbScriptExport/preview"http.Open "POST",url,Falsehttp.setRequestHeader "Content-Type","application/x-www-form-urlencoded; charset=UTF-8"http.setRequestHeader "Cookie",cookieshttp.Send "type=" &amp; type1 &amp; "&amp;operationIds=" &amp; operationIdsstrHtml = http.responsetextSet window = html.parentWindowwindow.execScript "var json = " &amp; strHtml, "JScript"Set ret = window.jsonsqltmp = ret.result'----------æ›¿æ¢Adapter----------'---åæœŸæ·»åŠ '------å¯é‡‡ç”¨å…ˆè·‘åœ¨æ›´æ–°çš„æ–¹å¼'------æˆ–è€…æ‹¿åˆ°åæ›¿æ¢æ›´æ–°'----------å†™æ–‡ä»¶---------------Set fso = CreateObject("Scripting.FileSystemObject")Set file = fso.CreateTextFile( scriptpath &amp; operationIds &amp;".sql",True)file.WriteLine(sqltmp)file.WriteLine("commit;")file.WriteLine("exit;")file.close()logfile.WriteLine(Now() &amp; "---&gt;å¯¼å‡º[" &amp; tranId &amp; "]SQLè„šæœ¬å®Œæˆ")logfile.WriteLine(Now() &amp; "---&gt;å¯¼å‡ºå†…å®¹å¦‚ä¸‹ï¼š")logfile.WriteLine(Now() &amp; "---&gt; ")logfile.WriteLine(sqltmp &amp; "commit;")logfile.WriteLine(sqltmp &amp; "exit;")'-----------è·‘åˆšåˆšä¿å­˜ä¸‹æ¥çš„SQLæ–‡ä»¶---------logfile.WriteLine(Now() &amp; "---&gt;åœ¨["&amp; linkurl33 &amp;"]å¼€å§‹æ‰§è¡Œå¯¼å‡ºè„šæœ¬ " &amp; scriptpath &amp; operationIds &amp;".sql")Set exeRs = wshshell.exec("sqlplus " &amp; linkurl33 &amp;" @" &amp; scriptpath &amp; operationIds &amp;".sql")retmsg = exeRs.StdOut.ReadAll()If InStr(retmsg,"ORA") &gt; 0 Thenlogfile.WriteLine(Now() &amp; " Error-&gt;æ‰§è¡Œ["&amp; tranId &amp;"]å­˜åœ¨é”™è¯¯ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—......")End Iflogfile.WriteLine(Now() &amp; "---&gt;æ‹¼æ¥æ›´æ–°é€‚é…å™¨è¯­å¥å¼€å§‹..................."&amp; vbcrlf)'æ‹¼æ¥æœåŠ¡åœºæ™¯ç ï¼Œç”¨äºå†™SQLæ›´æ–°sqlText = ""scriptfile.WriteLine("---" &amp; tranId)If InStr(retmsg,"BIND_PROTOCOLID_REF") &gt; 0 ThensqlText = "insert into BINDMAP(SERVICEID, STYPE, LOCATION, VERSION, PROTOCOLID, MAPTYPE) VALUES('" &amp; tranId &amp; "', 'SERVICE', 'local_out', '0', '" &amp; tranId &amp; "Adapter', 'request');" &amp; vbcrlfEnd IfsqlText = sqlText &amp; "UPDATE SERVICESYSTEMMAP SET ADAPTER = '" &amp; tranId &amp; "Adapter' WHERE SERVICEID = '" &amp; tranId &amp; "';" &amp; vbcrlfsqlText = sqlText &amp; "UPDATE BINDMAP SET PROTOCOLID = '" &amp; tranId &amp; "Adapter' WHERE SERVICEID = '" &amp; tranId &amp; "';" &amp; vbcrlfscriptfile.WriteLine(sqlText)logfile.WriteLine(sqlText)logfile.WriteLine(Now() &amp; "---&gt;æ‹¼æ¥æ›´æ–°é€‚é…å™¨è¯­å¥ç»“æŸ..................."&amp; vbcrlf)logfile.WriteLine(Now() &amp; "---&gt;æ‰§è¡Œç»“æœï¼š")logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")logfile.WriteLine(retmsg)logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")logfile.WriteLine(Now() &amp; "---&gt;å¯¼å‡ºè„šæœ¬æ‰§è¡Œç»“æŸ " &amp; scriptpath &amp; operationIds &amp;".sql")'-----------è·‘åˆšåˆšä¿å­˜ä¸‹æ¥çš„SQLæ–‡ä»¶---------logfile.WriteLine(Now() &amp; "---&gt;åœ¨["&amp; linkurl39 &amp;"]å¼€å§‹æ‰§è¡Œå¯¼å‡ºè„šæœ¬ " &amp; scriptpath &amp; operationIds &amp;".sql")Set exeRs = wshshell.exec("sqlplus " &amp; linkurl39 &amp;" @" &amp; scriptpath &amp; operationIds &amp;".sql")retmsg = exeRs.StdOut.ReadAll()If InStr(retmsg,"ORA") &gt; 0 Thenlogfile.WriteLine(Now() &amp; " Error-&gt;æ‰§è¡Œ["&amp; tranId &amp;"]å­˜åœ¨é”™è¯¯ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—......")End Iflogfile.WriteLine(Now() &amp; "---&gt;æ‰§è¡Œç»“æœï¼š")logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")logfile.WriteLine(retmsg)logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")logfile.WriteLine(Now() &amp; "---&gt;å¯¼å‡ºè„šæœ¬æ‰§è¡Œç»“æŸ " &amp; scriptpath &amp; operationIds &amp;".sql")Set sfile = fso.getfile(scriptpath &amp; operationIds &amp;".sql")sfile.deleteSet fso = NothingEnd Sub'======================='æ‰§è¡ŒSQLè„šæœ¬'=======================Sub RunSqlScript(en_name,ch_name,sqlname)If sqlname = "AddChannel" Thencmdstr = "sqlplus "&amp; linkurl33 &amp;" @" &amp; scriptpath &amp; sqlname &amp; ".sql" &amp; " " &amp; en_name &amp; " " &amp; en_name &amp; "Connector " &amp; ch_nameElsecmdstr = "sqlplus "&amp; linkurl33 &amp;" @" &amp; scriptpath &amp; sqlname &amp; ".sql" &amp; " " &amp; en_name &amp; " " &amp; en_name &amp; "Adapter " &amp; ch_nameEnd If'logfile.WriteLine(Now() &amp; " RunSqlScript " &amp; cmdstr)Set exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()If InStr(retmsg,"ORA") &gt; 0 Thenlogfile.WriteLine(Now() &amp; " Error-&gt;æ‰§è¡Œæ–°å¢æ¸ é“["&amp; en_name &amp;"]å­˜åœ¨é”™è¯¯ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—......")End Iflogfile.WriteLine(Now() &amp; "---&gt;æ‰§è¡Œç»“æœï¼š")logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")logfile.WriteLine(retmsg)logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")If sqlname = "AddChannel" Thencmdstr = "sqlplus "&amp; linkurl39 &amp;" @" &amp; scriptpath &amp; sqlname &amp; ".sql" &amp; " " &amp; en_name &amp; " " &amp; en_name &amp; "Connector " &amp; ch_nameElsecmdstr = "sqlplus "&amp; linkurl39 &amp;" @" &amp; scriptpath &amp; sqlname &amp; ".sql" &amp; " " &amp; en_name &amp; " " &amp; en_name &amp; "Adapter " &amp; ch_nameEnd IfSet exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()If InStr(retmsg,"ORA") &gt; 0 Thenlogfile.WriteLine(Now() &amp; " Error-&gt;æ‰§è¡Œæ–°å¢æ¸ é“["&amp; en_name &amp;"]å­˜åœ¨é”™è¯¯ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—......")End Iflogfile.WriteLine(Now() &amp; "---&gt;æ‰§è¡Œç»“æœï¼š")logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")logfile.WriteLine(retmsg)logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")End Sub'======================='å¯¼å‡ºè„šæœ¬å¹¶æ‰§è¡Œï¼Œæ”¯æŒå¤šä¸ª'=======================Sub exportAndRunSql(tranIds)If InStr(tranIds,",") = 0  ThenexportAndRunSQLOne(tranIds)Elsemyarray = Split(tranIds,",")For i= 0 To UBound(myarray)exportAndRunSQLOne(myarray(i))nextEnd IfEnd Sub'======================='å¯¼å‡ºäº¤æ˜“çš„é…ç½®æ–‡ä»¶'=======================Sub exportConf(from,dest,code)'è¿æ¥æ•°æ®åº“æŸ¥è¯¢ç›¸å…³æ•°æ®logfile.WriteLine(Now() &amp; "---&gt;å‡†å¤‡å¯¼å‡ºé…ç½®æ–‡ä»¶")logfile.WriteLine(Now() &amp; "---&gt;æŸ¥è¯¢å¯¼å‡ºé…ç½®æ–‡ä»¶æ‰€éœ€å‚æ•°")serviceId = Left(code,11)senceId = Right(code,2)cmdstr = "sqlplus "&amp; serviceurl &amp;" @" &amp; scriptpath &amp; "GetInfo.sql" &amp; " " &amp; serviceId &amp; " " &amp; senceId &amp; " " &amp; from &amp; " " &amp; destSet exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()logfile.WriteLine(Now() &amp; "---&gt;æŸ¥è¯¢å¯¼å‡ºé…ç½®æ–‡ä»¶æ‰€éœ€å‚æ•°å¦‚ä¸‹:")logfile.WriteLine(Now() &amp; "---&gt;"&amp; retmsg)If InStr(retmsg,"no rows") = 0 Thenlogfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹å¯¼å‡º["&amp; code &amp;"]é…ç½®æ–‡ä»¶")rets = Split(retmsg,"--------------------------------------------------------------------------------")tttt = Split(rets(4),"Disconnected")result = tttt(0)ret = Split(result,Chr(10))val1 = Replace(Trim(ret(1)),Chr(13),"")val2 = Replace(Trim(ret(3)),Chr(13),"")val3 = Replace(Trim(ret(2)),Chr(13),"")val4 = Replace(Trim(ret(4)),Chr(13),"")val1 = Replace(val1,Chr(10),"")val2 = Replace(val2,Chr(10),"")val3 = Replace(val3,Chr(10),"")val4 = Replace(val4,Chr(10),"")url = mainurl &amp; "export/exportBatch"http.Open "POST",url,Falsehttp.setRequestHeader "Content-Type","application/x-www-form-urlencoded; charset=UTF-8"http.setRequestHeader "Accept-Encoding","gzip,deflate,sdch"http.setRequestHeader "Cache-Control","max-age=0"http.setRequestHeader "Connection","keep-alive"http.setRequestHeader "Cookie",cookieshttp.Send "list[0].consumerServiceInvokeId=" &amp; val1 &amp; "&amp;list[0].providerServiceInvokeId=" &amp; val2 &amp; "&amp;list[0].conGeneratorId=" &amp; val3 &amp; "&amp;list[0].proGeneratorId=" &amp; val4Set file1 = CreateObject("ADODB.Stream")file1.Mode = 3file1.Type = 1file1.Open()file1.write(http.responseBody)file1.SaveToFile metadatapath &amp; code &amp; "-" &amp; "metadata.zip",2logfile.WriteLine(Now() &amp; "---&gt;å¯¼å‡º["&amp; code &amp;"]é…ç½®æ–‡ä»¶å®Œæˆ")Set file1 = NothingElseMsgBox "æ•°æ®åº“æœªæŸ¥è¯¢åˆ°é…ç½®ä¿¡æ¯,æ³¨æ„æŸ¥çœ‹!!!"Exit SubEnd If '-------------è§£å‹æ–‡ä»¶---------------cmdstr = "cmd /c cd %cd%\" &amp; metadatapath  &amp; " &amp; winrar.exe x -ad -y "&amp; code &amp;"-metadata.zip"Set exeRs = wshshell.exec(cmdstr)'æ·»åŠ è¿™å¥æ‰èƒ½å¤Ÿç­‰å¾…æ‰§è¡Œå®Œæˆç»“æœï¼Œæ‰èƒ½ä¸²è¡Œretmsg = exeRs.StdOut.ReadAll()'-------------æ¯”è¾ƒå…ƒæ•°æ®--------------'compareMeteData(code)'-------------æ‹·è´æ–‡ä»¶è‡³ESBè·¯å¾„ä¸‹-----------'copyConfToSvn(code)End Sub'======================='æŸ¥è¯¢å¯¹åº”ç³»ç»Ÿçš„ç®€ç§°'=======================Function queryName(from)result = ""If attrDict.Exists(from) Thenresult = attrDict.Item(from)logfile.WriteLine(Now() &amp; "---&gt; å­—å…¸ä¸­å·²ç¼“å­˜ï¼Œç›´æ¥å–ç¼“å­˜")Elselogfile.WriteLine(Now() &amp; "---&gt; å­—å…¸ä¸­æœªç¼“å­˜ï¼Œéœ€è¦æŸ¥åº“")cmdstr = "sqlplus "&amp; serviceurl &amp;" @" &amp; scriptpath &amp; "GetName.sql" &amp; " " &amp; fromSet exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()If InStr(retmsg,"no rows") = 0 Thenrets = Split(retmsg,"--------------------------------------------------------------------------------")tttt = Split(rets(1),"Disconnected")result = Replace(tttt(0),Chr(10),"")result = Replace(result,Chr(13),"")ElseMsgBox "æœªæŸ¥è¯¢åˆ°[" &amp; from &amp; "]å¯¹åº”çš„ç®€ç§°,æ³¨æ„æŸ¥çœ‹!!!"End IfattrDict.Add from,resultEnd IfqueryName = resultEnd Function'======================='æŸ¥è¯¢å¯¹åº”ç³»ç»Ÿçš„åç§°'=======================Function queryCHName(from)result = ""If attrDict.Exists(from) Thenresult = attrDict.Item(from)logfile.WriteLine(Now() &amp; "---&gt;å­—å…¸ä¸­å·²ç¼“å­˜ï¼Œç›´æ¥å–ç¼“å­˜")Elselogfile.WriteLine(Now() &amp; "---&gt; å­—å…¸ä¸­æœªç¼“å­˜ï¼Œéœ€è¦æŸ¥åº“")cmdstr = "sqlplus "&amp; serviceurl &amp;" @" &amp; scriptpath &amp; "GetCHName.sql" &amp; " " &amp; fromlogfile.WriteLine(Now() &amp; "---&gt; " &amp; cmdstr)Set exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()If InStr(retmsg,"no rows") = 0 Thenrets = Split(retmsg,"--------------------------------------------------------------------------------")tttt = Split(rets(1),"Disconnected")result = Replace(tttt(0),Chr(10),"")result = Replace(result,Chr(13),"")ElseMsgBox "æœªæŸ¥è¯¢åˆ°[" &amp; from &amp; "]å¯¹åº”çš„ç®€ç§°,æ³¨æ„æŸ¥çœ‹!!!"End IfattrDict.Add from,resultEnd IfqueryCHName = resultEnd Function'======================='ä¿®æ”¹æœåŠ¡è¯†åˆ«å’Œç³»ç»Ÿè¯†åˆ«'=======================Sub modifyXml(from,dest,code)logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹ä¿®æ”¹å…¬å…±æ–‡ä»¶")pathService = commpath &amp; "serviceIdentify.xml"pathSystem = commpath &amp; "systemIdentify.xml"'è¿æ¥æ•°æ®åº“æŸ¥è¯¢ç›¸å…³æ•°æ®logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹æŸ¥è¯¢[" &amp; from &amp; "]å¯¹åº”çš„ç®€ç§°")serviceId = Left(code,11)senceId = Right(code,2)result = queryName(from)If result = "" Thenlogfile.WriteLine(Now() &amp; "---&gt;æ²¡æŸ¥åˆ°ç®€ç§°å‘¢ï¼Œç›´æ¥é€€å‡ºäº†å“Ÿ.....")Exit SubEnd If logfile.WriteLine(Now() &amp; "---&gt;[" &amp; from &amp; "]===&gt;[" &amp; result &amp; "]")logfile.WriteLine(Now() &amp; "---&gt;æŸ¥è¯¢[" &amp; from &amp; "]å¯¹åº”çš„ç®€ç§°ç»“æŸ")logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹ä¿®æ”¹[" &amp; pathService &amp; "]æ–‡ä»¶")xdoc.Load(pathService)ReadServiceXml xdoc,result,from,dest,codexdoc.Save pathServicelogfile.WriteLine(Now() &amp; "---&gt;ä¿®æ”¹[" &amp; pathService &amp; "]æ–‡ä»¶ç»“æŸ")logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹ä¿®æ”¹[" &amp; pathSystem &amp; "]æ–‡ä»¶")xdoc.Load(pathSystem)ReadSystemXml  xdoc,result,dest,codexdoc.Save pathSystemlogfile.WriteLine(Now() &amp; "---&gt;ä¿®æ”¹[" &amp; pathSystem &amp; "]æ–‡ä»¶ç»“æŸ")logfile.WriteLine(Now() &amp; "---&gt;ä¿®æ”¹å…¬å…±æ–‡ä»¶ç»“æŸ")End Sub'======================='è§£ææœåŠ¡è¯†åˆ«æ–‡ä»¶å¹¶æ·»åŠ æ–°äº¤æ˜“'=======================Sub ReadServiceXml(xdoc,from,ch_name,dest,code)'å–å‡ºæ‰€æœ‰channelSet nodes = xdoc.documentElement.selectNodes(".//channel")For Each node In nodesSet Alist = node.AttributesDim node2For i = 0 To Alist.Length - 1Dim attrSet attr = Alist.Item(i)If attr.NodeName = "id" And attr.NodeValue = from Then'å–å‡ºæ‰€æœ‰ switchSet m = node.getElementsByTagName("switch")(0)Set childs = m.childNodesFor Each node1 In node.selectNodes(".//switch")For j = 0 To node1.ChildNodes.Length -1Set tmp = node1.ChildNodes(j)Set node2 = node1'åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¯¥äº¤æ˜“If tmp.NodeType = 1 And tmp.NodeName = "case" And Trim(tmp.Text) = code Then'æœ‰çš„è¯ç›´æ¥é€€å‡ºlogfile.WriteLine(Now() &amp; "---&gt;å­˜åœ¨è¯¥è°ƒç”¨å…³ç³»"&amp; from &amp;" -- " &amp; code)Exit SubEnd If NextNext'åœ¨æ³¨é‡Šå¤„æ’å…¥è¯¥äº¤æ˜“For n = 1 To childs.length-1If childs(n).NodeType = 8 ThenIf Trim(childs(n).NodeValue) = dest ThenSet nodetmp = xdoc.createElement("case")Set nodeattr = xdoc.createAttribute("value")If from = "ECIF" Or from = "PPL" Or from = "BIBPS" Thennodeattr.text = codenodetmp.setAttributeNode nodeattrnodetmp.text = codeElsenodeattr.text = "Req" &amp; codenodetmp.setAttributeNode nodeattrnodetmp.text = codeEnd Ifm.insertBefore nodetmp,childs(n+1)logfile.WriteLine(Now() &amp; "---&gt; åœ¨æ³¨é‡Šå¤„æ’å…¥è¯¥äº¤æ˜“ "&amp; from &amp;" --&gt; " &amp; code &amp; " --&gt; " &amp; dest)Exit SubEnd If End IfNext'æ’å…¥æ³¨é‡Šå’Œäº¤æ˜“Set nodetmp = xdoc.createElement("case")Set nodeattr = xdoc.createAttribute("value")Set nodecomm = xdoc.createComment(dest)If from = "ECIF" Or from = "PPL" Or from = "BIBPS"Thennodeattr.text = codenodetmp.setAttributeNode nodeattrnodetmp.text = codeElsenodeattr.text = "Req" &amp; codenodetmp.setAttributeNode nodeattrnodetmp.text = codeEnd Ifm.appendChild(nodecomm)m.appendChild(nodetmp)Exit SubEnd If NextNext'è‹¥æ²¡æœ‰æŸ¥åˆ°CHANNELåˆ™ä¸ºæ–°å¢æ¸ é“ï¼Œéœ€è¦æ–°å¢æ¸ é“logfile.WriteLine(Now() &amp; "---&gt;**********æ­¤æ¸ é“ä¸ºæ–°å¢æ¸ é“ "&amp; from &amp;" --&gt; " &amp; code &amp; " --&gt; " &amp; dest)Set channels = xdoc.documentElementlogfile.WriteLine(Now() &amp; "---&gt; æ–°å¢ CHANNEL èŠ‚ç‚¹")Set channel = xdoc.createElement("channel")Set channelid = xdoc.createAttribute("id")Set channeltype = xdoc.createAttribute("type")channelid.text = fromchannel.setAttributeNode channelidchanneltype.text = "dynamic"channel.setAttributeNode channeltypelogfile.WriteLine(Now() &amp; "---&gt; æ–°å¢ Switch èŠ‚ç‚¹")Set switch = xdoc.createElement("switch")Set switchmode = xdoc.createAttribute("mode")Set switchexpression = xdoc.createAttribute("expression")switchmode.text = "soap"switch.setAttributeNode switchmodeswitchexpression.text = "/soapenv:Envelope/soapenv:Body"switch.setAttributeNode switchexpressionlogfile.WriteLine(Now() &amp; "---&gt; æ–°å¢ namespace èŠ‚ç‚¹")Set namespace = xdoc.createElement("namespace")Set namespacevalue = xdoc.createAttribute("value")namespacevalue.text = "soapenv"namespace.setAttributeNode namespacevaluenamespace.text = "http://schemas.xmlsoap.org/soap/envelope/"logfile.WriteLine(Now() &amp; "---&gt; æ–°å¢ äº¤æ˜“ èŠ‚ç‚¹")Set nodetmp = xdoc.createElement("case")Set nodeattr = xdoc.createAttribute("value")Set nodecomm = xdoc.createComment(dest)If from = "ECIF" Or from = "PPL" Or from = "BIBPS" Thennodeattr.text = codenodetmp.setAttributeNode nodeattrnodetmp.text = codeElsenodeattr.text = "Req" &amp; codenodetmp.setAttributeNode nodeattrnodetmp.text = codeEnd Ifchannels.appendChild(channel)channel.appendChild(switch)switch.appendChild(namespace)switch.appendChild(nodecomm)switch.appendChild(nodetmp)'æ‰§è¡Œ æ¸ é“æ’å…¥è„šæœ¬ RunSqlScript from,"","AddChannel"End Sub'======================='å°†æ‰§è¡Œç»“æœå†™å›åˆ°æ–‡ä»¶'=======================Sub AddLineAfterWord(frompath,topath,word,text)'éæ ‡å‡†çš„XMLæ–‡ä»¶ï¼Œä¸èƒ½ä½¿ç”¨XMLå‡½æ•°å¤„ç†logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹æ·»åŠ å…ƒæ•°æ®çš„å·®å¼‚")If Trim(text) = "" Thenlogfile.WriteLine(Now() &amp; "---&gt;æ— å·®å¼‚ï¼Œæ— éœ€æ“ä½œ")Exit Sub End If Set fso = CreateObject("Scripting.FileSystemObject")pathMetadata4Read = frompathpathMetadata4Write = topathSet fileMetadata4Read = fso.OpenTextFile(pathMetadata4Read,1,False)Set fileMetadata4Write = fso.OpenTextFile(pathMetadata4Write,2,True)Do While fileMetadata4Read.AtEndOfStream &lt;&gt; Trueline = fileMetadata4Read.ReadLine()If Trim(line) = "&lt;/"&amp; word &amp;"&gt;" Then fileMetadata4Write.Write(text)fileMetadata4Write.WriteLine("&lt;/"&amp; word &amp;"&gt;")ElsefileMetadata4Write.WriteLine lineEnd IfLoopfileMetadata4Read.close()fileMetadata4Write.close()Set fso = Nothinglogfile.WriteLine(Now() &amp; "---&gt;å†…å®¹å¦‚ä¸‹")logfile.WriteLine(Now() &amp; "---&gt;")logfile.WriteLine(text)logfile.WriteLine(Now() &amp; "---&gt;å®Œæˆæ·»åŠ å…ƒæ•°æ®çš„å·®å¼‚")End Sub'======================='æœªä½¿ç”¨'=======================Sub notuse()Set xdocu = CreateObject("MSXML2.DOMDocument")pathMetadata = commpath &amp; "metadata.xml"xdocu.Load(pathMetadata)Set nodetmp1 = xdocu.documentElementMsgBox (nodetmp1 Is Nothing)Set cNode = xdocu.createElement(nodename)Set nodeattr1 = xdocu.createAttribute("type")nodeattr1.text = nodetypecNode.setAttributeNode nodeattr1If nodetype = "string" Then Set nodeattr2 = xdocu.createAttribute("length")nodeattr2.text = "255"cNode.setAttributeNode nodeattr2End If nodetmp1.appendChild(cNode)xdocu.Save pathMetadataEnd Sub '======================='è§£æç³»ç»Ÿè¯†åˆ«å¹¶æ·»åŠ æ–°å¢äº¤æ˜“'=======================Sub ReadSystemXml(xdoc,from,dest,code)logfile.WriteLine(Now() &amp; from &amp;" --&gt; " &amp; code &amp; " --&gt; " &amp; dest)Set nodes = xdoc.documentElement.selectNodes(".//system")For Each node In nodesSet Alist = node.AttributesFor i = 0 To Alist.Length - 1Dim attrSet attr = Alist.Item(i)If attr.NodeName = "id" And attr.NodeValue = dest ThenFor Each node1 In node.selectNodes(".//service")If node1.Text = code Thenlogfile.WriteLine(Now() &amp; "å­˜åœ¨è¯¥äº¤æ˜“.......")Exit Sub End IfNext'æ’å…¥è¯¥äº¤æ˜“Set cNode = xdoc.createElement("service")cNode.Text = codenode.appendChild(cNode)Exit SubEnd IfNextNext'è‹¥æ˜¯æ–°å¢ç³»ç»Ÿé—®é¢˜logfile.WriteLine(Now() &amp; "---&gt;**********ç³»ç»Ÿ[ " &amp; dest &amp; " ]ä¸ºæ–°å¢æä¾›æ–¹ "&amp; from &amp;" --&gt; " &amp; code &amp; " --&gt; " &amp; dest)Set systems = xdoc.documentElementSet system = xdoc.createElement("system")Set systemid = xdoc.createAttribute("id")systemid.text = destsystem.setAttributeNode systemidSet cNode = xdoc.createElement("service")cNode.Text = codesystems.appendChild(system)system.appendChild(cNode)ch_name=queryCHName(dest)'MsgBox (dest &amp; "--&gt;" &amp; ch_name)'æ‰§è¡Œ ç³»ç»Ÿæ’å…¥è„šæœ¬ RunSqlScript dest,ch_name,"AddSystem"End Sub'======================='åŠ è½½å…ƒæ•°æ®'=======================Sub loadMetaData()logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹åŠ è½½æœ€æ–°Metadata.xmlæ–‡ä»¶...")Set fso = CreateObject("Scripting.FileSystemObject")Set svnfile = fso.OpenTextFile(svnmetadata,1,False)Do While svnfile.AtEndOfStream &lt;&gt; Trueline = svnfile.ReadLine()If InStr(line,"type") &gt; 0 Then tmpp = Split(line,"&lt;")(1)name = Trim(Split(tmpp," ")(0))alldata = alldata &amp; name &amp; ","End IfLooplogfile.WriteLine(Now() &amp; "---&gt;åŠ è½½æœ€æ–°Metadata.xmlå®Œæˆ..." )Set fso = NothingEnd Sub '======================='æ¯”å¯¹å…ƒæ•°æ®'=======================Sub compareMeteData(code)'æ–‡ä»¶æ–¹å¼æ¯”è¾ƒlogfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹æ¯”è¾ƒ[" &amp; code &amp; "]ä¸å…ƒæ•°æ®çš„å·®å¼‚")Set fso = CreateObject("Scripting.FileSystemObject")temp = newpath &amp; code &amp; "-metadata\in_config\servicedefine"Set localfile = fso.GetFolder(temp)Set outpath = fso.CreateTextFile(newpath &amp; "\out" &amp; code &amp; ".txt",True)Set oFiles = localfile.FilesFor Each oFile In oFilestmppath = oFile.PathSet file1 = fso.OpenTextFile(tmppath,1,False)Do While file1.AtEndOfStream &lt;&gt; Trueline = file1.ReadLine()If InStr(line,"metadataid") &gt; 0 Thentmpp = Split(line,"metadataid")(1)tmpp1 = Trim(Split(tmpp,Chr(34))(1))If InStr(line,"type") &gt; 0 Thentmpp2 = Split(line,"type")(1)tmpp3 = Split(tmpp2,Chr(34))(1)isExists = 1checkExists alldata,tmpp1,isExists'MsgBox len(alldata)   416771If (tmpp3 = "array" Or tmpp3 = "sopform") And isExists = 0 Thenoutpath.WriteLine("&lt;" &amp; tmpp1 &amp; " type=" &amp; Chr(34) &amp; "array"&amp; Chr(34) &amp;"/&gt;")logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹æ·»åŠ [" &amp; tmpp1 &amp; "]å…ƒæ•°æ®,ç±»å‹ä¸º[array]")'æ·»åŠ å·²ç»æ·»åŠ çš„å­—æ®µï¼Œä»¥å…é‡å¤æ–°å¢allNewData = allNewData &amp; "&lt;" &amp; tmpp1 &amp; " type=" &amp; Chr(34) &amp; "array"&amp; Chr(34) &amp;"/&gt;"&amp; vbcrlfalldata = alldata &amp; tmpp1 &amp; ","End If ElseisExists = 1checkExists alldata,tmpp1,isExistsIf isExists = 0 Thenoutpath.WriteLine("&lt;" &amp; tmpp1 &amp; " type=" &amp; Chr(34) &amp; "string"&amp; Chr(34) &amp;" length="&amp; Chr(34) &amp; "255" &amp; Chr(34) &amp;"/&gt;")logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹æ·»åŠ [" &amp; tmpp1 &amp; "]å…ƒæ•°æ®,ç±»å‹ä¸º[string]")allNewData = allNewData &amp; "&lt;" &amp; tmpp1 &amp; " type=" &amp; Chr(34) &amp; "string"&amp; Chr(34) &amp;" length="&amp; Chr(34) &amp; "255" &amp; Chr(34) &amp;"/&gt;" &amp; vbcrlfalldata = alldata &amp; tmpp1 &amp; ","End IfEnd IfEnd IfLoopNextSet fso = Nothinglogfile.WriteLine(Now() &amp; "---&gt;å®Œæˆæ¯”è¾ƒ[" &amp; code &amp; "]ä¸å…ƒæ•°æ®çš„å·®å¼‚")End Sub'======================='ä¿®æ”¹æ‹†ç»„åŒ…æ–‡ä»¶'=======================Sub modifyPackFile(from,dest,code)'æ­¤å¤„éœ€è¦æ ¹æ®å„ä¸ªç°åœºä¿®æ”¹'ä¿®æ”¹æ‹†ç»„åŒ…æ–‡ä»¶é€»è¾‘éœ€è¦å†æ¬¡åˆ¤æ–­'isExistFlag = FalseSet fso = CreateObject("Scripting.FileSystemObject")logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹ä¿®æ”¹æ‹†ç»„åŒ…æ–‡ä»¶[" &amp; code &amp; "]")If Not fso.fileExists("Template\" &amp; dest &amp; ".xml") Or isExistFlag Thenlogfile.WriteLine(Now() &amp; "---&gt;æ²¡æœ‰æ¨¡ç‰ˆæ–‡ä»¶[" &amp; code &amp; "]")Exit Sub End If servicepath = newpath &amp; code &amp; "-metadata\out_config\" &amp; dest &amp; "\service_"&amp; code &amp;"_system_" &amp; dest &amp; ".xml"servicenewpath = newpath &amp; "service\service_"&amp; code &amp;"_system_" &amp; dest &amp; ".xml"channelepath = newpath &amp; code &amp; "-metadata\out_config\" &amp; dest &amp; "\channel_" &amp; dest &amp; "_service_" &amp; code &amp; ".xml"channelenewpath = newpath &amp; "service\channel_" &amp; dest &amp; "_service_" &amp; code &amp; ".xml"logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹ä¿®æ”¹ç»„åŒ…æ–‡ä»¶[" &amp; code &amp; "]")xdoc.load(servicepath)tmp1 = Replace(xdoc.xml,"s:","")tmp2 = Replace(tmp1,"d:","")tmp = Replace(tmp2,":","")tp = Replace(tmp,"xmlns=" &amp; Chr(34) &amp; "http//esb.dcitsbiz.com/services/"&amp; Left(code,11) &amp; Chr(34),"")xdoc.loadXML(tp)Set nodes = xdoc.documentElement.selectNodes(".//ReqAppBody")(0)addstr = ""For Each node In nodes.ChildNodesaddstr = addstr  &amp; "" &amp; node.Xml &amp; vbcrlfNextRepalceFile "Template\" &amp; dest &amp; ".xml",servicenewpath,addstrlogfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹ä¿®æ”¹æ‹†åŒ…æ–‡ä»¶[" &amp; code &amp; "]")xdoc.load(channelepath)tmp1 = Replace(xdoc.xml,"s:","")tmp2 = Replace(tmp1,"d:","")tmp = Replace(tmp2,":","")tp = Replace(tmp,"xmlns=" &amp; Chr(34) &amp; "http//esb.dcitsbiz.com/services/"&amp; Left(code,11) &amp; Chr(34),"")xdoc.loadXML(tp)Set nodes = xdoc.documentElement.selectNodes(".//RspAppBody")(0)addstr = ""For Each node In nodes.ChildNodesaddstr = addstr  &amp; "" &amp; node.Xml &amp; vbcrlfNextRepalceFile "Template\" &amp; dest &amp; ".xml",channelenewpath,addstrlogfile.WriteLine(Now() &amp; "---&gt;å®Œæˆä¿®æ”¹æ‹†ç»„åŒ…æ–‡ä»¶[" &amp; code &amp; "]")End Sub'======================='æ›¿æ¢æ–‡ä»¶'=======================Sub RepalceFile(fromfile,tofile,text)Set file1 = CreateObject("ADODB.Stream")file1.Mode = 3file1.Type = 1file1.Open()file1.LoadFromFile fromfilefile1.Position = 0file1.Type = 2file1.Charset = "utf-8"tmpfile = file1.ReadTextfile1.Position = 0file1.SetEosfile1.Type = 2file1.Charset = "utf-8"file1.WriteText Replace(tmpfile,"XXXXXXXXXXXXXXXXXXXX",text)file1.SaveToFile tofile,2Set file1 = NothingEnd Sub'======================='æ£€æŸ¥å…ƒæ•°æ®æ˜¯å¦å­˜åœ¨'=======================Function checkExists(strBase,strNeed,isExists)startPos = InStr(strBase,strNeed)If startPos = 0 ThenisExists = 0Exit FunctionElse'æ­¤å¤„è‹¥éœ€è¦çš„å…ƒæ•°æ®åœ¨å­—æ®µç»“å°¾ä¼šå‡ºç°é—®é¢˜isExists = startPosEnd IfendPos = InStr(startPos,strBase,",")newstart = InstrRev(Mid(strBase,1,startPos),",")newval =  Mid(strBase,newstart+1,endPos-newstart-1)newStrBase = Mid(strBase,endPos)'åªæœ‰é•¿åº¦ç›¸ç­‰çš„å…ƒæ•°æ®æ‰ç»§ç»­æ£€æŸ¥,å‡å°‘é€’å½’çš„æ¬¡æ•°While Len(newval) &lt;&gt; Len(strNeed)startPos = InStr(newStrBase,strNeed)'è‹¥æ–°çš„åŸºç¡€å­—ç¬¦ä¸²ä¸­ä¸å«éœ€è¦çš„å…ƒæ•°æ®ï¼Œç›´æ¥é€€å‡ºIf startPos = 0 ThenisExists = 0Exit FunctionEnd IfendPos = InStr(startPos,newStrBase,",")newstart = InstrRev(Mid(newStrBase,1,startPos),",")newval =  Mid(newStrBase,newstart+1,endPos-newstart-1)newStrBase = Mid(newStrBase,endPos)WendIf strNeed &lt;&gt; newval ThencheckExists newStrBase,strNeed,isExistsElseisExists = newstart+1Exit FunctionEnd If End Function'======================='æ‹·è´å…ƒæ•°æ®è‡³SVN'=======================Sub copyConfToSvn(code,from)logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹æ‹·è´æ–‡ä»¶è‡³SVN[" &amp; code &amp; "]")intemp = newpath &amp; code &amp; "-metadata\in_config\"outtemp = newpath &amp; code &amp; "-metadata\out_config\"Set fso = CreateObject("Scripting.FileSystemObject")Set oFolder = fso.GetFolder(intemp)Set oSubFolder = oFolder.SubFoldersSet outFolder = fso.GetFolder(outtemp)Set outSubFolder = outFolder.SubFolders'isExistFlag = FalseFor Each otmp In oSubFolderIf isExistFlag ThenIf Trim(LCase(otmp.Name)) &lt;&gt; "servicedefine" Then logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹æ‹·è´æ–‡ä»¶å¤¹--&gt;[" &amp; intemp &amp; otmp.Name &amp; "]")fso.CopyFolder intemp &amp; otmp.Name &amp; "*",svndestinEnd If Elselogfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹æ‹·è´æ–‡ä»¶å¤¹--&gt;[" &amp; intemp &amp; otmp.Name &amp; "]")fso.CopyFolder intemp &amp; otmp.Name &amp; "*",svndestinEnd If Next For Each itmp In outSubFolderIf Not isExistFlag Thenlogfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹æ‹·è´æ–‡ä»¶å¤¹--&gt;[" &amp; outtemp &amp; "]")fso.CopyFolder outtemp &amp; "*",svndestoutEnd If NextSet fso = NothingEnd Sub'======================='åŠ è½½æ–‡ä»¶ä¸­çš„äº¤æ˜“'=======================Function LoadTrans()versionLog()Set fso = CreateObject("Scripting.FileSystemObject")Set traninfo = fso.OpenTextFile("traninfo.txt",1,False)tmpstr = ""Do While traninfo.AtEndOfStream &lt;&gt; Trueline = traninfo.ReadLine()If Trim(line) &lt;&gt; "" Thennum = Len(line)- Len(Replace(line," ",""))If num &lt;&gt; 2 ThenExit FunctionEnd If tmpstr = tmpstr &amp; Replace(line," ",",") &amp; ";"End IfLoop'æ‹·è´æ–‡ä»¶è‡³tmpä¸‹serviceIdentify = "serviceIdentify.xml"systemIdentify = "systemIdentify.xml"metadata = "metadata.xml"fso.copyfile inconfpath &amp; serviceIdentify,commpath &amp; serviceIdentifyfso.copyfile inconfpath &amp; systemIdentify,commpath &amp; systemIdentifyfso.copyfile svnmetadata,commpath &amp; metadataLoadTrans = tmpstrSet fso = NothingEnd Function'=======================' æ›´æ–°SVN'=======================Function updateSVN()logfile.WriteLine(Now() &amp; "---&gt;å¼€å§‹æ›´æ–° SVN .......")cmdstr = "svn update "&amp; svnpathSet exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()logfile.WriteLine(Now() &amp; "---&gt;æ›´æ–° SVN æ—¥å¿—å¦‚ä¸‹:")logfile.WriteLine( retmsg)logfile.WriteLine(Now() &amp; "---&gt;æ›´æ–° SVN å®Œæˆ.......")End Function'======================='ä¸»æ–¹æ³•'=======================Sub Main()'tranText = InputBox("è¯·è¾“å…¥éœ€è¦å¼€å‘çš„äº¤æ˜“ï¼Œå½¢å¦‚[3001300000333,åŒå±ç³»ç»Ÿ,NCBS;]","æé†’","3001300000333,åŒå±ç³»ç»Ÿ,NCBS;")'==========æ›´æ–°SVNè‡³æœ€æ–°============updateSVN'==========åŠ è½½æ–‡æœ¬æ–‡ä»¶ä¸­çš„äº¤æ˜“============tranText = LoadTrans()If tranText = "" ThenMsgBox "è¯·æ£€æŸ¥[ traninfo.txt ]æ˜¯å¦å·²[ ç»ç²˜è´´äº¤æ˜“ ] æˆ– [ æœ‰å¤šä½™ç©ºæ ¼ ]!",0,"æ˜Ÿé˜³æé†’"Exit SubElseAns = MsgBox("[å¼€å§‹å¤„ç†]:   å…±[ " &amp;  UBound(Split(tranText,";")) &amp; " ]ä¸ªäº¤æ˜“" &amp; Chr(13) &amp; tranText,VbOKCancel,"æ˜Ÿé˜³æé†’")If Ans = vbCancel ThenMsgBox "ä½ å–æ¶ˆäº†æ“ä½œï¼",0,"æ˜Ÿé˜³æé†’"Exit Sub End If'==========ç™»å½•æœåŠ¡æ²»ç†å¹³å°============login "admin","753951"'===========åŠ è½½æœ€æ–°å…ƒæ•°æ®=============loadMetaData()'åˆ†å‰²æ¯æ¡è®°å½•trans = Split(tranText,";")'æ ¹æ®å¡«å†™çš„æ‰§è¡Œæ–¹æ³•è¿›è¡ŒtranFlow = InputBox("è¯·è¾“å…¥éœ€è¦æ‰§è¡Œçš„åŠ¨ä½œ:" &amp; Chr(13) &amp; "    1.  æ£€æŸ¥äº¤æ˜“æ˜¯å¦ä¸ºæ–°å¢       [ 1 ]" &amp; Chr(13) &amp; "    2.  å¯¼å‡ºå¹¶åªæ‰§è¡Œè„šæœ¬         [ 2 ]" &amp; Chr(13) &amp; "    3.  å¯¼å‡ºç›¸å…³é…ç½®æ–‡ä»¶         [ 3 ]" &amp; Chr(13) &amp; "    4.  ä¿®æ”¹å…¬å…±æ–‡ä»¶ç»“æ„         [ 4 ]" &amp; Chr(13) &amp; "    5.  æ¯”è¾ƒå…ƒæ•°æ®å·®å¼‚           [ 5 ]" &amp; Chr(13) &amp; "    6.  æ‹·è´æ–‡ä»¶è‡³SVNè·¯å¾„        [ 6 ]" &amp; Chr(13) &amp; "    7.  ä¿®æ”¹ç»„åŒ…æ–‡ä»¶             [ 7 ]" &amp; Chr(13) &amp; "    8.  ä¿®æ”¹Metadata.xmlæ–‡ä»¶     [ 8 ]" &amp; Chr(13) &amp; "    9.  è¿è¡Œæ–‡ä»¶æ¯”å¯¹             [ 9 ]" &amp; Chr(13) &amp; "    10. æµç¨‹å…¨éƒ¨æ‰§è¡Œ             [ A ]","æé†’","A")tranFlow = UCase(tranFlow)If tranFlow = "" Then MsgBox "ä½ å–æ¶ˆäº†æ“ä½œï¼"Exit SubEnd IfFor i= 0 To UBound(trans)'åˆ†å‰²äº¤æ˜“æ˜ç»†ä¿¡æ¯  --&gt;  3001300000333,åŒå±ç³»ç»Ÿ,NCBS;If trans(i) &lt;&gt; "" Thentraninfo =  Split(trans(i),",")code = Trim(traninfo(0))from = Trim(traninfo(1))dest = Trim(traninfo(2))'=========æ£€æŸ¥äº¤æ˜“æ˜¯å¦ä¸ºæ–°å¢===========If InStr(tranFlow,"1") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThencheckTran code,from,destEnd If '==========å¯¼å‡ºå¹¶åªæ‰§è¡Œè„šæœ¬============If InStr(tranFlow,"2") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThenexportAndRunSQLOne(code)End If '==========å¯¼å‡ºç›¸å…³é…ç½®æ–‡ä»¶============If InStr(tranFlow,"3") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThenexportConf from,dest,codeEnd If'==========ä¿®æ”¹å…¬å…±æ–‡ä»¶ç»“æ„============If InStr(tranFlow,"4") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThenmodifyXml from,dest,codeEnd If '===========æ¯”è¾ƒå…ƒæ•°æ®å·®å¼‚=============If InStr(tranFlow,"5") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThencompareMeteData codeEnd If '========æ‹·è´æ–‡ä»¶è‡³SVNè·¯å¾„=============If InStr(tranFlow,"6") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThencopyConfToSvn code,fromEnd If '===========ä¿®æ”¹ç»„åŒ…æ–‡ä»¶===============If InStr(tranFlow,"7") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThenmodifyPackFile from,dest,codeEnd If End If Next'ä¿®æ”¹Metadata.xmlæ–‡ä»¶If InStr(tranFlow,"8") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThenAddLineAfterWord svnmetadata,commpath &amp; "metadata.xml","metadata",allNewDataEnd If 'è¿è¡Œæ–‡ä»¶æ¯”å¯¹'CompareAns = MsgBox("éœ€è¦è¿›è¡Œæ–‡ä»¶æ¯”å¯¹å—ï¼Ÿ",VbOKCancel,"æ˜Ÿé˜³æé†’")'If CompareAns &lt;&gt; vbCancel ThenIf InStr(tranFlow,"9") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 Then'æ¯”å¯¹ serviceIdentify.xmlwshshell.run("BComp.exe " &amp; commpath &amp; "serviceIdentify.xml "&amp; inconfpath &amp;"serviceIdentify.xml")'æ¯”å¯¹ systemIdentify.xmlwshshell.run("BComp.exe " &amp; commpath &amp; "systemIdentify.xml "&amp; inconfpath &amp;"systemIdentify.xml")'æ¯”å¯¹ metadata.xmlwshshell.run("BComp.exe " &amp; commpath &amp; "metadata.xml "&amp; inconfpath &amp;"metadata\metadata.xml")'in out æ¯”å¯¹wshshell.run("BComp.exe " &amp; outconfpath &amp; "systemIdentify.xml "&amp; inconfpath &amp;"systemIdentify.xml")wshshell.run("BComp.exe " &amp; outconfpath &amp; "metadata\metadata.xml "&amp; inconfpath &amp;"metadata\metadata.xml")'End IfEnd IfEnd Iflogfile.WriteLine(Now() &amp; "---&gt;é…ç½®æ–‡ä»¶å…±[" &amp; totalNum &amp; "]ä¸ª")MsgBox "o(âˆ©_âˆ©)o å•¦å•¦å•¦-&gt;[ å…¨éƒ¨å¤„ç†å®Œæˆ ] o(âˆ©_âˆ©)o",0,"æ˜Ÿé˜³æé†’"End SubMain()Set http = NothingSet html = NothingSet wshshell = NothingSet xdoc = NothingSet logfso = NothingSet tranfso = Nothing<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5.æ€»ç»“"></a>5.æ€»ç»“</h3><hr><p>ä»£ç ä¸å¤æ‚ï¼Œå°±æ˜¯è¦æŠŠå„ä¸ªä¸œè¥¿ä¸²è”èµ·æ¥æ¯”è¾ƒéº»çƒ¦ã€‚åœ¨è¿™åšä¸ªå¤‡ä»½ï¼Œä»¥é˜²ä»¥åä¼šç”¨åˆ°ä¸­é—´çš„ä¸œè¥¿ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
            <tag> vbs </tag>
            
            <tag> æ•ˆç‡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HAæ±Ÿè‹ç”µè´¹æ’ä»¶</title>
      <link href="2021/04/06/jsdf/"/>
      <url>2021/04/06/jsdf/</url>
      
        <content type="html"><![CDATA[<h3 id="0-å‰è¨€ä»‹ç»"><a href="#0-å‰è¨€ä»‹ç»" class="headerlink" title="0.å‰è¨€ä»‹ç»"></a>0.å‰è¨€ä»‹ç»</h3><hr><p>ä¹‹å‰ä¸€ç›´æƒ³æŠŠæ°´ç”µç‡ƒæ°”éƒ½æ¥å…¥HAï¼Œæ°´å’Œç‡ƒæ°”éƒ½æ¥å…¥äº†ï¼Œç”µè´¹ä¸€ç›´æ²¡æœ‰æ¥å…¥ã€‚ä¸€å¼€å§‹å°è¯•ç½‘ä¸ŠæŠ“åŒ…ï¼Œæœ‰ä¸ªå˜é‡æ²¡æ‘¸é€å®ƒçš„è§„å¾‹ï¼Œæ‰€ä»¥æ²¡åŠæ³•å…¥æ‰‹ã€‚åé¢å‘ç°å°ç¨‹åºä¹Ÿå¯ä»¥æŸ¥ç”µè´¹ï¼Œæ‰€ä»¥å‡†å¤‡ä»å°ç¨‹åºå…¥æ‰‹ï¼ŒæŠ“åŒ…çœ‹çœ‹èƒ½ä¸èƒ½å¤Ÿæœ‰ä»€ä¹ˆå‘ç°ã€‚</p><h3 id="1-æŠ“åŒ…å‡†å¤‡"><a href="#1-æŠ“åŒ…å‡†å¤‡" class="headerlink" title="1.æŠ“åŒ…å‡†å¤‡"></a>1.æŠ“åŒ…å‡†å¤‡</h3><hr><p>æœç´¢å¾®ä¿¡å°ç¨‹åº <strong>å›½ç½‘æ±Ÿè‹ç”µåŠ›è¥ä¸šå…</strong> æŠ“ä¸‹åŒ…ã€‚æŠ“åŒ…çš„å·¥å…·å¯ä»¥ä½¿ç”¨ <strong>Fiddler</strong>  è‹¹æœæ‰‹æœºä¸Šå¯ä»¥ä½¿ç”¨ <strong>Stream</strong> éƒ½æ˜¯æŒºå¥½ç”¨çš„ã€‚</p><h3 id="2-æŠ“åŒ…"><a href="#2-æŠ“åŒ…" class="headerlink" title="2.æŠ“åŒ…"></a>2.æŠ“åŒ…</h3><hr><p>åœ¨æŠ“åŒ…çš„ç»“æœä¸­æ‰¾æ‰¾æœ‰æ²¡æœ‰å“ªä¸ªè¿”å›é‡‘é¢ç­‰ç›¸å…³æ•°æ®çš„ã€‚æ‰¾äº†æ‰¾ï¼Œæ‰¾åˆ°äº† <strong><a href="https://weixin.js.sgcc.com.cn/wxapp_dlsh/wx/oauth_executeNewMini.do?openid=xxxxxxxxx&amp;timestamp=xxxxx&amp;noncestr=xxxxxxx&amp;sign=xxxxxxxx&amp;unionid=xxxxxxx&amp;userInfo=null">https://weixin.js.sgcc.com.cn/wxapp_dlsh/wx/oauth_executeNewMini.do?openid=xxxxxxxxx&amp;timestamp=xxxxx&amp;noncestr=xxxxxxx&amp;sign=xxxxxxxx&amp;unionid=xxxxxxx&amp;userInfo=null</a></strong> è¿™ä¸ªåœ°å€ã€‚é€šè¿‡å¤šæ¬¡å¯¹æ¯”è¿™ä¸ªé“¾æ¥ï¼Œå‘ç°  </p><p><strong>openid=xxxxxxxxx   //å›ºå®šçš„</strong><br><strong>timestamp=xxxxx</strong>   <strong>// å˜åŠ¨çš„</strong></p><p><strong>noncestr=xxxxxxx</strong>  <strong>//å˜åŠ¨çš„</strong><br><strong>sign=xxxxxxxx      // å˜åŠ¨çš„</strong><br><strong>unionid=xxxxxxx</strong>    <strong>//å›ºå®šçš„</strong></p><p><strong>timestamp</strong> <strong>noncestr</strong> <strong>sign</strong> è¿™ä¸‰ä¸ªå‚æ•°æ˜¯æœ‰å…³è”å…³ç³»ï¼Œä¸èƒ½å¤Ÿéšæ„æ”¹åŠ¨ã€‚è¿™ä¸ªåœ°å€çš„è¿”å›ç»“æœä¸­ä¹Ÿä¼šè¿”å›è¿™ä¸‰ä¸ªå­—æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¿…è€ƒè™‘ä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå†æ¬¡è°ƒç”¨æ˜¯ï¼ŒæŠŠä¹‹å‰çš„å‚æ•°æ›¿æ¢æˆç°åœ¨æœ€æ–°çš„å³å¯ã€‚</p><h3 id="3-ç¼–å†™æ’ä»¶"><a href="#3-ç¼–å†™æ’ä»¶" class="headerlink" title="3.ç¼–å†™æ’ä»¶"></a>3.ç¼–å†™æ’ä»¶</h3><hr><p>åˆ†æåˆ°ä¸Šé¢é‚£æ­¥ä¹‹åæ’ä»¶å†™èµ·æ¥å°±ç®€å•äº†ï¼Œå…¶å®å°±æ˜¯è§£æå‚æ•°èµ‹å€¼çš„äº‹æƒ…äº†ã€‚ä»£ç å¦‚ä¸‹:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""Support for guojiadianwang# Author:    freefitter# Created:    2020/9/2"""</span><span class="token keyword">import</span> logging<span class="token keyword">import</span> json<span class="token keyword">import</span> configparser<span class="token keyword">import</span> time<span class="token punctuation">,</span> datetime<span class="token keyword">from</span> dateutil<span class="token punctuation">.</span>relativedelta <span class="token keyword">import</span> relativedelta <span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>const <span class="token keyword">import</span> <span class="token punctuation">(</span>    CONF_API_KEY<span class="token punctuation">,</span> CONF_NAME<span class="token punctuation">,</span> ATTR_ATTRIBUTION<span class="token punctuation">,</span> CONF_ID    <span class="token punctuation">)</span><span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>helpers<span class="token punctuation">.</span>entity <span class="token keyword">import</span> Entity<span class="token keyword">import</span> homeassistant<span class="token punctuation">.</span>helpers<span class="token punctuation">.</span>config_validation <span class="token keyword">as</span> cv<span class="token keyword">import</span> voluptuous <span class="token keyword">as</span> vol<span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>components<span class="token punctuation">.</span>sensor <span class="token keyword">import</span> PLATFORM_SCHEMA<span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup_Log<span class="token operator">=</span>logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>DEFAULT_NAME <span class="token operator">=</span> <span class="token string">'gjdw'</span>OPENID <span class="token operator">=</span> <span class="token string">'openid'</span>NONCESTR <span class="token operator">=</span> <span class="token string">'noncestr'</span>SIGN <span class="token operator">=</span> <span class="token string">'sign'</span>UNIONID <span class="token operator">=</span> <span class="token string">'unionid'</span>TIMESTAMP1 <span class="token operator">=</span> <span class="token string">'timestamp'</span>PLATFORM_SCHEMA <span class="token operator">=</span> PLATFORM_SCHEMA<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>OPENID<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>NONCESTR<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>SIGN<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>UNIONID<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>TIMESTAMP1<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>    vol<span class="token punctuation">.</span>Optional<span class="token punctuation">(</span>CONF_NAME<span class="token punctuation">,</span> default<span class="token operator">=</span> DEFAULT_NAME<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>HEADERS <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'Host'</span><span class="token punctuation">:</span> <span class="token string">'weixin.js.sgcc.com.cn'</span><span class="token punctuation">,</span>    <span class="token string">'Connection'</span><span class="token punctuation">:</span>  <span class="token string">'keep-alive'</span><span class="token punctuation">,</span>    <span class="token string">'Content-Length'</span><span class="token punctuation">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>    <span class="token string">'content-type'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>    <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip,compress,br,deflate'</span><span class="token punctuation">,</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (iPhone; CPU iPhone OS 14_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 MicroMessenger/8.0.0(0x18000026) NetType/WIFI Language/zh_CN'</span><span class="token punctuation">,</span>    <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'https://servicewechat.com/wx203b37ad2ad5d2a6/32/page-frame.html'</span><span class="token punctuation">,</span><span class="token punctuation">}</span>API_URL <span class="token operator">=</span> <span class="token string">"https://weixin.js.sgcc.com.cn/wxapp_dlsh/wx/oauth_executeNewMini.do"</span><span class="token keyword">def</span> <span class="token function">setup_platform</span><span class="token punctuation">(</span>hass<span class="token punctuation">,</span> config<span class="token punctuation">,</span> add_devices<span class="token punctuation">,</span> discovery_info<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    sensor_name <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>CONF_NAME<span class="token punctuation">)</span>    openid <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>OPENID<span class="token punctuation">)</span>    unionid <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>UNIONID<span class="token punctuation">)</span>    cfg <span class="token operator">=</span> configparser<span class="token punctuation">.</span>ConfigParser<span class="token punctuation">(</span><span class="token punctuation">)</span>    cfg<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">'param.ini'</span><span class="token punctuation">)</span>    timestamp1 <span class="token operator">=</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Param'</span><span class="token punctuation">,</span> <span class="token string">'timestamp'</span><span class="token punctuation">)</span>    noncestr <span class="token operator">=</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Param'</span><span class="token punctuation">,</span> <span class="token string">'noncestr'</span><span class="token punctuation">)</span>    sign <span class="token operator">=</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Param'</span><span class="token punctuation">,</span> <span class="token string">'sign'</span><span class="token punctuation">)</span>        url <span class="token operator">=</span> API_URL <span class="token operator">+</span> <span class="token string">"?openid="</span> <span class="token operator">+</span> openid <span class="token operator">+</span><span class="token string">"&amp;timestamp="</span> <span class="token operator">+</span> timestamp1 <span class="token operator">+</span> <span class="token string">"&amp;noncestr="</span> <span class="token operator">+</span> noncestr <span class="token operator">+</span> <span class="token string">"&amp;sign="</span> <span class="token operator">+</span> sign <span class="token operator">+</span> <span class="token string">"&amp;unionid="</span> <span class="token operator">+</span> unionid <span class="token operator">+</span> <span class="token string">"&amp;userInfo=null"</span>        _Log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"url:"</span> <span class="token operator">+</span> url <span class="token punctuation">)</span>    add_devices<span class="token punctuation">(</span><span class="token punctuation">[</span>GJDW<span class="token punctuation">(</span>sensor_name<span class="token punctuation">,</span>url<span class="token punctuation">,</span>openid<span class="token punctuation">,</span>unionid<span class="token punctuation">,</span>cfg<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">GJDW</span><span class="token punctuation">(</span>Entity<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Representation of a guojiadianwang """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>sensor_name<span class="token punctuation">,</span>url<span class="token punctuation">,</span>openid<span class="token punctuation">,</span>unionid<span class="token punctuation">,</span>cfg<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>attributes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token boolean">None</span>        self<span class="token punctuation">.</span>_name <span class="token operator">=</span> sensor_name        self<span class="token punctuation">.</span>_url <span class="token operator">=</span> url        self<span class="token punctuation">.</span>_openid <span class="token operator">=</span> openid        self<span class="token punctuation">.</span>_unionid <span class="token operator">=</span> unionid        self<span class="token punctuation">.</span>_cfg <span class="token operator">=</span> cfg    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the name of the sensor."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_name    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">state</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the state of the sensor."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_state    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">icon</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""   mdi   ."""</span>        <span class="token keyword">return</span> <span class="token string">'mdi:flash'</span>    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">device_state_attributes</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the state attributes."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>attributes    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">unit_of_measurement</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the unit this state is expressed in."""</span>        <span class="token keyword">return</span> <span class="token string">"å…ƒ"</span>    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token triple-quoted-string string">"""_Log.error("url:" + self._url)"""</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_url<span class="token punctuation">,</span>headers <span class="token operator">=</span> HEADERS<span class="token punctuation">)</span>        <span class="token keyword">except</span> ReadTimeout<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Connection timeout...."</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> ConnectionError<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Connection Error...."</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> RequestException<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Unknown Error"</span><span class="token punctuation">)</span>        res <span class="token operator">=</span> response<span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> res<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"html"</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"å‚æ•°å­˜åœ¨é—®é¢˜,è¯·é‡æ–°æŠ“åŒ…å¡«å†™"</span><span class="token punctuation">)</span>            <span class="token keyword">return</span>            <span class="token triple-quoted-string string">"""_Log.error(res)"""</span>        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>res<span class="token punctuation">)</span>        <span class="token keyword">if</span> ret<span class="token punctuation">[</span><span class="token string">"errcode"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"0000"</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token string">"owe_amt"</span> <span class="token keyword">in</span> ret<span class="token punctuation">[</span><span class="token string">"yeModel"</span><span class="token punctuation">]</span> <span class="token punctuation">:</span>                self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token builtin">round</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>ret<span class="token punctuation">[</span><span class="token string">"yeModel"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"owe_amt"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'rca_flag'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"yeModel"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"rca_flag"</span><span class="token punctuation">]</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'cur_amt'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"yeModel"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"cur_amt"</span><span class="token punctuation">]</span>                curfeeMsg <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>ret<span class="token punctuation">[</span><span class="token string">"curfee"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'ymd'</span><span class="token punctuation">]</span> <span class="token operator">=</span> curfeeMsg<span class="token punctuation">[</span><span class="token string">"ymd"</span><span class="token punctuation">]</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'totalMoney'</span><span class="token punctuation">]</span> <span class="token operator">=</span> curfeeMsg<span class="token punctuation">[</span><span class="token string">"totalMoney"</span><span class="token punctuation">]</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'powerSum'</span><span class="token punctuation">]</span> <span class="token operator">=</span> curfeeMsg<span class="token punctuation">[</span><span class="token string">"powerSum"</span><span class="token punctuation">]</span>                dbObjMsg <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>ret<span class="token punctuation">[</span><span class="token string">"dbObj"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'stepNo'</span><span class="token punctuation">]</span> <span class="token operator">=</span> dbObjMsg<span class="token punctuation">[</span><span class="token string">"stepNo"</span><span class="token punctuation">]</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'yearAmount'</span><span class="token punctuation">]</span> <span class="token operator">=</span> dbObjMsg<span class="token punctuation">[</span><span class="token string">"yearAmount"</span><span class="token punctuation">]</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'isUpdated'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'yes'</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'rca_flag'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'-1'</span>            self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'cur_amt'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'-1'</span>            self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'isUpdated'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'no'</span>            <span class="token comment">#_Log.error("yeModel is null !")</span>            <span class="token comment"># æ›´æ–°urlå‚æ•° </span>            url <span class="token operator">=</span> API_URL <span class="token operator">+</span> <span class="token string">"?openid="</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_openid <span class="token operator">+</span><span class="token string">"&amp;timestamp="</span> <span class="token operator">+</span> ret<span class="token punctuation">[</span><span class="token string">"timestamp"</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&amp;noncestr="</span> <span class="token operator">+</span> ret<span class="token punctuation">[</span><span class="token string">"noncestr"</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&amp;sign="</span> <span class="token operator">+</span> ret<span class="token punctuation">[</span><span class="token string">"sign"</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&amp;unionid="</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_unionid <span class="token operator">+</span> <span class="token string">"&amp;userInfo=null"</span>             self<span class="token punctuation">.</span>_url <span class="token operator">=</span> url            <span class="token comment"># ä¿å­˜å‚æ•°è‡³æ–‡æœ¬</span>            self<span class="token punctuation">.</span>_cfg<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"Param"</span><span class="token punctuation">,</span> <span class="token string">"timestamp"</span><span class="token punctuation">,</span> ret<span class="token punctuation">[</span><span class="token string">"timestamp"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>_cfg<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"Param"</span><span class="token punctuation">,</span> <span class="token string">"noncestr"</span><span class="token punctuation">,</span> ret<span class="token punctuation">[</span><span class="token string">"noncestr"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>_cfg<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"Param"</span><span class="token punctuation">,</span> <span class="token string">"sign"</span><span class="token punctuation">,</span> ret<span class="token punctuation">[</span><span class="token string">"sign"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>_cfg<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'param.ini'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"send request error...."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœé‡å¯ä¼šå¯¼è‡´å‚æ•°å¤±æ•ˆï¼Œæ‰€ä»¥æ’ä»¶æŠŠå˜åŠ¨çš„å‚æ•°ä¿å­˜äº†ä¸‹æ¥ï¼Œæ¯æ¬¡æ’ä»¶æ›´æ–°çš„æ—¶å€™å°†ç›¸å…³çš„å‚æ•°æ›´æ–°è¿›å»ï¼Œè¿™æ ·é‡å¯æ—¶é—´ä¸é•¿çš„è¯å°±ä¸éœ€è¦é‡æ–°æŠ“åŒ…äº†ã€‚</p><h3 id="4-HAé…ç½®"><a href="#4-HAé…ç½®" class="headerlink" title="4.HAé…ç½®"></a>4.HAé…ç½®</h3><hr><p>åœ¨é…ç½®æ–‡ä»¶ä¸­åŠ ä¸Šå¦‚ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> gjdw<span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'ç”µè´¹'</span><span class="token key atrule">openid</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxxxx-xxxxxxxxx'</span><span class="token key atrule">noncestr</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxxxx'</span><span class="token key atrule">sign</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxxxx'</span><span class="token key atrule">unionid</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxxxx'</span><span class="token key atrule">timestamp</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxxxx'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¢åŠ   <strong>param.ini</strong> é…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token selector">[Param]</span><span class="token constant">timestamp</span> <span class="token attr-value"><span class="token punctuation">=</span> xxxxxxxxx</span><span class="token constant">noncestr</span> <span class="token attr-value"><span class="token punctuation">=</span> xxxxxxxxx</span><span class="token constant">sign</span> <span class="token attr-value"><span class="token punctuation">=</span> xxxxxxxxx</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-æˆæœå±•ç¤º"><a href="#5-æˆæœå±•ç¤º" class="headerlink" title="5.æˆæœå±•ç¤º"></a>5.æˆæœå±•ç¤º</h3><hr><p><img src="/img/20210406/dianfei.png" alt="æ’ä»¶å±•ç¤º"></p><h3 id="6-é™„ä»¶ä¸‹è½½"><a href="#6-é™„ä»¶ä¸‹è½½" class="headerlink" title="6.é™„ä»¶ä¸‹è½½"></a>6.é™„ä»¶ä¸‹è½½</h3><hr><p><a href="/download/%E7%94%B5%E8%B4%B9%E6%8F%92%E4%BB%B6.zip">ç‚¹å‡»ä¸‹è½½</a> æ’ä»¶</p><p>æˆ–è€…å»è®ºå›æˆ‘å‘çš„ <a href="https://bbs.hassbian.com/thread-12037-1-1.html"><strong>ç”µè´¹æ’ä»¶-è¿™æ¬¡åº”è¯¥å…¨å›½é€šç”¨äº†å§</strong></a> å¸–å­ä¸‹è½½ã€‚</p><h3 id="7-ç»“è¯­"><a href="#7-ç»“è¯­" class="headerlink" title="7.ç»“è¯­"></a>7.ç»“è¯­</h3><hr><p>è‡ªå·±å†™å†™æ’ä»¶è¿˜æ˜¯æŒºå¥½ç©çš„ï¼Œæœ€è¿‘ç©äº†ç©Node-Redå’ŒMQTTï¼Œæ„Ÿè§‰è¿™ä¸ªææ’ä»¶è¿˜æ˜¯å¿«çš„ã€‚æœ‰å‡ ä¸ªå†™å¥½çš„æ’ä»¶å¯ä»¥å…ˆçœ‹çœ‹ï¼ŒæŠ“äº†ç¾é£Ÿæ°å’Œå¾®åšçƒ­æœçš„æ•°æ®</p><p><img src="/img/20210406/info.png" alt="MQTTæ’ä»¶å±•ç¤º"></p>]]></content>
      
      
      <categories>
          
          <category> æ™ºèƒ½å®¶å±… </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HA </tag>
            
            <tag> python </tag>
            
            <tag> æ’ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°é•¿å‡æ¸¸è®°</title>
      <link href="2021/04/05/jq-2021-qm/"/>
      <url>2021/04/05/jq-2021-qm/</url>
      
        <content type="html"><![CDATA[<h3 id="0-å‡æœŸå®‰æ’"><a href="#0-å‡æœŸå®‰æ’" class="headerlink" title="0.å‡æœŸå®‰æ’"></a>0.å‡æœŸå®‰æ’</h3><p>â€‹    ä¸‰å¤©çš„å°é•¿å‡ï¼Œå›å®¶ç¥­ç¥–é¡ºä¾¿å¸¦å°å­©ç©ç©ã€‚</p><h3 id="1-ç¬¬ä¸€å¤©"><a href="#1-ç¬¬ä¸€å¤©" class="headerlink" title="1.ç¬¬ä¸€å¤©"></a>1.ç¬¬ä¸€å¤©</h3><p>â€‹     æ—©ä¸Šæ—©æ—©èµ·åºŠï¼Œæƒ³ç€æ—©ç‚¹èµ°è·¯ä¸Šä¸ä¼šå µè½¦ï¼Œå¥ˆä½•èµ°çš„è¿˜æ˜¯ä¸å¤Ÿæ—©ï¼Œ9:00äº†æ‰å‡ºé—¨ã€‚åœ¨å‡ºåŸçš„è·¯ä¸Šè¿˜æ˜¯å µäº†ä¸€ä¼šçš„ï¼Œä¸Šäº†é«˜é€Ÿåå°±å¥½äº†å¾ˆå¤šäº†ã€‚å›å»ä¹‹åå·²ç»ä¸­åˆäº†ï¼Œå»å–äº†ä¸ªé¸­æ±¤å°±å›å»ä¼‘æ¯äº†ã€‚é¸­æ±¤æ²¡æœ‰ä¹‹å‰çš„å¥½å–äº†ï¼Œé—¨é¢ä¹Ÿå˜å°äº†ã€‚[ å›¾ç‰‡ç½‘ä¸Šæ‰¾çš„ï¼Œè¿˜æ˜¯ä¹‹å‰çš„åº—é¢ ]</p><p><img src="/img/20210405/jangmuya0.jpg" alt="è€é¸­æ±¤çš„åº—"></p><p>ä¸‹åˆå½¤å¦ˆçº¦äº†é—ºèœœå‡ºå»ç©ï¼Œæˆ‘å°±å’Œå½¤å®ä¸€èµ·ç¡è§‰ä¼‘æ¯äº†ã€‚è¿™ä¸€ç¡å°±åˆ°4ç‚¹å¤šäº†ã€‚èµ·æ¥å¼„å¼„ä¹‹åï¼Œå»æ¥å½¤å¦ˆä¹‹åï¼Œé¡ºä¾¿å¸¦å½¤å½¤è§è§å¥¹çš„é˜¿å§¨ä»¬ã€‚æ¥ç€æ™šä¸Šåˆæ˜¯ä¸€ä¸ªå°é¥­å±€ã€‚</p><h3 id="2-ç¬¬äºŒå¤©"><a href="#2-ç¬¬äºŒå¤©" class="headerlink" title="2.ç¬¬äºŒå¤©"></a>2.ç¬¬äºŒå¤©</h3><p>â€‹    ä»Šå¤©æ˜¯æ¸…æ˜ï¼Œæ€•è·¯ä¸Šå µï¼Œæ—©ç‚¹èµ·åºŠå›è€å®¶ç¥­ç¥–ã€‚å›å®¶çš„è·¯ä¸Šè¿˜å¥½ï¼Œä¸æ˜¯ç‰¹åˆ«çš„å µã€‚æ—©æ—©å°±åˆ°å®¶äº†ã€‚åˆ°äº†è€å®¶å°å®¶ä¼™å°±å¼€å§‹æŒ–æŒ–åœŸäº†ã€‚</p><p><img src="/img/20210405/IMG_1567.jpg" alt="çˆ±æŒ–åœŸå®å®0"><img src="/img/20210405/IMG_1568.jpg" alt="çˆ±æŒ–åœŸå®å®1"></p><p>â€‹    ç¥­ç¥–åä¼‘æ¯äº†ä¸€ä¸‹ï¼Œçº¦äº†å°ä¼™ä¼´ä¸€èµ·é›å¨ƒã€‚å»äº†ä¸€ä¸ªä¹‹å‰ä¸€ç›´æƒ³å»ä½†æ˜¯æ²¡å»çš„åœ°æ–¹ï¼Œå¤©æ°”å’Œé£æ™¯éƒ½ä¸é”™ã€‚å½¤å®åˆ°äº†ä¹‹åè¿˜æ˜¯å…ˆæŒ–åœŸ<span class="github-emoji"><span>ğŸ˜„</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>ã€‚</p><p><img src="/img/20210405/IMG_1572.jpg" alt="çˆ±æŒ–åœŸå®å®2"></p><p>ä¹‹å‰å°ä¼™ä¼´çš„å®å®åœ¨ç¡è§‰ï¼Œæ²¡èƒ½ä¸€èµ·å‚ä¸ï¼Œå¥½åœ¨ä¸€ä¼šå¥¹å°±é†’äº†ï¼Œç„¶åæ¡äº†ä¸ªé£ç­ï¼Œå°±ä¸€èµ·ç©äº†èµ·æ¥äº†ã€‚</p><p><img src="/img/20210405/yiqi.jpg" alt="ä¸€èµ·æ”¾é£ç­"></p><h3 id="3-æœ€åä¸€å¤©"><a href="#3-æœ€åä¸€å¤©" class="headerlink" title="3.æœ€åä¸€å¤©"></a>3.æœ€åä¸€å¤©</h3><p>â€‹    å¾ˆå¿«å°±è¦å’Œå°é•¿å‡è¯´æ‹œæ‹œäº†ã€‚æœ€åä¸€å¤©è¦æ—©ç‚¹å›å—äº¬ï¼Œå›å»ç»™ä»–åšç‚¹é¢åŒ…å’Œé¥ºå­ï¼Œè¿™æ ·å¹³æ—¶å¯ä»¥åƒåƒã€‚æœ¬æ¥æƒ³ç€ä¸­åˆæ—©ç‚¹èµ°å›ä¸å µçš„ï¼Œäº‹ä¸æ„¿è¿ï¼Œä¾ç„¶å µã€‚èµ°çš„æ—©äº›æ—¶é—´ä¹Ÿå……è£•äº›ã€‚å›å®¶å°±å¼€å§‹å¹²æ´»äº†ï¼Œä¸€ä¸‹æ˜¯ç‰›è§’åŒ…çš„æˆæœå›¾ï¼Œè¿˜æ˜¯å¯ä»¥çš„ã€‚é¥ºå­çš„å›¾æ²¡æ‹ã€‚ä¸‹æ¬¡äº‰å–éƒ½å›¾ã€‚</p><p><img src="/img/20210405/njb.jpg" alt="ç‰›è§’åŒ…"></p><h3 id="4-æ€»ç»“"><a href="#4-æ€»ç»“" class="headerlink" title="4.æ€»ç»“"></a>4.æ€»ç»“</h3><p>   ä¸‰å¤©çš„å°é•¿å‡è¿˜ç®—å¿«ä¹ï¼ŒæœŸå¾…ä¸‹æ¬¡çš„æ¸¸è®°ã€‚<span class="github-emoji"><span>ğŸ˜†</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f606.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p>]]></content>
      
      
      <categories>
          
          <category> ç”Ÿæ´» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸¸ç© </tag>
            
            <tag> é›å¨ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HAå—äº¬æ°´è´¹æ’ä»¶</title>
      <link href="2021/04/02/njwater/"/>
      <url>2021/04/02/njwater/</url>
      
        <content type="html"><![CDATA[<h3 id="0-æ’ä»¶å‡†å¤‡"><a href="#0-æ’ä»¶å‡†å¤‡" class="headerlink" title="0.æ’ä»¶å‡†å¤‡"></a>0.æ’ä»¶å‡†å¤‡</h3><p>a) ç™»å½•<a href="http://www.jlwater.com/login.html">å—äº¬æ°´åŠ¡</a>çš„å®˜ç½‘</p><p>b) æŒ‰ä½F12è¿›å…¥å¼€å‘è€…æ¨¡å¼</p><p>c) æ‹¿åˆ°cookieå’Œå®¢æˆ·å·</p><p>ç»“æœå¦‚å›¾ï¼š</p><p><img src="/img/njwater/njwater01.png" alt="ç»“æœæˆªå›¾"></p><h3 id="1-é…ç½®HA"><a href="#1-é…ç½®HA" class="headerlink" title="1.é…ç½®HA"></a>1.é…ç½®HA</h3><p>å°†è‡ªå®šä¹‰æ’ä»¶ä¸Šä¼ åˆ°å¯¹åº”çš„ç›®å½•ä¸‹</p><p>custom_components<br>â””â”€nanjing_water<br>        sensor.py<br>        __init__.py</p><p>æ¥ç€åœ¨ configuration.yaml ä¸­æ·»åŠ </p><p><strong>sensor:</strong></p><p>  <strong>- platform: nanjing_water</strong><br>     <strong>name: â€˜æ°´è´¹â€™</strong><br>     <strong>custno: â€˜XXXXXâ€™</strong><br>     <strong>cookies: â€˜XXXXXXXXXXXXXXâ€™</strong></p><h3 id="2-é‡å¯HA"><a href="#2-é‡å¯HA" class="headerlink" title="2.é‡å¯HA"></a>2.é‡å¯HA</h3><h3 id="3-ç»“æœå±•ç¤º"><a href="#3-ç»“æœå±•ç¤º" class="headerlink" title="3.ç»“æœå±•ç¤º"></a>3.ç»“æœå±•ç¤º</h3><p><img src="/img/njwater/njwater02.png" alt="ç»“æœæˆªå›¾"></p><h3 id="4-ä»£ç å±•ç¤º"><a href="#4-ä»£ç å±•ç¤º" class="headerlink" title="4.ä»£ç å±•ç¤º"></a>4.ä»£ç å±•ç¤º</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""Support for nanjing water# Author: freefitter# Created: 2019-08-21"""</span><span class="token keyword">import</span> logging<span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>const <span class="token keyword">import</span> <span class="token punctuation">(</span>    CONF_API_KEY<span class="token punctuation">,</span> CONF_NAME<span class="token punctuation">,</span> ATTR_ATTRIBUTION<span class="token punctuation">,</span> CONF_ID    <span class="token punctuation">)</span><span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>helpers<span class="token punctuation">.</span>entity <span class="token keyword">import</span> Entity<span class="token keyword">import</span> homeassistant<span class="token punctuation">.</span>helpers<span class="token punctuation">.</span>config_validation <span class="token keyword">as</span> cv<span class="token keyword">import</span> voluptuous <span class="token keyword">as</span> vol<span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>components<span class="token punctuation">.</span>sensor <span class="token keyword">import</span> PLATFORM_SCHEMA<span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup_Log<span class="token operator">=</span>logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>DEFAULT_NAME <span class="token operator">=</span> <span class="token string">'nanjing_water'</span>COOKIES <span class="token operator">=</span> <span class="token string">'cookies'</span>CUSTNO <span class="token operator">=</span> <span class="token string">'custno'</span>PLATFORM_SCHEMA <span class="token operator">=</span> PLATFORM_SCHEMA<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>    vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>COOKIES<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>    vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>CUSTNO<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>    vol<span class="token punctuation">.</span>Optional<span class="token punctuation">(</span>CONF_NAME<span class="token punctuation">,</span> default<span class="token operator">=</span> DEFAULT_NAME<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>HEADERS <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">,</span>    <span class="token string">'Upgrade-Insecure-Requests'</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>    <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'</span><span class="token punctuation">,</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (iPhone; CPU iPhone OS 12_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 MicroMessenger/7.0.5(0x17000523) NetType/WIFI Language/zh_CN'</span><span class="token punctuation">,</span>    <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'http://www.jlwater.com/waterFee/waterWx'</span><span class="token punctuation">,</span>    <span class="token string">'Accept-Language'</span><span class="token punctuation">:</span> <span class="token string">'zh-cn'</span><span class="token punctuation">,</span>    <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip, deflate'</span><span class="token punctuation">}</span>API_URL <span class="token operator">=</span> <span class="token string">"http://www.jlwater.com/waterFee/detail"</span><span class="token keyword">def</span> <span class="token function">setup_platform</span><span class="token punctuation">(</span>hass<span class="token punctuation">,</span> config<span class="token punctuation">,</span> add_devices<span class="token punctuation">,</span> discovery_info<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    cookies <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>COOKIES<span class="token punctuation">)</span>    custno <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>CUSTNO<span class="token punctuation">)</span>    sensor_name <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>CONF_NAME<span class="token punctuation">)</span>    query_dict <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">'consNo'</span><span class="token punctuation">:</span> custno<span class="token punctuation">,</span>    <span class="token punctuation">}</span>    HEADERS<span class="token punctuation">[</span><span class="token string">"Cookie"</span><span class="token punctuation">]</span> <span class="token operator">=</span> cookies    add_devices<span class="token punctuation">(</span><span class="token punctuation">[</span>NanjingWater<span class="token punctuation">(</span>sensor_name<span class="token punctuation">,</span>query_dict<span class="token punctuation">,</span>cookies<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">NanjingWater</span><span class="token punctuation">(</span>Entity<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Representation of a Nanjing water """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>sensor_name<span class="token punctuation">,</span>query_dict<span class="token punctuation">,</span>cookies<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>attributes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token boolean">None</span>        self<span class="token punctuation">.</span>_query_dict <span class="token operator">=</span> query_dict        self<span class="token punctuation">.</span>_name <span class="token operator">=</span> sensor_name        self<span class="token punctuation">.</span>_cookies <span class="token operator">=</span> cookies    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the name of the sensor."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_name    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">state</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the state of the sensor."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_state    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">icon</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""è¿”å›mdiå›¾æ ‡."""</span>        <span class="token keyword">return</span> <span class="token string">'mdi:cup-water'</span>    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">device_state_attributes</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the state attributes."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>attributes    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">unit_of_measurement</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the unit this state is expressed in."""</span>        <span class="token keyword">return</span> <span class="token string">"å…ƒ"</span>    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>API_URL<span class="token punctuation">,</span>params<span class="token operator">=</span>self<span class="token punctuation">.</span>_query_dict<span class="token punctuation">,</span>headers <span class="token operator">=</span> HEADERS<span class="token punctuation">)</span>        <span class="token keyword">except</span> ReadTimeout<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Connection timeout...."</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> ConnectionError<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Connection Error...."</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> RequestException<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Unknown Error"</span><span class="token punctuation">)</span>        <span class="token comment"># res = response.content.decode('utf-8')</span>        soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">,</span><span class="token string">'html.parser'</span><span class="token punctuation">)</span>        waterFee <span class="token operator">=</span> soup<span class="token punctuation">.</span>select_one<span class="token punctuation">(</span><span class="token string">"#searchFrom &gt; div:nth-child(2) &gt; div:nth-child(1)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'ï¿¥'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        lajiFee <span class="token operator">=</span> soup<span class="token punctuation">.</span>select_one<span class="token punctuation">(</span><span class="token string">"#searchFrom &gt; div:nth-child(2) &gt; div:nth-child(2)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'ï¿¥'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        weiyueFee <span class="token operator">=</span> soup<span class="token punctuation">.</span>select_one<span class="token punctuation">(</span><span class="token string">"#searchFrom &gt; div:nth-child(2) &gt; div:nth-child(3)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'ï¿¥'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        shangqijieyuFee <span class="token operator">=</span> soup<span class="token punctuation">.</span>select_one<span class="token punctuation">(</span><span class="token string">"#searchFrom &gt; div:nth-child(2) &gt; div:nth-child(4)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'ï¿¥'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        qianfeiFee <span class="token operator">=</span> soup<span class="token punctuation">.</span>select_one<span class="token punctuation">(</span><span class="token string">"#searchFrom &gt; div:nth-child(2) &gt; div:nth-child(2)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'ï¿¥'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token comment">#_Log.info("waterFee=" + waterFee)</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> waterFee        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'lajiFee'</span><span class="token punctuation">]</span> <span class="token operator">=</span> lajiFee        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'weiyueFee'</span><span class="token punctuation">]</span> <span class="token operator">=</span> weiyueFee        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'shangqijieyuFee'</span><span class="token punctuation">]</span> <span class="token operator">=</span> shangqijieyuFee        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'qianfeiFee'</span><span class="token punctuation">]</span> <span class="token operator">=</span> qianfeiFee<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-é™„ä»¶ä¸‹è½½"><a href="#5-é™„ä»¶ä¸‹è½½" class="headerlink" title="5. é™„ä»¶ä¸‹è½½"></a>5. é™„ä»¶ä¸‹è½½</h3><p>é™„ä»¶å¯ä»¥å»è®ºå›ä¸Šä¸‹è½½ <a href="https://bbs.hassbian.com/thread-11955-1-1.html">å—äº¬æ°´è´¹æ’ä»¶</a></p>]]></content>
      
      
      <categories>
          
          <category> æ™ºèƒ½å®¶å±… </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HA </tag>
            
            <tag> python </tag>
            
            <tag> æ’ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°‘å„¿ç¼–ç¨‹ä¹‹Scratch</title>
      <link href="2020/07/06/scratch/"/>
      <url>2020/07/06/scratch/</url>
      
        <content type="html"><![CDATA[<h3 id="0-Scratchå®‰è£…ä½“éªŒ"><a href="#0-Scratchå®‰è£…ä½“éªŒ" class="headerlink" title="0.Scratchå®‰è£…ä½“éªŒ"></a>0.<strong>Scratch</strong>å®‰è£…ä½“éªŒ</h3><p>å°‘å„¿ç¼–ç¨‹è½¯ä»¶<strong>Scratch</strong>æ˜¯ç¾å›½éº»çœç†å·¥æä¾›çš„ä¸€æ¬¾è½¯ä»¶ï¼ŒScratch3.0å¯ä»¥æ›´å¥½çš„æ”¯æŒå¤–éƒ¨ç¡¬ä»¶æ¨¡å—ï¼Œå¹¶ä¸”èƒ½å¤Ÿä¸Makey,micro,We Do 2.0æœºå™¨äººï¼Œä¹é«˜ EV3æœºå™¨äººäº¤äº’ã€‚</p><h3 id="1-è½¯ä»¶ä¸‹è½½"><a href="#1-è½¯ä»¶ä¸‹è½½" class="headerlink" title="1.è½¯ä»¶ä¸‹è½½"></a>1.è½¯ä»¶ä¸‹è½½</h3><p>ä»<a href="https://scratch.mit.edu/download">Scratchå®˜ç½‘ä¸‹è½½</a>ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥å…ˆä»<a href="https://scratch.mit.edu/projects/editor/?tutorial=getStarted">è¿™ä¸ªåœ°å€</a>å¼€å§‹å°è¯•ã€‚ä¸‹è½½çš„é¡µé¢å’Œå°è¯•çš„é¡µé¢å¦‚ä¸‹ï¼š</p><p><img src="/img/scratchdownload.png" alt="scratchä¸‹è½½"></p><p><img src="/img/scratchinfo.png" alt="scratchä¿¡æ¯"></p><p>å®‰è£…åçš„ç•Œé¢å¦‚ä¸‹ï¼š</p><p><img src="/img/scratchdesktop.png" alt="scratchè½¯ä»¶ç•Œé¢"></p><p>å’Œç½‘é¡µç‰ˆçš„åŸºæœ¬æ²¡å·®ã€‚</p><h3 id="2-å¼€å§‹HelloWord"><a href="#2-å¼€å§‹HelloWord" class="headerlink" title="2.å¼€å§‹HelloWord"></a>2.å¼€å§‹HelloWord</h3><p>ç¬¬ä¸€ä¸ªå°ç©æ„ï¼š</p><p>ä»£ç ï¼š</p><p><img src="/img/helloworld.png" alt="helloworldå›¾"></p><p>æ•ˆæœï¼š</p><p><img src="/img/helloworld.gif" alt="helloworld"></p><h3 id="3-åç»­æƒ³æ³•"><a href="#3-åç»­æƒ³æ³•" class="headerlink" title="3.åç»­æƒ³æ³•"></a>3.åç»­æƒ³æ³•</h3><p>ç»“åˆç¡¬ä»¶åšä¸€äº›ä¸œè¥¿</p>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Scratch </tag>
            
            <tag> ç¼–ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ™ºèƒ½å®¶å±…ä½“éªŒä¸æ„Ÿå—</title>
      <link href="2020/06/17/smartHome/"/>
      <url>2020/06/17/smartHome/</url>
      
        <content type="html"><![CDATA[<h2 id="0-å…¥å‘åŸå› ï¼š"><a href="#0-å…¥å‘åŸå› ï¼š" class="headerlink" title="0.å…¥å‘åŸå› ï¼š"></a>0.å…¥å‘åŸå› ï¼š</h2><p>â€‹        å®¶é‡Œè£…ä¿®å®Œäº†ï¼Œç„¶åæƒ³è‡ªå·±æç‚¹ä¸ä¸€æ ·çš„ä¸œè¥¿ï¼Œèƒ½å¤Ÿè®©è‡ªå·±å·å·æ‡’ï¼Œè¿˜èƒ½å¤Ÿæ–¹ä¾¿å®¶é‡Œäººä½¿ç”¨ã€‚ä¸€å¼€å§‹å•¥ä¹Ÿä¸çŸ¥é“ï¼Œä¹Ÿä¸çŸ¥é“é€‰æ‹©å•¥ã€‚ä¹Ÿæ²¡æœ‰æƒ³åˆ°è‡ªå·±çš„åšï¼Œæƒ³ç€ç”¨æˆç†Ÿçš„ä¸œè¥¿æ­å»ºè‡ªå·±çš„æ™ºèƒ½å®¶å±…ã€‚æ­£å¥½å®¶é™„è¿‘æœ‰ä¸ªå°ç±³ä¹‹å®¶ï¼Œå»çœ‹äº†çœ‹ã€‚ç„¶åå°±å…¥æ‰‹äº†<a href="https://www.mi.com/buy/detail?product_id=5708&amp;cfrom=search">ç±³å®¶æ™ºèƒ½å¥—è£…</a>ï¼Œæ˜¯æœ€æ—©ä¸€æ‰¹çš„æ™ºèƒ½çš„ä¸œè¥¿ã€‚<img src="/img/mihome.jpg" alt="ç±³å®¶æ™ºèƒ½å¥—è£…"></p><p>ä»è¿™å¼€å§‹ä¾¿å¼€å§‹äº†æ™ºèƒ½å®¶å±…ä¹‹æ—…ã€‚ç´§æ¥ç€åˆå…¥æ‰‹äº†å¾ˆå¤šçš„æ™ºèƒ½è®¾å¤‡å’Œæ™ºèƒ½å¼€å…³ã€‚ç°åœ¨çš„è®¾å¤‡å·²ç»è¾¾åˆ°80ä¸ªä¹‹å¤šã€‚</p><h2 id="1-ç±³å®¶APPä½“éªŒ"><a href="#1-ç±³å®¶APPä½“éªŒ" class="headerlink" title="1.ç±³å®¶APPä½“éªŒ"></a>1.ç±³å®¶APPä½“éªŒ</h2><p>â€‹      æœ‰äº†è¿™äº›æ™ºèƒ½è®¾å¤‡ä¹‹åï¼Œå¦‚æœè¦è®©å®ƒä»¬èƒ½å¤Ÿè”åˆèµ·æ¥åšä¸€äº›äº‹æƒ…ï¼Œä½ å¾—è‡ªå·±ç¼–å†™ä¸€ä¸ªæ™ºèƒ½ï¼Œæ¡ä»¶å¯ä»¥æ˜¯ä½ ç°åœ¨çš„ä¼ æ„Ÿå™¨æˆ–è€…ä»–è‡ªå·±æä¾›çš„ä¸€äº›ä¸œè¥¿ï¼Œæ“ä½œçš„è®¾å¤‡åªèƒ½æ˜¯ä½ çš„æ™ºèƒ½è®¾å¤‡æˆ–è€…ä½ çš„æ‰‹æœºäº†ï¼Œç±³å®¶AppåŸºæœ¬ä¸Šèƒ½å¤Ÿæ»¡è¶³å¤§éƒ¨åˆ†äººçš„éœ€æ±‚äº†ï¼Œä½†æ˜¯æœ‰äº›åƒè®¾ç½®æ›´ç»†èŠ‚çš„ä¸œè¥¿ï¼Œä»–å°±çˆ±è«èƒ½åŠ©äº†ã€‚</p><h2 id="2-å…¥å‘HomeAssistant"><a href="#2-å…¥å‘HomeAssistant" class="headerlink" title="2.å…¥å‘HomeAssistant"></a>2.å…¥å‘HomeAssistant</h2><p>â€‹     æœ‰äº†è¿™äº›ç¡¬ä»¶è®¾å¤‡ï¼Œä½†æ˜¯åˆä¸ç”˜äºè¢«ç±³å®¶AppæŸç¼šï¼Œæ‰€ä»¥å°±å¼€å§‹æ‰¾æœ‰æ²¡æœ‰åˆ«çš„å•¥èƒ½å¤Ÿæ”¯æŒè¿™äº›æ™ºèƒ½ç¡¬ä»¶ï¼Œæ‰¾ç€æ‰¾ç€æ‰¾åˆ°HAï¼Œè¿™ä¸ªä¸œè¥¿è¿˜æ˜¯å¾ˆå¼ºå¤§çš„ã€‚å¯ä»¥è‡ªå·±ç¼–å†™ä¼ æ„Ÿå™¨ï¼Œå¯å®šåˆ¶åŒ–ç¨‹åº¦éå¸¸é«˜ï¼Œèƒ½å¤Ÿå®Œæˆå¾ˆå¤šç±³å®¶Appä¸èƒ½å®Œæˆçš„äº‹æƒ…ã€‚å¯ä»¥å»<a href="https://bbs.hassbian.com/">ç€šæ€å½¼å²¸</a> è®ºå›å­¦ä¹ å„ä¸ªç¥çš„æ“ä½œã€‚</p><h2 id="3-å¦‚ä»Šçš„æ™ºèƒ½è®¾å¤‡"><a href="#3-å¦‚ä»Šçš„æ™ºèƒ½è®¾å¤‡" class="headerlink" title="3.å¦‚ä»Šçš„æ™ºèƒ½è®¾å¤‡"></a>3.å¦‚ä»Šçš„æ™ºèƒ½è®¾å¤‡</h2><p>â€‹     ç°åœ¨å®¶é‡Œçš„æ™ºèƒ½è®¾å¤‡å·²ç»80å¤šä¸ªäº†ï¼Œå¾ˆå¤šå·²ç»æ¥å…¥äº†HAï¼Œä½†æ˜¯è¿˜æœ‰å°‘æ•°è®¾å¤‡æ²¡æœ‰æ¥å…¥å…¶ä¸­ã€‚åé¢é™†é™†ç»­ç»­çš„æ¥å…¥åˆ°å½“ä¸­å»ã€‚å› ä¸ºä¸€å¼€å§‹æ²¡æœ‰ä¹°å°ç±³å…¨å®¶æ¡¶ï¼Œæ‰€ä»¥å¾ˆå¤šçš„éƒ½æ˜¯ä½¿ç”¨æ™ºèƒ½å¼€å…³æ¥æ§åˆ¶è®¾å¤‡çš„ï¼Œæ‰€ä»¥å®¶ä¸­çš„æ™ºèƒ½æ’åº§å’Œæ™ºèƒ½å¼€å…³æ¯”è¾ƒå¤šã€‚</p><h2 id="4-åè¯"><a href="#4-åè¯" class="headerlink" title="4. åè¯"></a>4. åè¯</h2><p>â€‹     æ™ºèƒ½å®¶å±…è¿˜æ˜¯è¦ä»å¼€å§‹è¿›è¡Œè§„åˆ’ï¼Œç­‰è‡ªå·±ä»¥åæœ‰èƒ½åŠ›åœ¨ä¹°ä¸€å¥—çš„æ—¶å€™ï¼Œä¸€å®šè¦å½»å¤´å½»å°¾çš„æä¸€æ¬¡çœŸæ­£çš„æ™ºèƒ½å®¶å±…</p>]]></content>
      
      
      <categories>
          
          <category> æ™ºèƒ½å®¶å±… </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ™ºèƒ½å®¶å±… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexoåšå®¢æ­å»º</title>
      <link href="2020/06/08/startPage/"/>
      <url>2020/06/08/startPage/</url>
      
        <content type="html"><![CDATA[<h2 id="æ­å»ºHexo"><a href="#æ­å»ºHexo" class="headerlink" title="æ­å»ºHexo"></a>æ­å»ºHexo</h2><p>ä¹‹å‰è‡ªå·±æ­å»º<a href="http://freefitter.com:1200/">wordpress</a>çš„åšå®¢ï¼Œç½‘ä¸Šæœç´¢ä¸‹ï¼Œè¿˜æœ‰äººæ¨èHexoçš„ï¼Œç„¶åå°±å°è¯•ç€è‡ªå·±æäº†ä¸ªç©ç©ï¼Œå‘ç°å¹¶ä¸å¤æ‚<br>å‚ç…§äº†<a href="https://www.jianshu.com/p/4818be9093f5">è¿™ä¸ªæ•™ç¨‹</a>è¿˜æœ‰<a href="https://hexo.fluid-dev.com/docs/">å®˜æ–¹çš„æ–‡æ¡£</a>ã€‚ä¸‰ä¸‹äº”é™¤äºŒå¹²äº†èµ·æ¥ã€‚</p><h2 id="å±•ç¤º"><a href="#å±•ç¤º" class="headerlink" title="å±•ç¤º"></a>å±•ç¤º</h2><p>   æ­å»ºå®Œæˆå°±æ˜¯è¿™æ ·å•¦! <img src="/img/pre.png" alt="æˆæœå±•ç¤º"> èµ¶è„šè¿˜è¡Œã€‚</p><h2 id="è¯´åœ¨æœ€å"><a href="#è¯´åœ¨æœ€å" class="headerlink" title="è¯´åœ¨æœ€å"></a>è¯´åœ¨æœ€å</h2><p>   è‡ªå·±çæŠ˜è…¾ï¼Œæ²¡äº‹æ•´ç‚¹äº‹</p>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
