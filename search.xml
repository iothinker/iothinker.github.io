<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>IOT智能看板</title>
      <link href="iotdashboard.html"/>
      <url>iotdashboard.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>最近折腾了一下<code>Node-RED</code>和小程序，虽然之前已经折腾过了，之前群晖不是挂了嘛，也懒得启动了，所以准备在现在的树莓派上折腾折腾。</p></blockquote><h3 id="0-概述"><a href="#0-概述" class="headerlink" title="0.概述"></a>0.概述</h3><hr><p>在树莓派上已经安装了<code>MQTT</code> ，因为这次想在小程序上能够展示一些信息，但是买的域名没有备案，检查就过不了。正好某天在逛论坛的时候看到了<a href="https://cloud.bemfa.com/">巴法云</a>，而且现在人家还免费，这不正中我的下怀嘛，这不就整起来了。<br><img src="/img/20211117/e4e98ffa309ba3d313bfc2d42d3b04f6.jpg" alt="巴法云截图"></p><h3 id="1-实战"><a href="#1-实战" class="headerlink" title="1.实战"></a>1.实战</h3><hr><p>首先得在树莓派上安装好<strong>MQTT</strong>和<strong>Node-RED</strong>，安装<strong>Node-RED</strong>的教程咱就不贴了。<a href="https://nodered.org/">官网在这</a>，<a href="https://github.com/node-red/node-red">GitHub地址在这</a>，研究一下这两个就差不多了。下面这个是我做好的流，主要是通知和推数据到巴法云。微信通知的可以参看我之前的<a href="http://wangxingyang.com/wecomchan.html">Server酱推送</a>，这个用的企业微信的接口，后续准备自己搞一个，让推送消息的内容更加的丰富。在<strong>Node-RED</strong>里还弄了一个<strong>小爱音箱TTS</strong>的功能，可以远在外面通知家里了，后续可以拍个短视频看看效果。<br> <img src="/img/20211117/97f283cd730f5ed9a2cf94c46e08795b.jpg" alt="Node-RED截图"><br>这些准备工作做好了，就开始搭小程序了。写小程序比较简单，主要是UI设计，这边参照之前<strong>Scriptable</strong>里面的那个小组件，做了一个差不多的。下面这个是界面，现在有点简陋，后续慢慢添加和优化吧。小程序现已经上线了，小程序名称为<strong>IOT智能看板</strong>。大家可以搜索查看。因为现在没有加控制，大家都可以操作，但是最好不要用音箱播放哈，会吓人的。现在数据是1分钟执行一次推送，所以没看到数据的话，稍微等待⌛️下就好。<br><img src="/img/20211117/8b862769e444d8e5b0a897d1cc40d436.jpg" alt="小程序截图V1"></p><h4 id="20211119-更新"><a href="#20211119-更新" class="headerlink" title="20211119 更新"></a>20211119 更新</h4><hr><p>把小程序界面优化了下，显示信息加入了路由器的基本信息和油价的监控，控制方面，加入了M5Stack中RGB灯的控制：</p><p><img src="/img/20211117/2151637335711_pic.jpg" alt="小程序截图V2"></p><p>下面是录的操作视频</p><p><video src="/img/20211117/1637336039111419.mp4" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><h3 id="2-总结"><a href="#2-总结" class="headerlink" title="2.总结"></a>2.总结</h3><hr><p>后续准备和<strong>M5Stack</strong>结合在一起，双11买了些传感器，后续准备搞起来用小程序控制。上个周末给老妈研究自动刷抖音的，用的彤宝的乐高，可能因为乐高搭的比较松散，不够硬导致没成功，后面继续研究，等研究好给大家展示下子。年轻的时候有想法但是经济实力不够，现在是有想法，但是时间不够，不过不着急，慢慢把想法变成现实，让自己不断的提升吧。</p>]]></content>
      
      
      <categories>
          
          <category> 物联网 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mqtt </tag>
            
            <tag> Node-Red </tag>
            
            <tag> 小程序 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周末分享</title>
      <link href="dayshare211108.html"/>
      <url>dayshare211108.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>这周还是带着宝宝上早教，周日的晚上还有培训机构给她们准备的生日🎂晚会，下面就和我一起来看看吧。</p></blockquote><h3 id="0-上课"><a href="#0-上课" class="headerlink" title="0.上课"></a>0.上课</h3><hr><p>早上起床，洗漱完毕就去上课了，今天的亲子课是看影子找到相应的水果，还有就是扣环。大运动环节是让他们分类数字。</p><p>找影子环节呢，除了中间的西瓜没有自己找到，其他的都是她自己完成的。基本上这些水果也都认识了。</p><p><img src="/img/20211108/5c4c2f119bcfb102bb6f469637fb246f.jpg" alt="找影子"></p><p><img src="/img/20211108/84ba1d2224f3a527f6128e0e7338e72e.jpg" alt="找影子"></p><p>一开始扣和解的时候有些不能控制，但是后面慢慢的就好些了。</p><p><img src="/img/20211108/eefa5df120511c6b458b7719ed06aa1a.jpg" alt="连环扣"></p><p><img src="/img/20211108/964df8a45aa3d943a17f05e2a9a40239.jpg" alt="连环扣"></p><p>现在玩玩具她都只玩一次，自己完成了就要去换下一个玩具了。其他小孩都还沉浸在玩玩具的氛围中，她都结束了🤦‍♂️。</p><p><img src="/img/20211108/85240e3f43eb941d3ee9f2166498697e.jpg" alt="数字分类"></p><p><img src="/img/20211108/7bfae4f73c58c72db0bc5f76930738b9.jpg" alt="数字分类"></p><p>数字分类她已经可以自己独立完成了，走独木桥的时候还是有点害怕，扶着她就好了。这次的1，3，5这几个数字她都已经掌握了，能够快速准确的放到对应的篮子🧺里，很棒！</p><p>下午上的是感统课，这次的感统课有点儿乱，不像之前一个环节一个环节串起来的，是分成每个小的部分，每个小朋友可以挑一个没人的项目开始，这样导致彤彤很快就放飞自我了，玩一会这个玩一会那个然后就完全自己玩了。不过最后老师还是带她完成了几个小项目的。</p><p><img src="/img/20211108/4aff0c7bba791dbc4403c0944639bd6c.jpg" alt="用小腿抬球"></p><p><img src="/img/20211108/0b104590521b42ffc61c723824d37ee3.jpg" alt="我踢"></p><p><img src="/img/20211108/8d136979841757962ff688a163d49781.jpg" alt="我再踢"></p><p><img src="/img/20211108/b29f7e31160fd04c5e51cc5b9446f0be.jpg" alt="单手推球过障碍"></p><p><img src="/img/20211108/ce8b0e41fbad4d8ef3d0e4508bfb48ce.jpg" alt="高抬腿"></p><p><img src="/img/20211108/cf96f99a6378c102bf1b2851af3d9fb1.jpg" alt="小可爱"></p><h3 id="1-生日会"><a href="#1-生日会" class="headerlink" title="1.生日会"></a>1.生日会</h3><hr><p>彤彤很快就要过生日了，早教机构那边给她们准备了生日晚会，那天晚上正好碰上降温，真的是贼冷。晚会主要是几个小游戏和还有小朋友吃吃吃两个环节，彤宝还是很开心的，下面让大家一起开心一下吧。</p><p><img src="/img/20211108/539889e8af46b60eeb138ba755a605c9.jpg" alt="彤宝举手"></p><p><img src="/img/20211108/0ea2fb370b9e745910e41262cf6c6776.jpg" alt="游戏前准备"></p><p><img src="/img/20211108/882d7212559f653f15d2ee54d212cd77.jpg" alt="游戏后领奖"></p><p><img src="/img/20211108/764d5b007c87f5e8c16142e012176690.jpg" alt="大合照"></p><p><img src="/img/20211108/daf539d8836205778b8a315f6a3beaf1.jpg" alt="吃吃吃"></p><h3 id="2-写在最后"><a href="#2-写在最后" class="headerlink" title="2.写在最后"></a>2.写在最后</h3><hr><p>孩子每天都不一样，所以很珍惜和她的每一天，也不愿错过她成长的每个时刻。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 早教 </tag>
            
            <tag> 生日会 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>M5Stack入坑记录</title>
      <link href="m5stack.html"/>
      <url>m5stack.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>看了很多的模块和套件，最后还是选择了M5Stack。Core2 for AWS是AWS物联网学习项目的专属套件。它由M5Stack Core2核心主控和M5GO-Bottom For AWS拓展底座组成,并且额外定制集成了ATECC608 Trust&amp;GO 硬件加密,是物联网学习和安全项目构建的理想套件。</p></blockquote><h3 id="0-📖简介"><a href="#0-📖简介" class="headerlink" title="0.📖简介"></a>0.📖简介</h3><hr><p>详细的参数和说明在<a href="https://docs.m5stack.com/zh_CN/core/core2_for_aws">这里</a>，实物还是很好看的。首先想用它来显示一下相关信息。前不久在树莓派上装了个<code>Pi-hole</code>，结果树莓派跪了，进不去系统了，没得办法只能重新刷了系统。<br>在上面装了<code>MQTT</code> ，这边有<a href="https://zhuanlan.zhihu.com/p/359395794">教程</a>，大家可以参照安装，之前一直没有尝试，就这次就来尝试一下。<br>下面是拆箱图，忽略已经脏了的沙发：<br><img src="/img/20211102/00316b36d7829086159f361c2610123b.jpg" alt="拆箱图"><br><img src="/img/20211102/9c5060bc803e07a19fbfaa00c064131e.jpg" alt="拆箱图"><br><img src="/img/20211102/43f31b91e47f2e6add34a879ab4260bb.jpg" alt="拆箱图"></p><h3 id="1-💡想法"><a href="#1-💡想法" class="headerlink" title="1.💡想法"></a>1.💡想法</h3><hr><p>准备在这上面来展示一下信息：</p><ol><li>树莓派的运行状态</li><li>家里的水电燃气费用的显示</li><li>天气的显示</li><li>设备的一些信息</li><li>博客访问统计</li><li>生日倒计时</li></ol><p>控制方面：</p><ol><li>控制旁边的RGB灯</li><li>控制设备震动</li><li>控制设备发声</li><li>家中常用设备的控制</li></ol><h3 id="2-🏃实践"><a href="#2-🏃实践" class="headerlink" title="2.🏃实践"></a>2.🏃实践</h3><hr><p>信息展示方面，准备把之前的接口改造一下，加上<code>mqtt</code>推送，这样就能够使用订阅来获取相关数据了。记得安装<code>mqtt</code>的包 <strong>pip install paho-mqtt</strong>；例程网上都有，可以参照着改一下。代码就不贴了，不是很复杂。<br>接下来就是下载相关的软件给M5烧录系统了，这边没有用<code>Arduino</code>，用官方提供的<strong>M5Burner</strong>来烧系统，用<strong>UIFlow</strong>来进行编程。这个比较适合新上手，不够开放，但是方便快捷，后面可以试试用<code>Arduino</code>来写。<br><img src="/img/20211102/054730216c001a75771f82577aca9d5b.jpg" alt="UIFlow"><br>右边的UI所见即所得，但是到真机上还是有些许的误差，还是需要自己调整的。之前下载的离线版的IDE，发现版本比较低，恨到模块都没有。所以最后还是转战到在线编辑。在线编辑比较好，不用接线，有网络就行。教程在<a href="https://docs.m5stack.com/en/quick_start/core2_for_aws/uiflow">官网</a>都有。<br>准备就绪后就是开始拖拽编码了，说实话，拖拽编码还不如手打来的方便。经过几个晚上的奋战，终于搞好了一大部分，还有写空间不知道怎么利用，等有弄结束了再最后的成果图。<br>下图是拖拽的部分截图。<br><img src="/img/20211102/e54432962766f644b5e29e2a90412d8c.jpg" alt="UIFlow代码图"><br>最后做好的界面是这样的：<br><img src="/img/20211102/5acc8ab8370952ed7d1b6d9fc047fb4b.jpg" alt="最终成果图"><br>看起来还是不错的，后面准备在接一些传感器啥的一起玩玩。</p><p>录了个控制RGB灯的视频，灯是会呼吸的哦，感受一下哈。</p><p><video src="/img/20211102/1636385089845653.mp4" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><h3 id="3-🔚总结："><a href="#3-🔚总结：" class="headerlink" title="3.🔚总结："></a>3.🔚总结：</h3><hr><p>整体来说这个东西还是很适合我这种没有太多硬件基础的的人玩的，现在研究的都是里面集成好的函数，后续看看能不能通过<code>Arduino</code>来自己去调它的硬件，或者不购买它的周边，自己驱动其他的外设。很多东西都是需要实战的，想做就去做，你会有成果出来的，后面。我喜欢捣鼓这些，之前的<code>Pi-hole</code>没用爽，后续准备再折腾折腾，也推荐大家去玩玩这个。<a href="https://github.com/pi-hole/pi-hole">GitHub</a>链接，下面是它的简介：</p><blockquote><p>The Pi-hole® is a <a href="https://en.wikipedia.org/wiki/DNS_Sinkhole">DNS sinkhole</a> that protects your devices from unwanted content without installing any client-side software.</p></blockquote><ul><li><strong>Easy-to-install</strong>: our versatile installer walks you through the process and takes less than ten minutes</li><li><strong>Resolute</strong>: content is blocked in <em>non-browser locations</em>, such as ad-laden mobile apps and smart TVs</li><li><strong>Responsive</strong>: seamlessly speeds up the feel of everyday browsing by caching DNS queries</li><li><strong>Lightweight</strong>: runs smoothly with <a href="https://docs.pi-hole.net/main/prerequisites/">minimal hardware and software requirements</a></li><li><strong>Robust</strong>: a command line interface that is quality assured for interoperability</li><li><strong>Insightful</strong>: a beautiful responsive Web Interface dashboard to view and control your Pi-hole</li><li><strong>Versatile</strong>: can optionally function as a <a href="https://discourse.pi-hole.net/t/how-do-i-use-pi-holes-built-in-dhcp-server-and-why-would-i-want-to/3026">DHCP server</a>, ensuring <em>all</em> your devices are protected automatically</li><li><strong>Scalable</strong>: <a href="https://pi-hole.net/2017/05/24/how-much-traffic-can-pi-hole-handle/">capable of handling hundreds of millions of queries</a> when installed on server-grade hardware</li><li><strong>Modern</strong>: blocks ads over both IPv4 and IPv6</li><li><strong>Free</strong>: open source software that helps ensure <em>you</em> are the sole person in control of your privacy</li></ul><p>如果家里本身就有树莓派，建议用起来，免得吃灰。现在我的树莓派还是有用的。群晖现在只有上传照片的时候开开机了。</p>]]></content>
      
      
      <categories>
          
          <category> M5Stack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> M5Stack </tag>
            
            <tag> MQTT </tag>
            
            <tag> Pi-hole </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周末分享</title>
      <link href="dayshare211024.html"/>
      <url>dayshare211024.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>又是周末了，又是一个遛娃的周末，也一定是一个丰富多彩的周末。这个周末周六是早教课和给福宝宝过生日，周日约了一起去红山动物园玩。下面就和我一起来回顾一下精彩的周末吧。</p></blockquote><hr><blockquote><p><strong>小插曲:</strong><br>周五晚上想带她出去买个鞋子的，出去的时候比较晚，所以回来的时候也有点晚了。去的时候答应她买蛋糕的，最后回来的时候她有些困了，我就和她说，如果在车上睡着的话，回家就没有蛋糕🍰吃咯。没想到她居然坚持到家🏠都没有睡觉，回家了还兴奋的说，<code>吃蛋糕咯</code> ，当时看她兴奋的样子真的很好玩。</p></blockquote><hr><h3 id="0-早教-amp-生日"><a href="#0-早教-amp-生日" class="headerlink" title="0.早教 &amp; 生日"></a>0.早教 &amp; 生日</h3><hr><p>早上起来，准备不带彤彤去上上午的亲子课的，因为上次的体验不是很棒。但是早上她妈妈问了她一句要不要去上课，她肯定的回答要去上课，那时候已经八点多了，急急忙忙的弄弄就去上课了。这次上课的人还是很多的，玩了一个上次的小熊穿衣和拉拉链，最后的大运动是运送星星到指定的地方。彤彤都完成了，下面看看过程吧。<br><img src="/img/20211024/f6a687a978b9153ee69c5c6c67161da0.jpg" alt="小熊穿衣"><br><img src="img/20211024/8f86ac8e508416109979ddbb34c60004.jpg" alt="小熊穿衣"><br><img src="img/20211024/f19b7ad982dabe91bd82d57d05dd5993.jpg" alt="节奏棒"><br><img src="img/20211024/e63e1ed376dd1071f76daedb55453276.jpg" alt="大运动环节"><br>中午睡了一个午觉，下午就早点去了，下午的课他就表现的非常的活泼，这次是坐在老师的腿上自己做自我介绍的。当时老师叫了一个小男孩去做自我介绍，可能小男孩比较害羞，我就问了她一下，要不要举手去做自我介绍，没想到她居然答应了，并且流利的完成了自我介绍。有机会下次拍个自我介绍的视频。这次的课程，爬高爬低的时候还是有点害怕的，我常说她比较惜命，哈哈。还有就是第一关爬行的时候，需要屁股放低，但是她总是抬的高高的，其他的完成的都是比较好的。下面也来看看她的精彩过程吧。<br><img src="img/20211024/bb901ef053971b862780ea7f97b324fa.jpg" alt="这个姿势很OK"><br><img src="img/20211024/2c111b30f3d5eb93e95825888ad595e5.jpg" alt="跑起来"><br><img src="img/20211024/96e9a03e089c19c89e9b2cf542702e65.jpg" alt="第一关"><br><img src="img/20211024/f7a3e0260d15819ea45122249951ae21.jpg" alt="第二关"><br><img src="img/20211024/001ec2acbd3776b84d10a5940d81b263.jpg" alt="第二关"><br><img src="img/20211024/ab33ea897f3a16fd3f45856f6cdc09ac.jpg" alt="爬A字架"></p><p><img src="img/20211024/e1357166058fd8ea48930faeb57ad838.jpg" alt="大象爬"></p><p><img src="img/20211024/e7b6643219144a1e7429fa214b250b59.jpg" alt="平衡踏板"><br>晚上是福宝宝的生日🎂，约了一起吃个晚饭。给福宝宝买了玩具，小家伙也找我要了一个，福宝宝带了生日帽，她也有。她妈妈说感觉好像她自己过生日一样。晚上的彤宝吃的还是很多的，回家都没有要喝奶。放一张他们的合照。<br><img src="img/20211024/9f917b00a658e5e1bc08a4288d1d8300.jpg" alt="两个小寿星"></p><h3 id="1-动物园"><a href="#1-动物园" class="headerlink" title="1.动物园"></a>1.动物园</h3><hr><p>去动物园还是坐地铁去，开车过去真的不是很方便，而且巨堵，所以还是公共交通比较香。来一张地铁的的合照吧。<br><img src="img/20211024/f2bce45fa15988645bf784b2cad2bcfb.jpg" alt="合照"><br>动物园已经去了好几次了，感觉都是为了年卡去的，不去多去几次感觉亏了😂。里面就是看看动物啦，没啥特别的事情，最后结束的时候要来个游客照哈。<br><img src="img/20211024/4b69f555fd024b5f85c2e07ee7c6fa72.jpg" alt="游客照"></p><h3 id="2-总结"><a href="#2-总结" class="headerlink" title="2.总结"></a>2.总结</h3><hr><p>和宝宝在一起，每天都是新鲜的，哈哈，总会给你想不到的快乐。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 早教 </tag>
            
            <tag> 遛娃 </tag>
            
            <tag> 动物园 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>免费的梯子</title>
      <link href="toolshare211019.html"/>
      <url>toolshare211019.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>程序员都有需要<code>梯子</code>的时候，所以这次就出一个自己现在用的<code>梯子</code>，可以留着备用。</p></blockquote><h3 id="0-历程"><a href="#0-历程" class="headerlink" title="0.历程"></a>0.历程</h3><hr><p>在此之前用的是<code>小手电</code> [现在应该也还可以用的]。这个工具就是有时候呢不是很稳定，有时候死活连不上，服务器你还不能选，后面继续逛<code>Github</code>的时候，发现了现在的这个<a href="https://github.com/freefq/free">freefq</a>，页面上有简介和使用方式，就不啰嗦了。下面是<code>Github</code>的截图。可以看到<code>Star</code>还是很多的。</p><p><img src="/img/20211019/freefq.png" alt="Github截图"></p><h3 id="1-优化"><a href="#1-优化" class="headerlink" title="1.优化"></a>1.优化</h3><hr><p>上面有各个平台使用的工具，如果是<code>Windows</code>的话，他推荐的软件就不错。但是Mac的话，那个软件使用起来就不是很友好，不能订阅，服务器得自己一个一个加。后面找找发现了现在用的这个<a href="https://github.com/yanue/v2rayu">V2rayU</a>，这个使用起来就比较的友好了，怎么用大家上手就知道了。可以看到<code>Star</code>数也不少啊。</p><p><img src="/img/20211019/v2rayu.png" alt="Github截图"></p><p>但是有个问题是，换了这个工具后，<code>Chrome</code>居然不能访问墙外的，这就很蛋疼，因为用<code>Chrome</code>用习惯了，后面发现<code>Safari</code>是可以。网上查了很久，最后是通过<a href="https://github.com/FelisCatus/SwitchyOmega">SwitchyOmega</a>这个插件来解决的，曲线救国，先<code>Safari</code>下载这个插件，然后再装到<code>Chrome</code>上，最后终于可以愉快的上网了。可以看到<code>Star</code>数也不在少数，可能有同样问题的人也不少吧。</p><p><img src="/img/20211019/so.png" alt="Github截图"></p><h3 id="2-结语"><a href="#2-结语" class="headerlink" title="2.结语"></a>2.结语</h3><hr><p>工具这种东西，还是看个人的，如果大家有更好更方便的工具欢迎交流。</p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 梯子 </tag>
            
            <tag> vpn </tag>
            
            <tag> 免费 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo微信分享链接添加缩略图</title>
      <link href="toolshare211018.html"/>
      <url>toolshare211018.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>hexo搭建的静态站，分享时光秃秃的一片，想给它加个图片，所以就有了现在的文章</p></blockquote><h3 id="0-前期准备"><a href="#0-前期准备" class="headerlink" title="0.前期准备"></a>0.前期准备</h3><hr><p>在网上找了找，看看有没有现成的，网上大部分是讲接入SDK的，这个太麻烦了，还得绑定域名啥的。最后找到一个很方便的方法，亲测有效，这是<a href="https://blog.zhheo.com/p/89870d07.html">原文链接</a>，很简单的两句话。下面简要说下步骤：</p><ol><li><p>准备一张<code>300*300</code>的图片作为缩略图。</p></li><li><p>在head头部添加一个div，包含img标签。</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token style language-css"><span class="token property">display</span><span class="token punctuation">:</span>none<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/img/wechat.png<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>og:image<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://*.***.***/*.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ol><p>到此就大功告成了。但是我想做成一个插件的形式，这个只能够指定一张图片，图片也不能变，所以接下来就开始改造了。</p><h3 id="1-实操"><a href="#1-实操" class="headerlink" title="1.实操"></a>1.实操</h3><hr><p>在<code>themes/hexo-theme-matery/_config.yml</code>中添加开关</p><pre class="line-numbers language-yml" data-language="yml"><code class="language-yml"># 分享图标设置shareIcon:  enable: true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>接着修改<code>themes/hexo-theme-matery/layout/_partial/head.ejs</code> </p><pre class="line-numbers language-ejs" data-language="ejs"><code class="language-ejs"> <span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%</span><span class="token language-javascript">         <span class="token keyword">var</span> shareIconPath <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>theme<span class="token punctuation">.</span>shareIcon <span class="token operator">&amp;&amp;</span> theme<span class="token punctuation">.</span>shareIcon<span class="token punctuation">.</span>enable<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>page<span class="token punctuation">.</span>shareIcon<span class="token punctuation">)</span> <span class="token punctuation">{</span>                shareIconPath <span class="token operator">=</span> <span class="token string">"https://www.wangxingyang.com"</span> <span class="token operator">+</span> page<span class="token punctuation">.</span>shareIcon<span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                 shareIconPath <span class="token operator">=</span> <span class="token string">"https://www.wangxingyang.com/share.png"</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> </span><span class="token delimiter punctuation">%&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token style language-css"><span class="token property">display</span><span class="token punctuation">:</span>none<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%=</span><span class="token language-javascript"> shareIconPath </span><span class="token delimiter punctuation">%&gt;</span></span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>og:image<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token ejs language-ejs"><span class="token delimiter punctuation">&lt;%=</span><span class="token language-javascript"> shareIconPath </span><span class="token delimiter punctuation">%&gt;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>如果开关打开，并且配置了链接图片地址，那么就用配置的，否则用默认的图片地址。</p><p>使用的时候需要在md文件中加入<code>shareIcon</code></p><p><img src="/img/20211018/2.jpeg" alt="使用截图"></p><h3 id="2-成果展示"><a href="#2-成果展示" class="headerlink" title="2.成果展示"></a>2.成果展示</h3><hr><p><img src="/img/20211018/0.jpeg" alt="成果展示"></p><p>看起来还是不错的，默认是彤宝的照片哈。</p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> 页面分享 </tag>
            
            <tag> 缩略图 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周末分享</title>
      <link href="dayshare211016.html"/>
      <url>dayshare211016.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>今天上了一天的课，上午是亲子课，下午是感统课。很是充实，虽然低温加下雨☔️，还是没有挡住求学的心</p></blockquote><h3 id="0-上午的亲子课"><a href="#0-上午的亲子课" class="headerlink" title="0.上午的亲子课"></a>0.上午的亲子课</h3><hr><p>之前上课的老师换了，今天的老师又换了。导致彤宝一点都提不起兴趣，不过彤彤还是很认真的听的，事后问她喜不喜欢今天的老师，彤宝说不喜欢。一直换老师真的不好，后面问了其他的老师，说老师可能还会变。所以后面的想法是，如果老师再变的话，后面亲子课就不想上了，等她两岁的时候换别的课了。</p><h3 id="1-下午的感统课"><a href="#1-下午的感统课" class="headerlink" title="1.下午的感统课"></a>1.下午的感统课</h3><hr><p>下午的感统课，彤彤表现的非常好，很活跃也很开心，现在任教的肖恩老师也很棒。感统课的课程安排大致是这样的，首先是自我介绍环节，因为老师已经很熟悉了，所以能够很好的做自我介绍。接着是一首音乐🎵 <strong>one little finger</strong> 并配合相应的动作。彤彤的反应虽然慢半拍，但是大部分还是能跟着老师一起做的。腾讯视频的<a href="https://v.qq.com/x/cover/2bvisw6nog7xwuf/d085999a4yx.html">One Little Finger 一只小手指</a>链接，大家可以看看。接着的环节就是组合运动环节了。第一个是手印脚印，按照摆拍的脚印👣和👋手印来完成动作，用小脚踩在脚印上，小手按住手印。接着是扶走空梯，让宝宝扶着走过横着放置的梯子。接下来是跳捡圈圈，跳进圈圈里，然后把圈圈提起来，这样重复操作。最后一个是钻到大斜坡下面，按照老师的指令拿指定颜色的沙包。这些彤彤都完成的很棒。事后问她开心吗，她说开心。</p><p>照片没怎么拍，就不贴了，下次记录吧。</p><h3 id="2-晚上的活动"><a href="#2-晚上的活动" class="headerlink" title="2.晚上的活动"></a>2.晚上的活动</h3><hr><p>晚上出去吃了个晚饭，带彤彤去理了发，之前就在那边理的，开业的时候团了一张劵才15元，发现在那边理发，她很乖，不哭也不闹，就是价格有点贵，一次88元。今天去依然很乖，还洗了头。最后没忍住还是给她办了张卡😂，希望不要像成人理发一样，理理后面就跑路了。下面放一些图和视频吧。</p><p>遛小鳄鱼，哈哈</p><p><video src="/img/20211016/11.mp4" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><p>晚上理发</p><p><img src="/img/20211016/1.jpg" alt="理发中"></p><p><img src="/img/20211016/2.jpg" alt="理发中"></p><p><img src="/img/20211016/3.jpg" alt="理发中"></p><p><img src="/img/20211016/4.jpg" alt="洗头中"></p><h3 id="3-最后说点什么"><a href="#3-最后说点什么" class="headerlink" title="3.最后说点什么"></a>3.最后说点什么</h3><hr><p>总的来说，彤彤表现还是很棒的，不论是上课还是出去玩，都很乖很听话。希望她快乐成长，这就是最幸福的事情了。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 早教 </tag>
            
            <tag> 遛娃 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小插件分享</title>
      <link href="toolshare211011.html"/>
      <url>toolshare211011.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>最近逛逛博客，看到个好玩的东西，已经加到博客中了，欢迎大家观看和使用</p></blockquote><h3 id="0-小地球"><a href="#0-小地球" class="headerlink" title="0.小地球"></a>0.小地球</h3><hr><p>这个是展示访客的地理位置，能够直观的看到有哪些地方的人访问了，并标注到小地球🌍上。<br><img src="/img/20211011/0.png" alt="小地球"></p><h3 id="1-在线聊天工具"><a href="#1-在线聊天工具" class="headerlink" title="1.在线聊天工具"></a>1.在线聊天工具</h3><hr><p>这个是一个在线聊天工具，弄起来非常简单，推荐玩玩。下面这个是网站截图。<a href="https://www.tawk.to/">官网地址</a><br><img src="/img/20211011/1.png" alt="在线聊天工具"></p><h3 id="2-总结"><a href="#2-总结" class="headerlink" title="2.总结"></a>2.总结</h3><hr><p>新奇好玩的东西实在是太多了，还是要多看多尝试多记录。这样才能拓宽自己的知识的广度。</p>]]></content>
      
      
      <categories>
          
          <category> 插件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 在线聊天 </tag>
            
            <tag> 小地球 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>国庆假日分享</title>
      <link href="dayshare211001.html"/>
      <url>dayshare211001.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>疫情有了好转，不出远门，就近带着宝宝四处逛逛，散散心。</p></blockquote><h3 id="0-游玩历程"><a href="#0-游玩历程" class="headerlink" title="0.游玩历程"></a>0.游玩历程</h3><hr><h4 id="第一天"><a href="#第一天" class="headerlink" title="第一天"></a>第一天</h4><hr><p>从南京回老家，上午在家休整了一下，下午的时候约了小宝姐姐一起玩。晚上和家人们一起吃了晚饭。彤彤还是很喜欢和小宝姐姐玩的。</p><h4 id="第二天"><a href="#第二天" class="headerlink" title="第二天"></a>第二天</h4><hr><p>彤妈约了闺蜜喝茶叙旧，傍晚才回的仪征。上午就在家玩玩，下午带她睡了午觉，因为空调坏了，所以昨晚没有怎么睡好，上午空调修好了，接着这个午觉睡的好长，直到她妈妈回来也没有醒，最后还是慢慢叫醒的。回去之后，晚上和家人们一起吃了个晚饭。</p><h4 id="第三天"><a href="#第三天" class="headerlink" title="第三天"></a>第三天</h4><hr><p>早上吃了个早茶然后逛了逛白沙公园，中午大家一起去了海底捞。下午去了趟京华城逛了逛。放几张妈妈朋友圈的图，现在我是一个盗图的人。哈哈！</p><p>下面是吃的早茶，点的有点多，面条吃下去就有点顶了。最后还是打包了。</p><p><img src="/img/20211001/0.jpg" alt="奏乐中"></p><p><img src="/img/20211001/1.jpg" alt="松子烧卖"></p><p><img src="/img/20211001/2.jpg" alt="蟹黄汤包"></p><p><img src="/img/20211001/3.jpg" alt="蒸饺"></p><p><img src="/img/20211001/4.jpg" alt="紫薯包"></p><p><img src="/img/20211001/5.jpg" alt="腰花面"></p><p>接下来去的白沙公园，就是因为它的小城堡，里面拍照还是很好的，还有很多小孩子玩的，很适合带小朋友去逛逛的。</p><p><img src="/img/20211001/6.jpg" alt="仰望天空"></p><p><img src="/img/20211001/7.jpg" alt="回眸一笑"></p><p><img src="/img/20211001/8.jpg" alt="摆个造型"></p><p><img src="/img/20211001/9.jpg" alt="游客照"></p><p><img src="/img/20211001/10.jpg" alt="小城堡"></p><p><img src="/img/20211001/11.jpg" alt="大笑"></p><p><img src="/img/20211001/12.jpg" alt="荡秋千"></p><p><img src="/img/20211001/13.jpg" alt="看前面小姐姐跳舞"></p><p><img src="/img/20211001/14.jpg" alt="日常"></p><h4 id="第四天"><a href="#第四天" class="headerlink" title="第四天"></a>第四天</h4><hr><p>今天一早就起床准备回南京了，但是回之前准备去金牛湖野生动物园逛一下，大家如果想去玩的话，可以关注<code>南京金牛湖野生动物王国</code>的公众号，里面有园区地图和各种表演的时间安排。去了之后直接安排的**<code>国际大马戏</code>**。看攻略说要租一个电动自行车游玩会方便很多，一开始没有租，后面租的时候发现没有车，在那边等车的时候晒出了油。园区的动物没怎么看，彤宝貌似对它们没兴趣，最后租到车之后，看了几个动物，居然在电动车上睡着了，无奈就骑着车在园区里逛了一圈，带的食物也没有喂给小动物，最后也没有继续逛了，就回南京了。图还是盗的妈妈的朋友圈，励志做朋友圈的搬运工😄。</p><p><img src="/img/20211001/15.jpg" alt="大门口"></p><p><img src="/img/20211001/16.jpg" alt="入口"></p><p><img src="/img/20211001/17.jpg" alt="大熊"></p><p><img src="/img/20211001/18.jpg" alt="羊驼"></p><p><img src="/img/20211001/19.jpg" alt="彤宝"></p><p><img src="/img/20211001/20.jpg" alt="鹦鹉"></p><p><img src="/img/20211001/21.jpg" alt="大马戏"></p><p><img src="/img/20211001/22.jpg" alt="水母"></p><p>这一天就这么结束了。</p><h4 id="第五天"><a href="#第五天" class="headerlink" title="第五天"></a>第五天</h4><hr><p>今天没什么特殊的安排，带彤妈去医院看个眼睛。之后去迪卡侬逛了逛，然后就回来了。买了一个小凳子，有点贵，不过彤宝还是很喜欢的。<a href="https://www.decathlon.com.cn/zh/p/folding-camping-chair-mh500-grey/_/R-p-173601?mc=8492643&amp;c=%E7%81%B0%E8%89%B2">链接</a> 支付宝领个劵减了15块。</p><p><img src="/img/20211001/24.png" alt="小椅子"></p><h4 id="第六天"><a href="#第六天" class="headerlink" title="第六天"></a>第六天</h4><hr><p>假期余额不足了，今天带彤宝坐地铁去了明孝陵逛逛，景色还是不错的，而且天公作美，不是很晒。去的时候喂了梅花鹿，算是弥补了在动物园没有喂食的遗憾吧。玩了一会，她还是睡着了，这次她睡了一个小时，很热很热的睡了一个小时。还是很佩服的。晚上回来吃了晚饭，吃的还是比较多的，晚上都没有要喝奶。</p><p><img src="/img/20211001/25.jpeg" alt="手牵手下楼梯"></p><p><img src="/img/20211001/26.jpeg" alt="彤妈随手拍的"></p><p><img src="/img/20211001/27.jpeg" alt="喂鹿"></p><p><img src="/img/20211001/28.jpeg" alt="晚餐"></p><p><img src="/img/20211001/29.jpeg" alt="三只松鼠购物"></p><p><img src="/img/20211001/30.jpeg" alt="安静的睡着了"></p><p>今天彤宝的表现还是很棒的</p><h4 id="第七天"><a href="#第七天" class="headerlink" title="第七天"></a>第七天</h4><hr><p>准备带彤宝做个轮渡感受下，图后补。</p><p>早上去的比较晚了，11点左右才到的轮渡，12点正好有一班，就上去了。过去的时候，发现现在甲板上可以上去了，但是要收费，10元一个人。去程没上去，回来的时候上去看了下，还是很舒服的，视野比较开阔。</p><p><img src="/img/20211001/31.jpeg" alt="随手拍"></p><p><img src="/img/20211001/32.jpeg" alt="一家三口"></p><h3 id="1-总结"><a href="#1-总结" class="headerlink" title="1.总结"></a>1.总结</h3><hr><p>这个国庆没有出远门，回了老家也去了几个景点，感觉还是很充实的。彤彤在家的时候不哭不闹，每天按时睡觉，有时候两个人带娃感觉也是一种享受。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 遛娃 </tag>
            
            <tag> 国庆 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>节假日分享</title>
      <link href="dayshare210919.html"/>
      <url>dayshare210919.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>好久不见了，是不是还是有点想念。因为疫情的原因，一直到现在都没有更新博客了。现在好些了，加上现在正是中秋佳节，所以我们又回来啦。</p></blockquote><h3 id="0-珍珠泉玩耍"><a href="#0-珍珠泉玩耍" class="headerlink" title="0.珍珠泉玩耍"></a>0.珍珠泉玩耍</h3><hr><p>之前的年卡办了，好久都没用了，感觉不用就浪费了，所以今天就去了珍珠泉玩了。离家还是比较近，所以起来之后，洗洗弄弄就出发了。来到这里当然是要玩玩水啦，小孩子还是很喜欢玩水的。然后又去爬了爬楼梯，小家伙很喜欢爬楼梯，让我很是欣慰啊。接着就去小孩子玩的地方荡了会秋千，就去吃吃喝喝等小伙伴了。本来是要等小伙伴一起玩索道的，但是最后还是我们自己玩了索道，大彤彤一点都不怕，就是回来的时候睡着了。下面看看照片吧！</p><p><img src="/img/20210919/0.jpeg" alt="游客照"></p><p><img src="/img/20210919/0.1.jpg" alt="玩水中"></p><p><img src="/img/20210919/1.jpeg" alt="还是游客照"></p><p><img src="/img/20210919/1.1.jpg" alt="大彤宝"></p><p><img src="/img/20210919/cover.jpeg" alt="珍珠泉"></p><p><img src="/img/20210919/2.jpeg" alt="索道上拍的"></p><p><img src="/img/20210919/6.jpeg" alt="老婆拍的索道"></p><h3 id="1-兰溪公园"><a href="#1-兰溪公园" class="headerlink" title="1.兰溪公园"></a>1.兰溪公园</h3><hr><p>晚上去了个兰溪公园，还是不错的，有小孩的朋友可以去玩玩，小孩玩的东西孩是很多的，特别是沙子，玩的走不动路了。下面看看照片吧。</p><p><img src="/img/20210919/4.jpeg" alt="入口处"></p><p><img src="/img/20210919/5.jpeg" alt="老婆拍的"></p><p><img src="/img/20210919/7.jpeg" alt="玩沙子中"></p><h3 id="2-总结"><a href="#2-总结" class="headerlink" title="2.总结"></a>2.总结</h3><hr><p>没事还是得多出去看看，小孩子还是喜欢外面的世界。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 遛娃 </tag>
            
            <tag> 节假日 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用Word生成报告</title>
      <link href="genReport.html"/>
      <url>genReport.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>前段时间，有人问我能不能自动生成Word报告。需求是这样的，简述一下。要求根据提供的基础信息来生成所要的word报告。</p></blockquote><h3 id="0-思路"><a href="#0-思路" class="headerlink" title="0.思路"></a>0.思路</h3><hr><p>之前想直接用vbscript整篇生成的，但是整个报告的篇幅还是很长的，所以手写还是很费时很费力的。所以想转换思路，直接在Word中查找替换来实现，这样省去了排版的和输出文字等很多重复性的工作。但是这样的话有几个之前没弄过的：</p><ol><li>图片和表格保持原样式</li><li>将添加的按钮控件删除</li><li>定位和文件格式</li><li>生成的文档不能有宏</li><li>页眉的修改</li></ol><h3 id="1-实现"><a href="#1-实现" class="headerlink" title="1.实现"></a>1.实现</h3><hr><p>其实掌握了其中的诀窍之后，也不是很难的。首先查找替换功能网上都有现成的例子，可以参考，下面是代码：</p><pre class="line-numbers language-vbscript" data-language="vbscript"><code class="language-vbscript">Sub findAndReplace(find, replace)    Dim oRng As Range    Set oRng = Word.ActiveDocument.Content    With oRng.find        .ClearFormatting        With .Replacement            .ClearFormatting        End With        .Execute FindText:=find, ReplaceWith:=replace, replace:=wdReplaceAll    End WithEnd Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>接着是查找替换表格，这边略有不同，是利用了复制粘贴的功能，不得不说这个还是很实用的。<a href="https://docs.microsoft.com/zh-cn/office/vba/api/overview/word">微软的文档</a></p><pre class="line-numbers language-vbscript" data-language="vbscript"><code class="language-vbscript">' 查找到标签时会选中，然后将表格选中并粘贴进来就行Sub copyTable(ObjWD, table, tag)    table.Select    ObjWD.selection.Copy    With Word.selection.find     .Forward = True     .ClearFormatting     .MatchWholeWord = True     .MatchCase = False     .Wrap = wdFindContinue     .Execute FindText:=tag    End With    ' 这边需要注意，粘贴时需要保持原格式。参数的枚举值可以去官网查    Word.selection.PasteAndFormat 16End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>图片的处理和表格大同小异，主要是图片怎么取到的问题。这边看了文档没法确定那个图片是哪个，所以最后还是按顺序来操作的</p><pre class="line-numbers language-vbscript" data-language="vbscript"><code class="language-vbscript">Dim picArray, numnum = 0picArray = Array("pic0", "pic1", "pic2", "pic3", "pic4")For Each shp In ObjDOC.InlineShapes  If shp.Type = 3 Then ' 3 代表是图片    copyPicture ObjWD, shp, picArray(num)     num = num + 1   End If Next<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>之前提到的删除控件也和上面类似，只是类型不同，具体可参看官方文档。</p><p>保存不带宏的是通过新建一个新的文档，把处理好的结果全部拷贝过来，然后粘贴到新的文档中，注意⚠️要保存原格式。</p><p>替换使用唯一标签🏷️标记出来，找到了直接替换就行</p><p>页眉的也记录下</p><pre class="line-numbers language-vbscript" data-language="vbscript"><code class="language-vbscript">Sub EditHeaders(text)Dim i As LongFor i = 1 To ActiveDocument.Sections.Count    With ActiveDocument.Sections(i)        .Headers(1).Range.text = text    End WithNextEnd Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-结语"><a href="#2-结语" class="headerlink" title="2.结语"></a>2.结语</h3><hr><p>这个还有很多值得优化的地方，比如现在表格是和替换逻辑是写死，后续可以提供相关的信息来让用户选择。还有很多细节的东西可以推敲。今天就写到这吧，完整的代码就不贴了，其他的也没啥好贴的。如果想要的可以留言我。</p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> word </tag>
            
            <tag> vbscript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>彤宝的作业</title>
      <link href="dayshare210824.html"/>
      <url>dayshare210824.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>看到彤妈的朋友圈，应该是早教那边安排了作业，下面看看彤宝的完成情况吧！</p></blockquote><h3 id="以下图片摘自妈妈的朋友圈"><a href="#以下图片摘自妈妈的朋友圈" class="headerlink" title="以下图片摘自妈妈的朋友圈"></a>以下图片摘自妈妈的朋友圈</h3><hr><blockquote><p>交作业啦<br>摘树叶🍂+贴双面胶+撕双面胶+贴树叶=树叶贴画🌳<br>除了大树是妈妈画的，树叶妈妈帮忙整理一下，其他都由宝宝自己完成哦！点赞👍👍</p></blockquote><p><img src="/img/20210824/0.jpg" alt="图1"></p><p><img src="/img/20210824/1.jpg" alt="图2"></p><p><img src="/img/20210824/2.jpg" alt="图3"></p><p><img src="/img/20210824/3.jpg" alt="图4"></p><p><img src="/img/20210824/4.jpg" alt="图5"></p><p><img src="/img/20210824/5.jpg" alt="图6"></p><p><img src="/img/20210824/6.jpg" alt="图7"></p><p><img src="/img/20210824/7.jpg" alt="图8"></p><p><img src="/img/20210824/8.jpg" alt="图9"></p><h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><hr><p>彤宝成长的很快，很多事情都能够自己独立完成了，加油！</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 早教 </tag>
            
            <tag> 作业 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>玩具分享</title>
      <link href="toys.html"/>
      <url>toys.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>最近买了个野蛮娃娃的赛车，满足一下童年的愿望</p></blockquote><p>玩了下，还行。就是跑起来不走直线，虽然有微调，但是调了也不起什么作用。晒了图结束。谢谢老婆同意买这个小玩具😄。</p><p><img src="/img/20210822/1.jpeg" alt="图图图"></p><p><img src="/img/20210822/2.jpeg" alt="图图图"></p><p>后面再发点玩的视频或者图片。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 玩具 </tag>
            
            <tag> 遥控赛车 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Scriptable的使用</title>
      <link href="scriptable.html"/>
      <url>scriptable.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>上次说要整<code>Scriptable</code>的，这不他来了</p></blockquote><h3 id="0-开始"><a href="#0-开始" class="headerlink" title="0.开始"></a>0.开始</h3><hr><p>从他的插件中心下载了<code>iTermWidget</code>这个插件，为啥下载这个呢，因为我觉得他的排版和样式我很喜欢。下下来之后基本是不能用的状态，因为你得注册获拿到调用API的许可才行，这个是国外的，验证码刷不出来，注册半天也没搞出来，所以我准备不用原来的，自己搞起！</p><h3 id="1-过程"><a href="#1-过程" class="headerlink" title="1.过程"></a>1.过程</h3><hr><p>先看看成果吧<br><img src="/img/20210817/WechatIMG120.jpeg" alt="成果图"><br>之前的东西只有手机的电量和手机亮度是保留的，其他的都改掉了。<br>每行分别的意思是：</p><ol><li>网站的PV，总访问量和新旧访客的访问量</li><li>Notability的价格监控</li><li>天气</li><li>树莓派的温度，负载，和磁盘空间</li><li>公司打卡情况</li><li>手机的电量和亮度</li></ol><p>网站的PV是百度统计的，得自己去搞一下，这个是<a href="https://tongji.baidu.com/sc-web/10000222464/home/dataapi">百度统计的说明</a><br>价格监控是网上找的弄歪一个插件的，我只用了它的API，这边就不贴出来了<br>天气这个东西是好久之前找的一个API<br>树莓派的情况是上次和大家说的那个接口<br>公司打卡是自己抓的包，也不方便贴</p><h3 id="2-总结"><a href="#2-总结" class="headerlink" title="2.总结"></a>2.总结</h3><hr><p>本来想封装一个全的接口的，但是现在每个接口的数据都是json的，很好处理，所有就没有多此一举了。代码就不贴了都是js的。网上有很多的，比较通用的，这个属于个人定制了。</p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Scriptable </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Word中表格操作</title>
      <link href="wordChange.html"/>
      <url>wordChange.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>功能简介：将当前的Word表格换个格式保存</p></blockquote><h3 id="0-代码如下"><a href="#0-代码如下" class="headerlink" title="0.代码如下"></a>0.代码如下</h3><hr><pre class="line-numbers language-vbscript" data-language="vbscript"><code class="language-vbscript">' 复制文件，给Excel新增列On Error Resume NextFunction changeStyle(folderspec)Dim fso, f, file, fc, s ,s1 ,s2 ,s3,ObjWD,ObjDOCSet fso = CreateObject("scripting.FileSystemObject")Set ObjWD=CreateObject("Word.application")Set f = fso.GetFolder(folderspec)Set fc = f.FilesFor Each file in fcIf ( fso.getExtensionName(file.Path) = "doc" Or fso.getExtensionName(file.Path) = "docx" ) and instr(file.Path,"~") = 0 ThenSet objDoc=ObjWD.Documents.Open(file.Path)Set objSelection = ObjWD.Selection' 选中最后一个表格set objTable=objDoc.Tables(objDoc.tables.Count)rowNum = objTable.Rows.Count ' 先新增再删除objSelection.EndKey 6ObjSelection.TypeParagraphObjDOC.Tables.Add objSelection.Range, rowNum, 10Set objTable1 = ObjDOC.Tables(objDoc.tables.Count) objTable1.AutoFitBehavior 2'*************表格样式objTable1.Range.Style = "网格型"' 合并单元格' 一、软件资料问题objSelection.MoveRight 1, 10, 1objSelection.Cells.MergeobjSelection.MoveDown 5, 1objSelection.MoveRight 1, 1objSelection.MoveRight 1, 2, 1objSelection.Cells.MergeobjSelection.MoveRight 1, 1objSelection.MoveRight 1, 2, 1objSelection.Cells.MergeobjSelection.MoveRight 1, 1objSelection.MoveRight 1, 2, 1objSelection.Cells.MergeobjSelection.MoveRight 1, 1objSelection.MoveRight 1, 2, 1objSelection.Cells.MergeobjTable1.Cell(3, 1).Range.SelectobjSelection.MoveRight 1, 1objSelection.MoveRight 1, 2, 1objSelection.Cells.MergeobjSelection.MoveRight 1, 1objSelection.MoveRight 1, 2, 1objSelection.Cells.MergeobjSelection.MoveRight 1, 1objSelection.MoveRight 1, 2, 1objSelection.Cells.MergeobjSelection.MoveRight 1, 1objSelection.MoveRight 1, 2, 1objSelection.Cells.MergeobjTable1.Cell(2, 1).Range.SelectobjSelection.MoveDown 5, 2objSelection.MoveRight 1, 10, 1objSelection.Cells.Merge'-------------------------objTable1.Cell(1, 1).Range.Font.Size = 12objTable1.Cell(1, 1).Range.Font.Bold = TrueobjTable1.Cell(1, 1).Range.Text = "一、软件资料问题"objTable1.Cell(2, 1).Range.Text = "序号"objTable1.Cell(2, 2).Range.Text = "软件资料问题点"objTable1.Cell(2, 3).Range.Text = "整改建议"objTable1.Cell(2, 4).Range.Text = "整改期限"objTable1.Cell(2, 5).Range.Text = "整改依据"objTable1.Cell(2, 6).Range.Text = "备注"objTable1.Cell(4, 1).Range.Font.Size = 12objTable1.Cell(4, 1).Range.Font.Bold = TrueFor i = 1 to 10objTable1.Cell(5, i).Range.Font.Size = 12objTable1.Cell(5, i).Range.Font.Bold = Trueif i &lt;= 6 thenobjTable1.Cell(2, i).Range.Font.Size = 12objTable1.Cell(2, i).Range.Font.Bold = Trueend ifNextobjTable1.Cell(4, 1).Range.Text = "二、现场问题"objTable1.Cell(5, 1).Range.Text = "序号"objTable1.Cell(5, 2).Range.Text = "现场照片"objTable1.Cell(5, 3).Range.Text = "现场安全隐患"objTable1.Cell(5, 4).Range.Text = "整改意见"objTable1.Cell(5, 5).Range.Text = "整改期限"objTable1.Cell(5, 6).Range.Text = "整改依据"objTable1.Cell(5, 7).Range.Text = "依据原文"objTable1.Cell(5, 8).Range.Text = "隐患等级"objTable1.Cell(5, 9).Range.Text = "备注"objTable1.Cell(5, 10).Range.Text = "类别"ObjSelection.font.Size=10ObjSelection.font.Bold=FalseObjSelection.font.name = "宋体"rowFlag = 0for i=1 to rowNumif instr(objTable.Cell(i, 1).Range.Text,"现场问题") &gt; 0 thenrowFlag = iexit forend ifNextendNum = rowFlag - 1for i=3 to endNumfor j = 1 to 6objTable1.Cell(i, j).Range.Font.Size = 10objTable1.Cell(i, j).Range.Font.Bold = FalseobjTable1.Cell(i, j).Range.Cells.VerticalAlignment = 1 NextobjTable1.Cell(i, 1).Range.Text = (i-2)objTable1.Cell(i, 2).Range.Text = objTable.Cell(i, 2).Range.Text objTable1.Cell(i, 3).Range.Text = objTable.Cell(i, 3).Range.Text objTable1.Cell(i, 4).Range.Text = "立即整改"objTable1.Cell(i, 5).Range.Text = objTable.Cell(i, 4).Range.Text objTable1.Cell(i, 6).Range.Text = ""NextFor i = 6 To rowNumFor j = 1 To 10objTable1.Cell(i, j).Range.Font.Size = 10objTable1.Cell(i, j).Range.Font.Bold = FalseobjTable1.Cell(i, j).Range.Cells.VerticalAlignment = 1 'objWorksheet.Range("K13").SelectobjTable1.Cell(i, 1).Range.Text = (i - 5) &amp; "."objTable.Cell(i, 2).Range.SelectobjSelection.Copy objTable1.Cell(i, 2).Range.SelectobjSelection.Paste objTable1.Cell(i, 3).Range.Text = objTable.Cell(i, 3).Range.Text objTable1.Cell(i, 4).Range.Text = replace(objTable.Cell(i, 4).Range.Text,"立即整改","") objTable1.Cell(i, 5).Range.Text = "立即整改"objTable1.Cell(i, 6).Range.Text = objTable.Cell(i, 5).Range.Text 'objTable1.Cell(i, 1).Range.Value = objTable.Cell(i, 1).Range.Cells.ValueNextNextobjTable.Deleteend ifObjDOC.SaveAs folderspec &amp; "\Result\" &amp; file.nameNextobjDoc.Close FalseObjWD.QuitEnd Functionpath = InputBox("请输入要处理的目录","提醒","C:\Users\XXXX\Desktop\hhh\格式修改\Input")changeStyle(path) <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vbs </tag>
            
            <tag> word </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iPad Pro&amp;Apple Pencil 2</title>
      <link href="apple.html"/>
      <url>apple.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>最近缠着老婆要了苹果的iPad Pro和Apple pencil ，有了它们之后，就去找了找看看什么软件搭配这个笔比较好，所以就有了下面的文章。一起来看看吧！</p></blockquote><h3 id="0-购买过程"><a href="#0-购买过程" class="headerlink" title="0.购买过程"></a>0.购买过程</h3><hr><p>这两个东西，心心念念了很久，但是太贵了，一直没舍得下手。最近苹果的<strong>教育优惠</strong>也开始了，所以我就想着来一波。购买的理由是陪老婆玩游戏的，终于在前不久把这个事情给落实了。平板和笔是分开买的，因为老婆觉得笔没必要，所以不答应我买，不过最后我决定自费买一支😄，找了老婆同事的朋友，<strong>9折</strong>拿下了笔。<br><img src="/img/20210814/pen.png" alt="笔"></p><p><img src="/img/20210814/2.jpeg" alt="平板"></p><p><img src="/img/20210814/0.png" alt="送的耳机"></p><h3 id="1-使用历程"><a href="#1-使用历程" class="headerlink" title="1.使用历程"></a>1.使用历程</h3><hr><p>笔没到之前，单独使用了iPad感觉就是快了，进游戏的速度比老婆那个老Pad快了不少，然后就是能耗也还好，最喜欢的还是随航功能，最近在家办公，所以这个功能着实好用啊。等笔拿到手，发现自己竟然一无是处😂，字嘛写的不好看，画画嘛也丑到不行，感觉笔买的没啥用。其实一开始的想法只是想用它来记录下自己的想法的，有时候电脑上不能够直观的表达出来，写在纸上吧，迟早是要丢的，所以还是想用它来做这些。</p><h3 id="2-意外收获"><a href="#2-意外收获" class="headerlink" title="2.意外收获"></a>2.意外收获</h3><hr><p>网上找到了合适的笔记软件，奈何都比较贵。但是苹果有限免，所以就想找个可以查找限免的接口，看看啥时候它在内。找了一圈没有现成的接口，后来看到知乎上的这个<a href="https://www.zhihu.com/question/380173718/answer/1600608423">文章</a>意外的发现了<strong>Scriptable</strong>这个软件，虽然它和捷径差不多，但是感觉它更自由，可玩性更高。之前看到过它，但是一直没有下载，刚刚下载试了试，还是不错的。<br><img src="/img/20210814/1.png" alt="Scriptable的截图"><br>能用上小组件感觉就很好。</p><h3 id="3-准备折腾"><a href="#3-准备折腾" class="headerlink" title="3.准备折腾"></a>3.准备折腾</h3><hr><p>有了树莓派，再加上写一些整合的接口，就可以组合搞一些好玩的东西了。可以用来显示树莓派的状态和追踪某个特定app的价格是否变动，也可以显示别的一些东西。再通过之前的server酱来通知，感觉会很好玩。后面有整出来在写个东西给你们看看。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iPad </tag>
            
            <tag> Apple Pencil 2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pi-dashboard的使用</title>
      <link href="pi-dashboard.html"/>
      <url>pi-dashboard.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>想监控树莓派的运行状态，网上找了一个项目叫<code>pi-dashboard</code>的项目 </p></blockquote><h3 id="0-安装"><a href="#0-安装" class="headerlink" title="0.安装"></a>0.安装</h3><hr><p>教程写的很详细，不需要在多写啥了，链接在下方</p><p>参考地址 <a href="https://make.quwj.com/project/10">https://make.quwj.com/project/10</a></p><p>如果php安装报找不到，加上源</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo add-apt-repository ppa:ondrej/php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="1-修改访问慢的问题"><a href="#1-修改访问慢的问题" class="headerlink" title="1.修改访问慢的问题"></a>1.修改访问慢的问题</h3><hr><p>1.进去首页很面，发现<strong>bootstrap.min.css</strong>里面引用了这个 <a href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700">https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700</a> 这个东西得等他超时后，页面才渲染出来，我直接给注释了，现在页面秒开。</p><p><img src="/img/20210802/cover.png" alt="页面截图"></p><h3 id="2-后续想法"><a href="#2-后续想法" class="headerlink" title="2.后续想法"></a>2.后续想法</h3><hr><p>看了一下这个这个项目，是通过<code>GET</code> <strong><a href="http://192.168.50.XXX:Port/pi-dashboard/?ajax=true">http://192.168.50.XXX:Port/pi-dashboard/?ajax=true</a></strong> 这个地址来获得信息的。所以后面可以结合server酱来做一些系统运行状态的通知。<br>如内存和空间的预警等等。<br>返回的信息如下：<br><img src="/img/20210802/0.png" alt="返回截图"><br>基本的系统信息都包括了，还是挺好的。</p><h3 id="3-结语"><a href="#3-结语" class="headerlink" title="3.结语"></a>3.结语</h3><hr><p>后面准备在树莓派上多搞搞东西，多用用这个小东西。</p>]]></content>
      
      
      <categories>
          
          <category> 树莓派 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pi-dashboard </tag>
            
            <tag> 树莓派 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>树莓派上webDAV的搭建</title>
      <link href="smpwebDAV.html"/>
      <url>smpwebDAV.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>树莓派落灰很久了，最近群晖又总是抽风，所以准备重新捡起来用。把之前群晖上的小东西移到这上面来</p></blockquote><h3 id="0-镜像烧录"><a href="#0-镜像烧录" class="headerlink" title="0.镜像烧录"></a>0.镜像烧录</h3><hr><p>这边有参照的教程，<a href="https://www.pianshen.com/article/47451804883/">点击这里</a><br>工具的链接在<a href="https://www.balena.io/etcher/">这里</a><br>树莓派的<a href="https://www.raspberrypi.org/software/operating-systems/">镜像地址</a></p><h3 id="1-连上树莓派"><a href="#1-连上树莓派" class="headerlink" title="1.连上树莓派"></a>1.连上树莓派</h3><hr><p>烧录成功后，给树莓派通电之后使用<code>ssh</code>连接到树莓派上。我烧录的是ubuntu server ，默认的用户名密码都是<strong>ubuntu</strong><br>树莓派的地址可以从你的路由器中查看到。<br><img src="/img/20210731/0.png" alt="路由器截图"><br>接着就能够通过这个IP连接到树莓派了。登上了之后就需要修改密码，修改完成就行。<br><img src="/img/20210731/1.png" alt="命令行截图"><br>下面就可以开始操作了</p><h3 id="2-换源"><a href="#2-换源" class="headerlink" title="2.换源"></a>2.换源</h3><hr><p>这是网上找的清华的源</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ focal main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ focal main restricted universe multiversedeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ focal-updates main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ focal-updates main restricted universe multiversedeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ focal-backports main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ focal-backports main restricted universe multiversedeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ focal-security main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ focal-security main restricted universe multiverse# 预发布软件源，不建议启用# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ focal-proposed main restricted universe multiverse# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu-ports/ focal-proposed main restricted universe multiverse<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-安装webDAV"><a href="#3-安装webDAV" class="headerlink" title="3.安装webDAV"></a>3.安装webDAV</h3><hr><ol><li>安装apache2服务:<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo apt-get install apache2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>启用相关模块<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo a2enmod dav_fssudo a2enmod davsudo a2enmod dav_lock<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li>创建虚拟主机目录:<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo mkdir /var/www/syncsudo chown www-data:www-data /var/www/sync# 创建 Joplin 文件夹用作笔记同步sudo mkdir /var/www/sync/Joplinsudo chown www-data:www-data /var/www/sync/Joplin/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li>创建用户:<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo htpasswd -c /var/www/me.dav freefittersudo chown root:www-data /var/www/me.davsudo chmod 640 /var/www/me.dav<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li>配置虚拟主机:<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo vim /etc/apache2/sites-available/webdav.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>在文件加入如下内容<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>VirtualHost</span> <span class="token attr-name"><span class="token namespace">*:</span>50xx</span><span class="token punctuation">&gt;</span></span>        ServerAdmin webmaster@localhost        DocumentRoot /var/www/sync/        &lt;Directory /var/www/sync/&gt;                Options Indexes MultiViews                AllowOverride None                Require all granted        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Directory</span><span class="token punctuation">&gt;</span></span>         Alias /webdav /var/www/sync         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Location</span> <span class="token punctuation">/&gt;</span></span>           DAV On           AuthType Basic           AuthName "xxxx"           AuthUserFile /var/www/me.dav           Require valid-user       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Location</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>VirtualHost</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><p><strong>注意⚠️：</strong></p><p>更换端口的话，需要在<code>/etc/apache2/ports.conf </code>中修改</p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"># If you just change the port or add more ports here, you will likely also# have to change the VirtualHost statement in# /etc/apache2/sites-enabled/000-default.confListen 50xx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IfModule</span> <span class="token attr-name">ssl_module</span><span class="token punctuation">&gt;</span></span>Listen 50xx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>IfModule</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IfModule</span> <span class="token attr-name">mod_gnutls.c</span><span class="token punctuation">&gt;</span></span>Listen 443<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>IfModule</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="6"><li>链接配置文件</li></ol><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">cd /etc/apache2/sites-enabled/sudo ln -s ../sites-available/webdav.conf webdav.confsudo rm 000-default.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ol start="7"><li>重启<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo service apache2 restart<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>验证</li></ol><p>  浏览器中输入地址 <a href="http://192.168.50.234:5005/webdav/Joplin/">http://192.168.50.234:5005/webdav/Joplin/</a>就行了。</p><h3 id="4-Joplin的使用"><a href="#4-Joplin的使用" class="headerlink" title="4.Joplin的使用"></a>4.Joplin的使用</h3><hr><p>都是按照之前的配置去安装的，所以这一部分可以参看先前的文章操作即可。</p>]]></content>
      
      
      <categories>
          
          <category> 树莓派 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Joplin </tag>
            
            <tag> 树莓派 </tag>
            
            <tag> webDAV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周末分享</title>
      <link href="dayshare210725.html"/>
      <url>dayshare210725.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>南京突如其来的疫情让本身平静的生活有了些波澜。彤宝的课都取消了，这个周末都是宅在家里的。</p></blockquote><h3 id="0-在家干什么"><a href="#0-在家干什么" class="headerlink" title="0.在家干什么"></a>0.在家干什么</h3><hr><p>彤妈放假在家陪彤彤，周五的下午在家自己搭了个乐高，大家可以猜猜她搭的是什么</p><p><img src="/img/20210725/4.jpg" alt="猜猜猜"></p><p><img src="/img/20210725/5.jpg" alt="猜猜猜"></p><p><img src="/img/20210725/6.jpg" alt="猜猜猜"></p><p>然后我又给她搭了个大房子，彤宝喜欢往里面塞东西，所以给她装了四扇门，方便拿取。然后也搭的比较高，这样的话容量回大一些。看看我们的成品吧</p><p><img src="/img/20210725/1.jpg" alt="大房子"></p><p><img src="/img/20210725/2.jpg" alt="大房子"></p><p><img src="/img/20210725/3.jpg" alt="大房子"></p><p>除了搭乐高，还玩了荡秋千的游戏。就是用被子裹着彤彤摇来摇去。</p><p><img src="/img/20210725/7.jpg" alt="荡秋千"></p><p>当然除了玩耍还有看JOJO，现在的她很想看JOJO，但是还是得做好限制，不然这样下去，眼睛会受不了的。</p><h3 id="1-防疫"><a href="#1-防疫" class="headerlink" title="1.防疫"></a>1.防疫</h3><hr><p>南京的疫情挺严重了，周中和周天都去做了核酸了，希望疫情快点过去。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 遛娃 </tag>
            
            <tag> 防疫 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>图片中人脸提取</title>
      <link href="opencv.html"/>
      <url>opencv.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>最近需要写一个工具，提取图片中的人脸，并且识别出相关信息，最后按照一定的规则进行存储。</p></blockquote><h3 id="0-分析"><a href="#0-分析" class="headerlink" title="0.分析"></a>0.分析</h3><hr><p>通过上述需求，需要做的是OCR文字识别和人脸识别，语言选择<code>Python</code>。人脸提取使用的是OpenCV，简单介绍一下，摘自百度百科。</p><blockquote><p>OpenCV是一个基于BSD许可（开源）发行的跨平台计算机视觉和机器学习软件库，可以运行在Linux、Windows、Android和Mac OS操作系统上。 它轻量级而且高效——由一系列 C 函数和少量 C++ 类构成，同时提供了Python、Ruby、MATLAB等语言的接口，实现了图像处理和计算机视觉方面的很多通用算法。</p></blockquote><p>文字识别准备使用 <code>Tesseract</code></p><blockquote><p>Tesseract最初由惠普实验室支持，用于电子版文字识别，1996年被移植到Windows上，1998年进行了C++化，在2005年Tesseract由惠普公司宣布开源。2006年到现在，由Google公司维护开发。</p></blockquote><h3 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1.准备工作"></a>1.准备工作</h3><ol><li><p>安装 <code>Tesseract</code> 和 <code>pytesseract</code></p><ul><li>Windows上下载安装包，<a href="https://digi.bib.uni-mannheim.de/tesseract/">点击这里</a>下载</li><li>双击运行，一直下一步就行</li><li>配置环境变量，把刚刚安装的路径配置进去就行</li><li>使用 <em><strong>pip install pytesseract</strong></em> 安装<code>pytesseract</code>  </li><li>配置 pytesseract.py 路径在 Lib\site-packages\pytesseract\pytesseract.py 下修改下面变量为之前的安装路径 <img src="/img/20210720/1.png" alt="改变命令行位置"></li><li>下载语言包，放在<strong>tessdata</strong> 下，<a href="https://github.com/tesseract-ocr/tessdata">点击这里</a>下载</li></ul></li><li><p>安装 <code>opencv</code></p><ul><li>使用<em><strong>pip install opencv-python</strong></em> 安装opencv-python<ul><li> haar人脸特征分类器下载<a href="https://github.com/opencv/opencv/tree/master/data">点击这里</a>下载</li></ul></li></ul></li></ol><blockquote><p><code>后面因为文字识别的准确率实在太低了，不得不换成Excel读取相关信息，后面继续优化</code></p></blockquote><ol start="3"><li>使用 <strong><code>pip install xlrd==1.2.0</code></strong> 安装<code>xlrd</code> 解析Excel，高版本的不支持xlsx，所以得装低版本的。</li></ol><h3 id="2-编写程序"><a href="#2-编写程序" class="headerlink" title="2.编写程序"></a>2.编写程序</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> cv2<span class="token keyword">import</span> os<span class="token keyword">import</span> xlrd<span class="token keyword">import</span> shutil<span class="token keyword">from</span> tkinter <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> tkinter <span class="token keyword">import</span> scrolledtext<span class="token keyword">import</span> numpy <span class="token keyword">as</span> npj <span class="token operator">=</span> <span class="token number">0</span>width <span class="token operator">=</span> <span class="token number">200</span>height <span class="token operator">=</span> <span class="token number">250</span>dim <span class="token operator">=</span> <span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    root_path <span class="token operator">=</span> txt<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\\"</span>    data <span class="token operator">=</span> xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>root_path <span class="token operator">+</span> txt1<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    table <span class="token operator">=</span> data<span class="token punctuation">.</span>sheets<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    dcit <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token comment"># 加载人员信息</span>    <span class="token keyword">for</span> rown <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span>nrows<span class="token punctuation">)</span><span class="token punctuation">:</span>        dcit<span class="token punctuation">[</span>table<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span>rown<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> table<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span>rown<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"#"</span> <span class="token operator">+</span> table<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span>rown<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>root_path<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">".jpg"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            path2 <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>root_path<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\\"</span><span class="token punctuation">,</span> <span class="token string">"\\\\"</span><span class="token punctuation">)</span>  <span class="token comment"># 拼接绝对路径</span>            <span class="token comment"># img = cv2.imread(path2, 1)  # 读取一张图片</span>            img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imdecode<span class="token punctuation">(</span>np<span class="token punctuation">.</span>fromfile<span class="token punctuation">(</span>path2<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>            <span class="token comment"># 提取人脸图片</span>            stxt<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>INSERT<span class="token punctuation">,</span> <span class="token string">r"开始提取文件["</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">"]人脸信息\n"</span><span class="token punctuation">)</span>            gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>  <span class="token comment"># 将图片转化成灰度</span>            face_cascade <span class="token operator">=</span> cv2<span class="token punctuation">.</span>CascadeClassifier<span class="token punctuation">(</span>                <span class="token string">"config\\haarcascade_frontalface_alt2.xml"</span><span class="token punctuation">)</span>            faces <span class="token operator">=</span> face_cascade<span class="token punctuation">.</span>detectMultiScale<span class="token punctuation">(</span>gray<span class="token punctuation">,</span> <span class="token number">1.3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>faces<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span> <span class="token keyword">in</span> faces<span class="token punctuation">:</span>                    <span class="token comment"># img = cv2.rectangle(img, (x, y), (x+w, y+h), (255, 0, 0), 2)</span>                    cropped <span class="token operator">=</span> img<span class="token punctuation">[</span>y <span class="token operator">-</span> <span class="token number">60</span><span class="token punctuation">:</span> y <span class="token operator">+</span> w <span class="token operator">+</span> <span class="token number">60</span><span class="token punctuation">,</span> x <span class="token operator">-</span> <span class="token number">30</span><span class="token punctuation">:</span>x <span class="token operator">+</span> h <span class="token operator">+</span> <span class="token number">44</span><span class="token punctuation">]</span>  <span class="token comment"># 裁剪坐标为[y0:y1, x0:x1]</span>                    resized <span class="token operator">=</span> cv2<span class="token punctuation">.</span>resize<span class="token punctuation">(</span>cropped<span class="token punctuation">,</span> dim<span class="token punctuation">,</span> interpolation<span class="token operator">=</span>cv2<span class="token punctuation">.</span>INTER_AREA<span class="token punctuation">)</span>                <span class="token comment"># cv2.imshow("image", resized)</span>                <span class="token comment"># 进行xjk和zp分类</span>                idNo <span class="token operator">=</span> i<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                <span class="token keyword">if</span> idNo <span class="token keyword">in</span> dcit<span class="token punctuation">:</span>                    stxt<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>INSERT<span class="token punctuation">,</span> <span class="token string">"正在分类["</span> <span class="token operator">+</span> idNo <span class="token operator">+</span> <span class="token string">"]\n"</span><span class="token punctuation">)</span>                    val <span class="token operator">=</span> dcit<span class="token punctuation">[</span>idNo<span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"#"</span><span class="token punctuation">)</span>                    name <span class="token operator">=</span> val<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    peopleType <span class="token operator">=</span> val<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>                    folder <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>root_path <span class="token operator">+</span> <span class="token string">"Result\\"</span> <span class="token operator">+</span> peopleType <span class="token operator">+</span> <span class="token string">"\\zp\\"</span><span class="token punctuation">)</span>                    <span class="token keyword">if</span> <span class="token keyword">not</span> folder<span class="token punctuation">:</span>                        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>root_path <span class="token operator">+</span> <span class="token string">"Result\\"</span> <span class="token operator">+</span> peopleType <span class="token operator">+</span> <span class="token string">"\\zp\\"</span><span class="token punctuation">)</span>                    folder <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>root_path <span class="token operator">+</span> <span class="token string">"Result\\"</span> <span class="token operator">+</span> peopleType <span class="token operator">+</span> <span class="token string">"\\xjk\\"</span><span class="token punctuation">)</span>                    <span class="token keyword">if</span> <span class="token keyword">not</span> folder<span class="token punctuation">:</span>                        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>root_path <span class="token operator">+</span> <span class="token string">"Result\\"</span> <span class="token operator">+</span> peopleType <span class="token operator">+</span> <span class="token string">"\\xjk\\"</span><span class="token punctuation">)</span>                    <span class="token comment"># cv2.imwrite(, resized)</span>                    cv2<span class="token punctuation">.</span>imencode<span class="token punctuation">(</span><span class="token string">'.jpg'</span><span class="token punctuation">,</span> resized<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>tofile<span class="token punctuation">(</span>                        root_path <span class="token operator">+</span> <span class="token string">"Result\\"</span> <span class="token operator">+</span> peopleType <span class="token operator">+</span> <span class="token string">"\\zp\\"</span> <span class="token operator">+</span> idNo <span class="token operator">+</span> <span class="token string">'.jpg'</span><span class="token punctuation">)</span>                    shutil<span class="token punctuation">.</span>move<span class="token punctuation">(</span>root_path <span class="token operator">+</span> i<span class="token punctuation">,</span> root_path <span class="token operator">+</span> <span class="token string">"Result\\"</span> <span class="token operator">+</span> peopleType <span class="token operator">+</span> <span class="token string">"\\xjk\\"</span> <span class="token operator">+</span> idNo <span class="token operator">+</span> <span class="token string">'.jpg'</span><span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    stxt<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>INSERT<span class="token punctuation">,</span> <span class="token string">"表格中没有为["</span> <span class="token operator">+</span> idNo <span class="token operator">+</span> <span class="token string">"]的人\n"</span><span class="token punctuation">)</span>                <span class="token comment"># cv2.destroyAllWindows()</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                stxt<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>INSERT<span class="token punctuation">,</span> <span class="token string">"文件["</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">"]未识别到人脸\n"</span><span class="token punctuation">)</span>            stxt<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>INSERT<span class="token punctuation">,</span> <span class="token string">"-------------------\n"</span><span class="token punctuation">)</span>            stxt<span class="token punctuation">.</span>see<span class="token punctuation">(</span>END<span class="token punctuation">)</span>            stxt<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>    stxt<span class="token punctuation">.</span>insert<span class="token punctuation">(</span>INSERT<span class="token punctuation">,</span> <span class="token string">"处理完成.....\n"</span><span class="token punctuation">)</span>tk <span class="token operator">=</span> Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>tk<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"图片分类器"</span><span class="token punctuation">)</span>tk<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">"310x320"</span><span class="token punctuation">)</span>tk<span class="token punctuation">.</span>resizable<span class="token punctuation">(</span>width<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>lbl0 <span class="token operator">=</span> Label<span class="token punctuation">(</span>tk<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"登记表和图片需要放在一个文件夹下"</span><span class="token punctuation">,</span> fg<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'yellow'</span><span class="token punctuation">)</span>lbl <span class="token operator">=</span> Label<span class="token punctuation">(</span>tk<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"图片路径:"</span><span class="token punctuation">)</span>btn <span class="token operator">=</span> Button<span class="token punctuation">(</span>tk<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"开始分类"</span><span class="token punctuation">,</span> command<span class="token operator">=</span>clicked<span class="token punctuation">)</span>default <span class="token operator">=</span> StringVar<span class="token punctuation">(</span>tk<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">'C:\\Users\\xxx\\Desktop\\sss\\xjk'</span><span class="token punctuation">)</span>txt <span class="token operator">=</span> Entry<span class="token punctuation">(</span>tk<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>default<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>lbl1 <span class="token operator">=</span> Label<span class="token punctuation">(</span>tk<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">"登记表名称:"</span><span class="token punctuation">)</span>default <span class="token operator">=</span> StringVar<span class="token punctuation">(</span>tk<span class="token punctuation">,</span> value<span class="token operator">=</span><span class="token string">'11.xlsx'</span><span class="token punctuation">)</span>txt1 <span class="token operator">=</span> Entry<span class="token punctuation">(</span>tk<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>default<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>stxt <span class="token operator">=</span> scrolledtext<span class="token punctuation">.</span>ScrolledText<span class="token punctuation">(</span>tk<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>lbl0<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>columnspan<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>lbl<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>txt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>lbl1<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>txt1<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>btn<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> columnspan<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> sticky<span class="token operator">=</span>W<span class="token operator">+</span>E<span class="token operator">+</span>N<span class="token operator">+</span>S<span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>stxt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>column<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> row<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> columnspan<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> sticky<span class="token operator">=</span>W<span class="token operator">+</span>E<span class="token operator">+</span>N<span class="token operator">+</span>S<span class="token punctuation">,</span> padx<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> pady<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>tk<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-总结"><a href="#3-总结" class="headerlink" title="3.总结"></a>3.总结</h3><hr><p>很多时候应该想着去偷懒，只有想着去偷懒才能够自己去写工具，去学习。虽然不是很深入，但是你知识的广度会拓宽。</p><h4 id="20210827-更新"><a href="#20210827-更新" class="headerlink" title="20210827 更新"></a>20210827 更新</h4><hr><blockquote><p>为了方便使用者，转成了可执行文件并且做了个简单的界面。今天想起来就更新上</p></blockquote><p>使用 <strong>pip install pyinstaller</strong> 安装  <strong>pyinstaller</strong><br>使用 <strong>pyinstaller -F TestForFun.py -w</strong> 生成可执行文件</p><p><img src="/img/20210720/1.png" alt="简单的界面"></p><p>代码在上面，已经更新过了</p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> opencv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vbs解析word生成表格和文档</title>
      <link href="genWord.html"/>
      <url>genWord.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>最近写了个VBS的工具，记录一下，以便以后查找。工具这种东西，还是需要需求驱动的，主要的还是要有一颗偷懒的心。</p></blockquote><h3 id="0-脚本简介"><a href="#0-脚本简介" class="headerlink" title="0.脚本简介"></a>0.脚本简介</h3><hr><p>这个脚本是读取word文档，提取word中的表格数据，并按照一定格式输出出来。然后根据这个结果生成word文档。其实读取数据啥的比较简单，主要是格式有要求。还有就是需要操作word中的表格比较麻烦。</p><h3 id="1-代码展示"><a href="#1-代码展示" class="headerlink" title="1.代码展示"></a>1.代码展示</h3><hr><pre class="line-numbers language-vbscript" data-language="vbscript"><code class="language-vbscript">Sub main()    Set dirFSO = CreateObject("Scripting.FileSystemObject")    Set wdapp = CreateObject("Word.Application")    Set tjDict = CreateObject("Scripting.Dictionary")        Set regEx = CreateObject("vbscript.regexp")    regEx.Pattern = "\d+"    regEx.IgnoreCase = True '设置是否区分大小写    regEx.Global = True '设置全程匹配    wdapp.Visible = False       fileNum = Sheet1.Range("A65535").End(-4162).Row    ' 获得目录下所有的word文件    filePath = Sheet1.Cells(1, 11).Value    Set dirFiles = dirFSO.GetFolder(filePath)        '员工总人数    ygzrs = 0    '厂房面积总数    cfmjzs = 0    '仓库面积    ckmjzs = 0     '产值    czzs = 0    For Each file In dirFiles.Files        If dirFSO.getExtensionName(file.Path) = "doc" Or dirFSO.getExtensionName(file.Path) = "docx" Then            ' 打开word 获取内容            On Error GoTo Err_Handle            Set wordDoc = wdapp.Documents.Open(file.Path)            Set objTable = wordDoc.Tables(1)            rowNum = fileNum + 1            ' 序号            Sheet1.Cells(rowNum, 1).Value = fileNum - 1            ' 名称            Sheet1.Cells(rowNum, 2).Value = Replace(objTable.Cell(1, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")            ' 主要负责人            Sheet1.Cells(rowNum, 3).Value = Replace(objTable.Cell(2, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")            ' 联系电话            Sheet1.Cells(rowNum, 4).Value = Replace(objTable.Cell(2, 4).Range.Text, Chr$(13) &amp; Chr$(7), "")            ' 现场联系人            Sheet1.Cells(rowNum, 5).Value = Replace(objTable.Cell(3, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")            ' 联系电话            Sheet1.Cells(rowNum, 6).Value = Replace(objTable.Cell(3, 4).Range.Text, Chr$(13) &amp; Chr$(7), "")            ' 地  址            Sheet1.Cells(rowNum, 7).Value = Replace(objTable.Cell(4, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")            '检查时间            checkTime = Replace(objTable.Cell(1, 4).Range.Text, Chr$(13) &amp; Chr$(7), "")            Set matches = regEx.Execute(checkTime)            checkStr = ""            For Each match1 In matches                checkStr = checkStr + match1 + "."            Next            Sheet1.Columns("C").AutoFit            Sheet1.Columns("G").AutoFit            Sheet1.Cells(rowNum, 8).Value = Left(checkStr, Len(checkStr) - 1)            ' 做报告人员            Sheet1.Cells(rowNum, 9).Value = "XXXX"            ' 检查人员            Sheet1.Cells(rowNum, 10).Value = "XXXX"                        '****************保存word所需要的数据 start             ' 所属行业            sshy = Replace(objTable.Cell(5, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")            Sheet3.Cells(rowNum, 1).Value = sshy            If tjDict.Exists(sshy) Then                tmp = tjDict.Item(sshy)                tjDict.Item(sshy) = tmp + 1            Else                tjDict.Item(sshy) = 1            End If                        aa = tjDict.Items()            bb = tjDict.Keys()                        ' 员工人数            ygrs = Replace(objTable.Cell(6, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")            tmpNum = Replace(ygrs, "人", "")            Sheet3.Cells(rowNum, 2).Value = tmpNum            ygzrs = ygzrs + tmpNum                        If tmpNum &lt; 10 Then                If tjDict.Exists("10") Then                    tmp = tjDict.Item("10")                    tjDict.Item("10") = tmp + 1                Else                    tjDict.Item("10") = 1                End If            ElseIf tmpNum &lt;= 30 Then                If tjDict.Exists("30") Then                    tmp = tjDict.Item("30")                    tjDict.Item("30") = tmp + 1                Else                    tjDict.Item("30") = 1                End If                        ElseIf tmpNum &lt;= 100 Then                If tjDict.Exists("100") Then                    tmp = tjDict.Item("100")                    tjDict.Item("100") = tmp + 1                Else                    tjDict.Item("100") = 1                End If            Else                If tjDict.Exists("100+") Then                    tmp = tjDict.Item("100+")                    tjDict.Item("100+") = tmp + 1                Else                    tjDict.Item("100+") = 1                End If            End If            ' 厂房面积（┫）            cfmj = Replace(objTable.Cell(7, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")            If InStr(cfmj, "/") &gt; 0 And InStr(cfmj, "┫") &gt; 0 Then                tmpNum = Replace(Split(cfmj, "/")(0), "┫", "")                Sheet3.Cells(rowNum, 3).Value = Replace(Split(cfmj, "/")(0), "┫", "")            Else                Sheet3.Cells(rowNum, 3).Value = "/"                tmpNum = 0            End If                        cfmjzs = cfmjzs + tmpNum                                    ' 仓库面积（┫）            ckmj = Replace(objTable.Cell(7, 4).Range.Text, Chr$(13) &amp; Chr$(7), "")            If InStr(ckmj, "/") &gt; 0 And InStr(ckmj, "┫") &gt; 0 Then                Sheet3.Cells(rowNum, 4).Value = Replace(Split(ckmj, "/")(0), "┫", "")                tmpNum = Replace(Split(ckmj, "/")(0), "┫", "")            Else                 Sheet3.Cells(rowNum, 4).Value = "/"                 tmpNum = 0            End If                        ckmjzs = ckmjzs + tmpNum                        ' 产值（万元）            cz = Replace(objTable.Cell(8, 4).Range.Text, Chr$(13) &amp; Chr$(7), "")                        If InStr(cz, "万") &gt; 0 Then                 Sheet3.Cells(rowNum, 5).Value = Replace(cz, "万", "")                 tmpNum = Replace(cz, "万", "")            Else                 Sheet3.Cells(rowNum, 5).Value = "/"                 tmpNum = 0            End If             czzs = czzs + tmpNum                          If tmpNum &lt; 100 Then                If tjDict.Exists("100-") Then                    tmp = tjDict.Item("100-")                    tjDict.Item("100-") = tmp + 1                Else                    tjDict.Item("100-") = 1                End If            ElseIf tmpNum &lt;= 500 Then                If tjDict.Exists("500") Then                    tmp = tjDict.Item("500")                    tjDict.Item("500") = tmp + 1                Else                    tjDict.Item("500") = 1                End If                        ElseIf tmpNum &lt;= 2000 Then                If tjDict.Exists("2000") Then                    tmp = tjDict.Item("2000")                    tjDict.Item("2000") = tmp + 1                Else                    tjDict.Item("2000") = 1                End If            Else                If tjDict.Exists("2000+") Then                    tmp = tjDict.Item("2000+")                    tjDict.Item("2000+") = tmp + 1                Else                    tjDict.Item("2000+") = 1                End If            End If              '****************保存word所需要的数据 end            ' 拆分内容            Set objTable2 = wordDoc.Tables(2)            allContent = Split(objTable2.Cell(21, 1).Range.Text, Chr(13))            startNum = Sheet2.Range("D65535").End(-4162).Row            isNeed = False            num = 1            Sheet2.Columns("A").ColumnWidth = 5.13            Sheet2.Columns("B").ColumnWidth = 12.5            For Each line1 In allContent                            If InStr(line1, "检查人员") &gt; 0 Then                    isNeed = False                End If                                If isNeed And Trim(line1) &lt;&gt; "" Then                                    Sheet2.Cells(startNum + 1, 4).HorizontalAlignment = 2 '设置水平对齐，1常规，2靠左，3居中，4靠右 5填充，6两端对齐，7跨列居中，8分散对齐                    Sheet2.Cells(startNum + 1, 4).VerticalAlignment = 2 '设置垂直对齐，1靠上，2居中，3靠下  4两端对齐，5分散对齐                    Sheet2.Cells(startNum + 1, 4).Font.Size = 10.5                    Sheet2.Cells(startNum + 1, 4).RowHeight = 29                    Sheet2.Cells(startNum + 1, 4).WrapText = True                                        If InStr(line1, num) &gt; 0 Then                        tmpStr = Split(line1, "、")(1)                        Sheet2.Cells(startNum + 1, 4).Value = num &amp; "." &amp; tmpStr                    Else                        Sheet2.Cells(startNum + 1, 4).Value = num &amp; "." &amp; line1                    End If                                                            Sheet2.Cells(startNum + 1, 1).Value = fileNum - 1                    Sheet2.Cells(startNum + 1, 1).HorizontalAlignment = 3                    Sheet2.Cells(startNum + 1, 1).VerticalAlignment = 2                                                            Sheet2.Cells(startNum + 1, 2).Value = Replace(Left(checkStr, Len(checkStr) - 1), ".", "/")                    Sheet2.Cells(startNum + 1, 2).HorizontalAlignment = 3                    Sheet2.Cells(startNum + 1, 2).VerticalAlignment = 2                                                                                Sheet2.Cells(startNum + 1, 5).WrapText = True                    Sheet2.Cells(startNum + 1, 5).Value = "以上问题立即整改。"                    Sheet2.Cells(startNum + 1, 3).Value = Replace(objTable.Cell(1, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")                                                            Sheet2.Cells(startNum + 1, 6).HorizontalAlignment = 3                    Sheet2.Cells(startNum + 1, 6).VerticalAlignment = 2                    Sheet2.Cells(startNum + 1, 6).Font.Size = 12                    Sheet2.Cells(startNum + 1, 6).Value = Replace(objTable.Cell(2, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")                                                            Sheet2.Cells(startNum + 1, 7).HorizontalAlignment = 3                    Sheet2.Cells(startNum + 1, 7).VerticalAlignment = 2                    Sheet2.Cells(startNum + 1, 7).Font.Size = 12                    Sheet2.Cells(startNum + 1, 7).Value = Replace(objTable.Cell(2, 4).Range.Text, Chr$(13) &amp; Chr$(7), "")                    startNum = startNum + 1                    num = num + 1                End If                                If InStr(line1, "主要问题") &gt; 0 Then                    isNeed = True                End If                            Next            beginNum = startNum - num + 2            Application.DisplayAlerts = False            Sheet2.Range(Sheet2.Cells(beginNum, 1), Sheet2.Cells(startNum, 1)).Merge            Sheet2.Range(Sheet2.Cells(beginNum, 2), Sheet2.Cells(startNum, 2)).Merge            Sheet2.Range(Sheet2.Cells(beginNum, 3), Sheet2.Cells(startNum, 3)).Merge            Sheet2.Range(Sheet2.Cells(beginNum, 5), Sheet2.Cells(startNum, 5)).Merge            Sheet2.Range(Sheet2.Cells(beginNum, 6), Sheet2.Cells(startNum, 6)).Merge            Sheet2.Range(Sheet2.Cells(beginNum, 7), Sheet2.Cells(startNum, 7)).Merge            Sheet2.Range(Sheet2.Cells(beginNum, 9), Sheet2.Cells(startNum, 9)).Merge            Application.DisplayAlerts = True            fileNum = fileNum + 1            Sheet2.Range("A:C").Font.Name = "宋体"            Sheet2.Range("A:C").Font.Size = 12            Sheet2.Range("A:C").Font.Bold = True                        ' 所有边实线            Sheet2.Range("A:I").Borders(1).LineStyle = 1            Sheet2.Range("A:I").Borders(2).LineStyle = 1            Sheet2.Range("A:I").Borders(3).LineStyle = 1            Sheet2.Range("A:I").Borders(4).LineStyle = 1                                     Sheet3.Cells(1, 1).Value = ygzrs            Sheet3.Cells(1, 2).Value = cfmjzs            Sheet3.Cells(1, 3).Value = ckmjzs            Sheet3.Cells(1, 4).Value = czzs                        Sheet3.Cells(2, 1).Value = fileNum - 2                                End If    NextErr_Handle:    Sheet3.Cells(1, 5).Value = tjDict.Item("100-")    Sheet3.Cells(1, 6).Value = tjDict.Item("500")    Sheet3.Cells(1, 7).Value = tjDict.Item("2000")    Sheet3.Cells(1, 8).Value = tjDict.Item("2000+")                Sheet3.Cells(1, 9).Value = tjDict.Item("10")    Sheet3.Cells(1, 10).Value = tjDict.Item("30")    Sheet3.Cells(1, 11).Value = tjDict.Item("100")    Sheet3.Cells(1, 12).Value = tjDict.Item("100+")                Sheet3.Cells(1, 13).Value = tjDict.Item("轻工")    Sheet3.Cells(1, 14).Value = tjDict.Item("建材")    Sheet3.Cells(1, 15).Value = tjDict.Item("机械")    Sheet3.Cells(1, 16).Value = tjDict.Item("物流")    Sheet3.Cells(1, 17).Value = tjDict.Item("危化")    wordDoc.Close False    wdapp.QuitEnd SubSub genWord()    On Error GoTo Err_Handle1    Dim ObjWD, ObjDOC    Set ObjWD = CreateObject("Word.application")    Set ObjDOC = ObjWD.Documents.Add        Set objSelection = ObjWD.Selection        ' 检查企业个数    jcqygs = Sheet3.Cells(2, 1).Value            ' 标题    objSelection.Font.Size = 24    objSelection.Font.Bold = False    objSelection.Font.Name = "黑体"    objSelection.ParagraphFormat.Alignment = 1    objSelection.TypeText ("xxxxxxxxxxxx6月底企业" &amp; Chr(13) &amp; Chr(10) &amp; "安全检查小结")    objSelection.TypeParagraph        '    objSelection.Font.Size = 14    objSelection.Font.Bold = True    objSelection.Font.Name = "宋体"    objSelection.ParagraphFormat.Alignment = 3    objSelection.TypeText ("xxxxxx：")    objSelection.TypeParagraph        objSelection.Font.Bold = False    objSelection.ParagraphFormat.FirstLineIndent = 28    objSelection.TypeText ("xxxxx成工业企业" &amp; jcqygs &amp; "xxxxxx小结如下：")    objSelection.TypeParagraph    objSelection.TypeParagraph        objSelection.Font.Bold = True    objSelection.ParagraphFormat.FirstLineIndent = 0    objSelection.TypeText ("一、xx重视，各项工展顺利")    objSelection.TypeParagraph        objSelection.Font.Bold = False    objSelection.ParagraphFormat.FirstLineIndent = 28    objSelection.TypeText ("xxxxxxxxxxxxxxxxxxxxxx")    objSelection.TypeParagraph    objSelection.TypeParagraph        objSelection.Font.Bold = True    objSelection.ParagraphFormat.FirstLineIndent = 0    objSelection.TypeText ("二、工作开xx要情况：")    objSelection.TypeParagraph        objSelection.Font.Bold = False    objSelection.ParagraphFormat.FirstLineIndent = 28    objSelection.TypeText ("xxxxxxxxxxxx")    objSelection.TypeParagraph    objSelection.TypeParagraph    objSelection.TypeParagraph        objSelection.EndKey 6        ObjWD.Selection.InsertBreak 2    objSelection.ParagraphFormat.FirstLineIndent = 0    objSelection.Font.Bold = True    objSelection.TypeText ("xxxxxxxxxx工业企业" &amp; jcqygs &amp; "家基本信息表：")    objSelection.TypeParagraph        rowNum = Sheet1.Range("A65535").End(-4162).Row        objSelection.ParagraphFormat.Alignment = 1    objSelection.Font.Size = 10        Dim objTable    ObjDOC.Tables.Add objSelection.Range, rowNum, 18    Set objTable = ObjDOC.Tables(1) '文档中的第一个表格        objTable.AutoFitBehavior 2        '*************表格样式    objTable.Range.Style = "网格型"    For i = 1 To 2        For j = 1 To 18            objTable.Cell(i, j).Range.Cells.VerticalAlignment = 1    '实现水平居中        Next    Next    objSelection.MoveDown 5, 1, 1    objSelection.Cells.Merge        For i = 0 To 7        objSelection.MoveRight 1, 1        objSelection.MoveDown 5, 1, 1        objSelection.Cells.Merge    Next    objSelection.MoveRight 1, 1    objSelection.MoveRight 1, 7, 1    objSelection.Cells.Merge        objSelection.MoveRight 1, 1    objSelection.MoveRight 1, 2, 1    objSelection.Cells.Merge        objTable.Cell(1, 1).Range.Text = "序号"    objTable.Cell(1, 2).Range.Text = "名称"    objTable.Cell(1, 3).Range.Text = "所属行业"    objTable.Cell(1, 4).Range.Text = "联系人"    objTable.Cell(1, 5).Range.Text = "联系电话"    objTable.Cell(1, 6).Range.Text = "员工人数"    objTable.Cell(1, 7).Range.Text = "厂房面积（┫）"    objTable.Cell(1, 8).Range.Text = "仓库面积（┫）"    objTable.Cell(1, 9).Range.Text = " 产值（万元）"    objTable.Cell(1, 10).Range.Text = "一般安全隐患"    objTable.Cell(1, 11).Range.Text = "重大安全隐患"    objTable.Cell(2, 10).Range.Text = "设备"    objTable.Cell(2, 11).Range.Text = "消防"    objTable.Cell(2, 12).Range.Text = "电气"    objTable.Cell(2, 13).Range.Text = "气瓶"    objTable.Cell(2, 14).Range.Text = "危化"    objTable.Cell(2, 15).Range.Text = "其他"    objTable.Cell(2, 16).Range.Text = "小计"    objTable.Cell(2, 17).Range.Text = "类型"    objTable.Cell(2, 18).Range.Text = "数量"        '**********填充数据    For i = 3 To rowNum        For j = 1 To 18            objTable.Cell(i, j).Range.Font.Size = 8            objTable.Cell(i, j).Range.Font.Bold = False            objTable.Cell(i, j).Range.Cells.VerticalAlignment = 1    '实现水平居中        Next        objTable.Cell(i, 1).Range.Text = Sheet1.Cells(i, 1).Value        objTable.Cell(i, 2).Range.Text = Sheet1.Cells(i, 2).Value        objTable.Cell(i, 3).Range.Text = Sheet3.Cells(i, 1).Value        objTable.Cell(i, 4).Range.Text = Sheet1.Cells(i, 3).Value        objTable.Cell(i, 5).Range.Text = Sheet1.Cells(i, 4).Value        objTable.Cell(i, 6).Range.Text = Sheet3.Cells(i, 2).Value        objTable.Cell(i, 7).Range.Text = Sheet3.Cells(i, 3).Value        objTable.Cell(i, 8).Range.Text = Sheet3.Cells(i, 4).Value        objTable.Cell(i, 9).Range.Text = Sheet3.Cells(i, 5).Value    Next        objTable.Rows.Add    For j = 1 To 18        objTable.Cell(rowNum + 1, j).Shading.BackgroundPatternColor = RGB(153, 136, 255)    Next        ' 表尾    objTable.Cell(rowNum + 1, 1).Range.Text = rowNum - 1    objTable.Cell(rowNum + 1, 2).Range.Text = "合计"    objTable.Cell(rowNum + 1, 3).Range.Text = ""    objTable.Cell(rowNum + 1, 4).Range.Text = ""    objTable.Cell(rowNum + 1, 5).Range.Text = ""    objTable.Cell(rowNum + 1, 6).Range.Text = Sheet3.Cells(1, 1).Value    objTable.Cell(rowNum + 1, 7).Range.Text = Sheet3.Cells(1, 2).Value    objTable.Cell(rowNum + 1, 8).Range.Text = Sheet3.Cells(1, 3).Value    objTable.Cell(rowNum + 1, 9).Range.Text = Sheet3.Cells(1, 4).Value    objTable.Cell(rowNum + 1, 10).Range.Text = 0    objTable.Cell(rowNum + 1, 11).Range.Text = 0    objSelection.EndKey 6    objSelection.ParagraphFormat.Alignment = 3    objSelection.Font.Size = 14    objSelection.Font.Bold = True        objSelection.TypeParagraph    objSelection.TypeText ("xxxxx底" &amp; jcqygs &amp; "家工业xxxxx情况x表：")    objSelection.TypeParagraph        objSelection.ParagraphFormat.Alignment = 1    objSelection.Font.Size = 10.5        Dim objTable1    ObjDOC.Tables.Add objSelection.Range, 4, 25    Set objTable1 = ObjDOC.Tables(2) '文档中的第二个表格        objTable1.AutoFitBehavior 2    objTable1.Range.Style = "网格型"    For i = 1 To 4        For j = 1 To 25            objTable1.Cell(i, j).Range.Cells.VerticalAlignment = 1    '实现水平居中        Next    Next    ' 合并单元格    objSelection.MoveDown 5, 1    objSelection.MoveDown 5, 1, 1    objSelection.Cells.Merge        objSelection.MoveUp 5, 1        objSelection.MoveRight 1, 1    objSelection.MoveRight 1, 6, 1    objSelection.Cells.Merge        objSelection.MoveRight 1, 1    objSelection.MoveDown 5, 1, 1    objSelection.Cells.Merge        objSelection.MoveRight 1, 1    objSelection.MoveDown 5, 1, 1    objSelection.Cells.Merge        objSelection.MoveRight 1, 1    objSelection.MoveRight 1, 5, 1    objSelection.Cells.Merge        objSelection.MoveRight 1, 1    objSelection.MoveRight 1, 5, 1    objSelection.Cells.Merge        objSelection.MoveRight 1, 1    objSelection.MoveRight 1, 6, 1    objSelection.Cells.Merge            objTable1.Cell(1, 1).Range.Text = "名称"    objTable1.Cell(1, 2).Range.Text = "现场一般安全隐患"    objTable1.Cell(1, 3).Range.Text = "重大生产安全隐患"    objTable1.Cell(1, 4).Range.Text = "小计"    objTable1.Cell(1, 5).Range.Text = "产值(万元）"    objTable1.Cell(1, 6).Range.Text = "员工人数"    objTable1.Cell(1, 7).Range.Text = "行业"            objTable1.Cell(2, 1).Range.Text = "工业企业"    objTable1.Cell(4, 1).Range.Text = "比例（%）"                objTable1.Cell(2, 2).Range.Text = "设备"    objTable1.Cell(2, 3).Range.Text = "消防"    objTable1.Cell(2, 4).Range.Text = "电路"    objTable1.Cell(2, 5).Range.Text = "气瓶"    objTable1.Cell(2, 6).Range.Text = "危化"    objTable1.Cell(2, 7).Range.Text = "其他"        objTable1.Cell(2, 10).Range.Text = "100以下"    objTable1.Cell(2, 11).Range.Text = "100-500"    objTable1.Cell(2, 12).Range.Text = "500-2000"    objTable1.Cell(2, 13).Range.Text = "2000以上"    objTable1.Cell(2, 14).Range.Text = "小计"        objTable1.Cell(2, 15).Range.Text = "10人以下"    objTable1.Cell(2, 16).Range.Text = "10-30人"    objTable1.Cell(2, 17).Range.Text = "30-100人"    objTable1.Cell(2, 18).Range.Text = "100人以上"    objTable1.Cell(2, 19).Range.Text = "小计"        objTable1.Cell(2, 20).Range.Text = "轻工"    objTable1.Cell(2, 21).Range.Text = "建材"    objTable1.Cell(2, 22).Range.Text = "机械"    objTable1.Cell(2, 23).Range.Text = "物流"    objTable1.Cell(2, 24).Range.Text = "危化"    objTable1.Cell(2, 25).Range.Text = "小计"    objTable1.Cell(3, 10).Range.Text = Sheet3.Cells(1, 5).Value    objTable1.Cell(3, 11).Range.Text = Sheet3.Cells(1, 6).Value    objTable1.Cell(3, 12).Range.Text = Sheet3.Cells(1, 7).Value    objTable1.Cell(3, 13).Range.Text = Sheet3.Cells(1, 8).Value    objTable1.Cell(3, 14).Range.Text = Sheet3.Cells(2, 1).Value        objTable1.Cell(4, 10).Range.Text = Round((Sheet3.Cells(1, 5).Value / Sheet3.Cells(2, 1).Value) * 100, 1)    objTable1.Cell(4, 11).Range.Text = Round((Sheet3.Cells(1, 6).Value / Sheet3.Cells(2, 1).Value) * 100, 1)    objTable1.Cell(4, 12).Range.Text = Round((Sheet3.Cells(1, 7).Value / Sheet3.Cells(2, 1).Value) * 100, 1)    objTable1.Cell(4, 13).Range.Text = Round((Sheet3.Cells(1, 8).Value / Sheet3.Cells(2, 1).Value) * 100, 1)    objTable1.Cell(4, 14).Range.Text = "100"        objTable1.Cell(3, 15).Range.Text = Sheet3.Cells(1, 9).Value    objTable1.Cell(3, 16).Range.Text = Sheet3.Cells(1, 10).Value    objTable1.Cell(3, 17).Range.Text = Sheet3.Cells(1, 11).Value    objTable1.Cell(3, 18).Range.Text = Sheet3.Cells(1, 12).Value    objTable1.Cell(3, 19).Range.Text = Sheet3.Cells(2, 1).Value        objTable1.Cell(4, 15).Range.Text = Round((Sheet3.Cells(1, 9).Value / Sheet3.Cells(2, 1).Value) * 100, 1)    objTable1.Cell(4, 16).Range.Text = Round((Sheet3.Cells(1, 10).Value / Sheet3.Cells(2, 1).Value) * 100, 1)    objTable1.Cell(4, 17).Range.Text = Round((Sheet3.Cells(1, 11).Value / Sheet3.Cells(2, 1).Value) * 100, 1)    objTable1.Cell(4, 18).Range.Text = Round((Sheet3.Cells(1, 12).Value / Sheet3.Cells(2, 1).Value) * 100, 1)    objTable1.Cell(4, 19).Range.Text = "100"            objTable1.Cell(3, 20).Range.Text = Sheet3.Cells(1, 13).Value    objTable1.Cell(3, 21).Range.Text = Sheet3.Cells(1, 14).Value    objTable1.Cell(3, 22).Range.Text = Sheet3.Cells(1, 15).Value    objTable1.Cell(3, 23).Range.Text = Sheet3.Cells(1, 16).Value    objTable1.Cell(3, 24).Range.Text = Sheet3.Cells(1, 17).Value    objTable1.Cell(3, 25).Range.Text = Sheet3.Cells(2, 1).Value        objTable1.Cell(4, 20).Range.Text = Round((Sheet3.Cells(1, 13).Value / Sheet3.Cells(2, 1).Value) * 100, 1)    objTable1.Cell(4, 21).Range.Text = Round((Sheet3.Cells(1, 14).Value / Sheet3.Cells(2, 1).Value) * 100, 1)    objTable1.Cell(4, 22).Range.Text = Round((Sheet3.Cells(1, 15).Value / Sheet3.Cells(2, 1).Value) * 100, 1)    objTable1.Cell(4, 23).Range.Text = Round((Sheet3.Cells(1, 16).Value / Sheet3.Cells(2, 1).Value) * 100, 1)    objTable1.Cell(4, 24).Range.Text = Round((Sheet3.Cells(1, 17).Value / Sheet3.Cells(2, 1).Value) * 100, 1)    objTable1.Cell(4, 25).Range.Text = "100"            objSelection.TypeParagraph    objSelection.EndKey 6        '继续插入一个分节符    objSelection.InsertBreak 2    '定位到中间的页面    objSelection.Move 8, -1    objSelection.PageSetup.Orientation = 1            objSelection.EndKey 6    objSelection.Font.Size = 14    objSelection.ParagraphFormat.Alignment = 3        objSelection.TypeText (jcqygs &amp; "kkkkkkkkkkkkk")    objSelection.TypeParagraph        objSelection.Font.Bold = False    objSelection.ParagraphFormat.FirstLineIndent = 28    objSelection.TypeText (jcqygs &amp; "家企业中，有3xxxxxx。")    objSelection.TypeParagraph    objSelection.TypeText ("xx问题x条：占全部xxxx点的11.8%，主要表现为：xxxxxxxx等。")    objSelection.TypeParagraph    objSelection.TypeParagraph        objSelection.ParagraphFormat.FirstLineIndent = 0    objSelection.TypeText ("xxxxx隐患")    objSelection.TypeParagraph    objSelection.TypeParagraph    objSelection.TypeParagraph    objSelection.TypeParagraph    objSelection.TypeParagraph    objSelection.TypeParagraph        objSelection.Font.Bold = True    objSelection.ParagraphFormat.FirstLineIndent = 0    objSelection.TypeText ("三、工作中xxxx的问题：")    objSelection.TypeParagraph        objSelection.Font.Bold = False    objSelection.ParagraphFormat.FirstLineIndent = 28    objSelection.TypeText ("1、部分企业xxxxx安全生产意识薄弱；")    objSelection.TypeParagraph    objSelection.TypeText ("2、在实xxxx不充分。")    objSelection.TypeParagraph    objSelection.TypeParagraph        objSelection.Font.Bold = True    objSelection.ParagraphFormat.FirstLineIndent = 0    objSelection.TypeText ("四、下一步xxxxx工作计划：")    objSelection.TypeParagraph        objSelection.Font.Bold = False    objSelection.ParagraphFormat.FirstLineIndent = 28    objSelection.TypeText ("xxx检查企xxx点如下：")    objSelection.TypeParagraph    objSelection.TypeText ("1、xx管构成重大xxxx整改；")    objSelection.TypeParagraph    objSelection.TypeText ("5、现场xxxx重大xxxx隐患")    objSelection.TypeParagraph    objSelection.TypeText ("6、现场xxxx按照xxxxx岗位的性质，合理xxxx相关xxxxx用品。")    objSelection.TypeParagraph            objSelection.Font.Bold = True    objSelection.ParagraphFormat.FirstLineIndent = 0    objSelection.TypeText ("五、下步工作计划：")    objSelection.TypeParagraph        objSelection.Font.Bold = False    objSelection.ParagraphFormat.FirstLineIndent = 28    objSelection.TypeText ("1、对于企xxxx帮助；")    objSelection.TypeParagraph    objSelection.TypeText ("2、及时xx后输出的xxxx、监管xxx早xxx、xxxx预防”；")    objSelection.TypeParagraph    objSelection.TypeText ("3、拟对xxx的xxxxx管控；")    objSelection.TypeParagraph    objSelection.TypeText ("4、建立或xxx作群。")    objSelection.TypeParagraph    objSelection.TypeParagraph    objSelection.TypeText ("后期我xxxxxxx更好。")    objSelection.TypeParagraph    objSelection.TypeParagraph        objSelection.ParagraphFormat.FirstLineIndent = 210    objSelection.TypeText ("xxxxx事务所")            currPath = Application.ActiveWorkbook.Path    ObjDOC.SaveAs (currPath &amp; "/企业安全检查小结.doc")Err_Handle1:    ObjDOC.Close False    ObjWD.QuitMsgBox "处理完成", vbOKOnly, "提醒"End Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-结语"><a href="#2-结语" class="headerlink" title="2.结语"></a>2.结语</h3><hr><p>脚本中不支持枚举值，需要找到对应的数值，可以参看<a href="https://docs.microsoft.com/zh-cn/office/vba/api/overview/word">微软的文档</a>。脚本写的比较乱，但是基本实现功能，后续可以优化一下。</p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vbs </tag>
            
            <tag> word </tag>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周末记事</title>
      <link href="dayshare210710.html"/>
      <url>dayshare210710.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>这周的打算是周六上午上课，下午和福宝宝出去玩水。周日去参加好同事兼好基友的婚礼。</p></blockquote><h3 id="0-亲子课"><a href="#0-亲子课" class="headerlink" title="0.亲子课"></a>0.亲子课</h3><hr><p>昨天晚上逛商场，买了亲子装。第二天咱就穿着亲子装来上亲子课了。一开始是一首儿歌的互动，还是挺好玩的。之前是家长在宝宝身上弄，现在换成宝宝在爸妈身上弄。接着就是游戏环节了，今天是苹果树和上次的拧螺丝，表现的还行吧。后面是音乐和大运动环节。玩的还是挺开心的。下面看看照片吧。</p><p><img src="/img/20210710/1.jpg" alt="儿歌互动"></p><p><img src="/img/20210710/2.jpg" alt="苹果树"></p><p><img src="/img/20210710/3.jpg" alt="棒棒糖鼓"></p><p>后面的大运动没拍，照片还是摘自妈妈的朋友圈。</p><h3 id="1-玩水"><a href="#1-玩水" class="headerlink" title="1.玩水"></a>1.玩水</h3><hr><p>下午约了福宝宝玩水，小家伙害怕玩水呢，后面把她抱到浅水的地方，慢慢的放下去，一会就适应了。但是玩水的地方还是不敢，只敢坐在那玩，玩了玩之后就去别的地方玩了，水估计是不喜欢了。</p><p><img src="/img/20210710/4.jpg" alt="小心翼翼的坐着"></p><p><img src="/img/20210710/5.jpg" alt="摇一摇"></p><p><img src="/img/20210710/6.jpg" alt="海洋球"></p><p><img src="/img/20210710/7.jpg" alt="我踩"></p><p><img src="/img/20210710/8.jpg" alt="一起玩沙子"></p><p><img src="/img/20210710/9.jpg" alt="一起玩沙子"></p><p>在上面玩的时间还是很长的，比较喜欢玩沙子。</p><h3 id="2-参加婚礼"><a href="#2-参加婚礼" class="headerlink" title="2.参加婚礼"></a>2.参加婚礼</h3><hr><p>之前妈妈像带彤宝去参加婚礼的，给她吃酒的小衣服都买好了。但是后来因为太远了，就没有带她去了。我们早上8点左右出发，中午吃了饭逗留了一会，回到家已经5点多了。在这边祝他们幸福美满，以后回南京一起玩耍。婚礼的的照片就不放了，我拍的太丑了。等以后有机会在晒晒我们一起玩耍的照片吧。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 朋友 </tag>
            
            <tag> 带娃 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>彤彤的小鱼缸</title>
      <link href="dayshare210709.html"/>
      <url>dayshare210709.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>之前买的鱼缸已经落灰很久了，彤宝正好一直嚷嚷着要小鱼，这不准备给她安排上。</p></blockquote><h3 id="0-买鱼"><a href="#0-买鱼" class="headerlink" title="0.买鱼"></a>0.买鱼</h3><hr><p>今天小鱼收到了，对比刚买鱼缸时候买的那家鱼，这家的鱼的包装真的是棒，到家一条没有死，而且活力十足。真的很赞，买了点热带鱼和螺，还买了点水草。装饰起来还是不错的。下图是我的购物清单，没啥讲究，就是瞎买的。</p><p><img src="/img/20210709/WechatIMG82.jpeg" alt="购物清单"></p><h3 id="1-养鱼"><a href="#1-养鱼" class="headerlink" title="1.养鱼"></a>1.养鱼</h3><hr><p>我一回家彤宝就问我小鱼回来没，我说在菜鸟驿站呢，然后就说要和我一起去拿小鱼。快递拿回来之后，彤宝着急的要拆快递，这个过程咱忙的没拍照片。三下五除二直接小鱼下水了，没有像之前一样预热一下。不过水提前晒了一天，应该还好。小鱼放进去游的非常的欢快，真的觉得这家的鱼不错，推荐！下面欣赏一下彤宝的鱼缸吧。</p><p>鱼缸里的装饰都是彤宝的小玩具给她放里面的，假山是之前买的。</p><p><img src="/img/20210709/1.jpg" alt="鱼缸成品"></p><p><img src="/img/20210709/2.jpg" alt="我看鱼"></p><p><img src="/img/20210709/3.jpg" alt="我还是看鱼"></p><p><img src="/img/20210709/4.jpg" alt="我想喂点鱼食"></p><p><img src="/img/20210709/5.jpg" alt="坐着看"></p><p><img src="/img/20210709/6.jpg" alt="还是坐着看"></p><p>上面的照片摘自妈妈的朋友圈，都是美化过的，比我之前的<a href="https://baike.baidu.com/item/%E7%94%9F%E5%9B%BE/22922743">生图</a>好的多。</p><h3 id="2-结语"><a href="#2-结语" class="headerlink" title="2.结语"></a>2.结语</h3><hr><p>小孩子还是比较容易满足的，但是你答应她的没有做到的，她会一直提醒你的。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 带娃 </tag>
            
            <tag> 鱼缸 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Server酱推送</title>
      <link href="wecomchan.html"/>
      <url>wecomchan.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>之前HA有企业微信的插件，试了试，还是挺好用的。但是最近群晖抽风了，所以想找个别的地方部署下能推送的东西。</p></blockquote><h3 id="0-发现"><a href="#0-发现" class="headerlink" title="0.发现"></a>0.发现</h3><hr><p>之前刷的华硕官改路由，增加了软件中心。看到了推送的<code>Server酱</code>，用的线上版的，可以直接用，但是需要绑定微信，当时就是觉得他要和微信绑定，才没用的。现在出来了企业微信版的<a href="https://sct.ftqq.com/">Server酱</a> ,这样就可以愉快的玩耍了。</p><h3 id="1-搭建"><a href="#1-搭建" class="headerlink" title="1.搭建"></a>1.搭建</h3><hr><blockquote><p>本项目是对 <a href="https://github.com/easychen/wecomchan">Wecom酱</a> 进行的扩展，可以通过企业微信 OpenAPI 向微信推送消息，实现微信消息提醒。</p><p>利用 <a href="https://cloud.tencent.com/product/scf">腾讯云云函数</a> ServerLess 的能力，以极低的费用（按量付费，且有大量免费额度）来完成部署</p><p>优点：</p><ul><li>便宜：说是免费也不过分</li><li>简单：不需要购买vps, 也不需要备案, 腾讯云速度有保障.</li><li>易搭建：一个可执行二进制文件加一个配置文件，直接上传至腾讯云函数控制面板即可，虽然使用 Golang 编写，但是搭建无需 Golang 环境</li><li>Serverless：无服务器，函数调用完资源会释放</li></ul></blockquote><p>之前博客用的<code>Twikoo</code>的时候用了腾讯云函数，所以就跟着教程搭了起来，还是很友好的。作者已经写的很详细了，搭建教程在<a href="https://github.com/easychen/wecomchan/tree/main/go-scf">这里</a>。</p><h3 id="2-使用"><a href="#2-使用" class="headerlink" title="2.使用"></a>2.使用</h3><hr><p>直接上链接 <a href="https://xxxxx.tencentcs.com/release/wecomchan?sendkey=uuuuuuu&amp;msg_type=text&amp;msg=hello">https://xxxxx.tencentcs.com/release/wecomchan?sendkey=uuuuuuu&amp;msg_type=text&amp;msg=hello</a> 就能推送到手机了。<br><img src="/img/20210707/888.png" alt="手机截屏"></p><h3 id="3-结语"><a href="#3-结语" class="headerlink" title="3.结语"></a>3.结语</h3><hr><p>有了这个，剩下的就看自己发挥了。</p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Server酱 </tag>
            
            <tag> 云函数 </tag>
            
            <tag> 推送 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周末时光</title>
      <link href="dayshare210703.html"/>
      <url>dayshare210703.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>星期天彤妈培训，所以可能我需要一个人带娃</p></blockquote><h3 id="0-亲子课"><a href="#0-亲子课" class="headerlink" title="0. 亲子课"></a>0. 亲子课</h3><hr><p>彤彤的头发比较长了，没有理发，妈妈给她买了夹子夹起来了。还是很不错的。</p><p><img src="/img/20210703/IMG_2257.jpg" alt="夹上夹子的漂亮宝宝"></p><p>今天的亲子课表现的一般，玩具玩一遍就不想再玩了，就想着和老师交换玩具。不过最后的大运动还是完成的挺好的。自己跨越障碍物。</p><p><img src="/img/20210703/IMG_2263.jpg" alt="认真的宝"></p><h3 id="1-周天单独带娃"><a href="#1-周天单独带娃" class="headerlink" title="1.周天单独带娃"></a>1.周天单独带娃</h3><hr><p>今天彤妈培训，就我一人带娃，不过彤宝还是很乖的。基本没操啥心。她奶奶过来的早，所以还算轻松。晚上好兄弟约我去吃小龙虾🦞。四点多的时候去接她妈妈，然后一起过去。好久没聚了，正好一起玩玩很开心。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 早教 </tag>
            
            <tag> 遛娃 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周日记事</title>
      <link href="dayshare210627.html"/>
      <url>dayshare210627.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>往常一样的生活，不一样的周末</p></blockquote><h3 id="0-在家时光"><a href="#0-在家时光" class="headerlink" title="0.在家时光"></a>0.在家时光</h3><hr><p>今天早上没有早教课，所以没有起的很早。不过也不是很晚，起来了之后他就不愿意睡了，正好早上也饿了，就推着她出去买点早餐吃吃。从街的这头一直吃到那头，哈哈，吃的还是挺饱的。回家之后就给她弄点吃的，带她玩玩准备给她休息，因为下午还有课要上。但是她就是不愿意睡，给她用地垫做了个盒子，在里面躲猫猫，玩的不亦乐乎。</p><p><video src="/img/20210627/12345.mp4" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><p>玩到中午十二点多才肯睡觉，到上课时间了还不肯醒，只能叫醒了去上课。</p><h3 id="1-早教时光"><a href="#1-早教时光" class="headerlink" title="1.早教时光"></a>1.早教时光</h3><hr><p>去上课的时候一开始不在状态，但是很快就进入状态了，今天的感统课没有拍照片，就全玩了。三个小孩里，彤彤完成的还是不错的。结束之后准备在这边找小伙伴玩的，可是小伙伴睡着了，正好外面下着大雨，只能在商场里逗留了。</p><p>后来发现妈妈拍了照片的，下面看看吧。</p><p><img src="/img/20210627/WechatIMG73.jpeg" alt="运送积木"></p><p><img src="/img/20210627/WechatIMG74.jpeg" alt="把积木送回家"></p><p><img src="/img/20210627/WechatIMG75.jpeg" alt="玩玩瑜伽球"></p><h3 id="2-商场时光"><a href="#2-商场时光" class="headerlink" title="2.商场时光"></a>2.商场时光</h3><hr><p>晚上没给彤宝做吃的，所以苦恼去哪里吃技能我们吃的饱吃的好，彤宝也一样。最后还是选择了海底捞。这次吸取了上次的经验和教训。准备点个四宫格，两个清水给她，然后在点两个锅底自己吃。清水锅就可以给她煮些东西，给她点了面条，虾还有鱼。还有送的蒸蛋，感觉吃的还是挺丰富的。不过这次虾没弄好，应该生的剥的，但是服务员煮熟了才剥，已经老掉了，而且虾线还没有剃干净。</p><p><img src="/img/20210627/WechatIMG72.jpeg" alt="先吃点小饼干"></p><p><img src="/img/20210627/IMG_2234.jpg" alt="正在烹饪中"></p><p><img src="/img/20210627/WechatIMG71.jpeg" alt="等待吃饭"></p><p><img src="/img/20210627/IMG_2236.jpg" alt="大口吃面"></p><p><img src="/img/20210627/IMG_2237.jpg" alt="大口吃面"></p><p><img src="/img/20210627/IMG_2238.jpg" alt="大口吃面"></p><p>吃完了之后去盒马逛了逛，一直要看那些水产品。都走不动路，看了很久。</p><h3 id="3-公园时光"><a href="#3-公园时光" class="headerlink" title="3.公园时光"></a>3.公园时光</h3><hr><p>小伙伴醒来了，约去公园玩。去的时候天已经黑了。但是好像人还是不见少，在里面逛了逛，里面的游乐场玩了下。下面看看照片吧。</p><p>两个爸爸抱着别人的小孩，还是很和谐的哦。</p><p><img src="/img/20210627/IMG_2239.jpg" alt="你抱我的，我抱你的"></p><p>哈哈，我一个人抱两个娃，好幸福。周末太不修边幅了，想想还是放个背影比较稳妥。</p><p><img src="/img/20210627/IMG_2240.jpg" alt="一起抱"></p><h3 id="4-结语"><a href="#4-结语" class="headerlink" title="4.结语"></a>4.结语</h3><hr><p>一个人带娃可能会累，但是很多人带娃可以很快乐很轻松。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 早教 </tag>
            
            <tag> 朋友 </tag>
            
            <tag> 带娃 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周六记事</title>
      <link href="dayshare210626.html"/>
      <url>dayshare210626.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>又是一个周末了，今天得上亲子课，早上没怎么睡好，所以起来情绪不是很高</p></blockquote><h3 id="0-之前的照片分享"><a href="#0-之前的照片分享" class="headerlink" title="0.之前的照片分享"></a>0.之前的照片分享</h3><hr><p>上个星期的她喜欢玩钻山洞，大家也看到了她玩的各种山洞，这不前几天又发明了新的山洞，不敢独享，还是和大家一起欣赏吧。</p><p><img src="/img/20210626/IMG_2193.jpg" alt="隔洞相望"></p><p>下面这个是她钻山洞的小视频，别提多开心了。</p><p><video src="/img/20210626/1.mp4" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><h3 id="1-亲子课"><a href="#1-亲子课" class="headerlink" title="1.亲子课"></a>1.亲子课</h3><hr><p>今天的亲子课没有上新的内容，都是复习前面的东西。因为这次没有老师的示范，所以相当于是一堂小测验。通过这节课，我发现彤宝完成之前的东西完成的非常好，颜色和动物的认知都还可以，手部的操作，除了小锤子使的不是很溜，其他都还好。下面就看些照片吧！</p><p><img src="/img/20210626/IMG_2201.jpg" alt="两指捏球"></p><p><img src="/img/20210626/IMG_2203.jpg" alt="敲打小飞人"></p><p><img src="/img/20210626/IMG_2204.jpg" alt="追泡泡"></p><h3 id="2-结语"><a href="#2-结语" class="headerlink" title="2.结语"></a>2.结语</h3><hr><p>现在的她越来越厉害了，前几天因为我的疏忽导致她脑袋上撞了两个大包，还有小膝盖上伤痕累累，下次好好注意。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 早教 </tag>
            
            <tag> 带娃 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周末记事</title>
      <link href="dayshare210619.html"/>
      <url>dayshare210619.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>又到了周末了，可以开心的玩耍了。</p></blockquote><h3 id="0-亲子课堂"><a href="#0-亲子课堂" class="headerlink" title="0.亲子课堂"></a>0.亲子课堂</h3><hr><p>今天没有起得很晚，按时去园区上课的。今天玩的是智慧盒和两指塞球，彤宝都完成的很好。大运动是小鱼游，就是拉着彩虹伞，让宝宝从三下”游过“。起初老师想让我帮忙拉着伞的，没想到彤宝不乐意，闹着不让爸爸弄。还是疼会心疼我的。哈哈哈哈！下面看看宝宝的照片吧。</p><p><img src="/img/20210619/0.jpg" alt="两指塞球"></p><p><img src="/img/20210619/1.jpg" alt="两指塞球"></p><p><img src="/img/20210619/2.jpg" alt="智慧盒"></p><p><img src="/img/20210619/3.jpg" alt="智慧盒"></p><p>今天的游戏全程没什么帮助，都是自己完成的，感觉她越来越厉害了。</p><h3 id="1-回家游戏"><a href="#1-回家游戏" class="headerlink" title="1.回家游戏"></a>1.回家游戏</h3><hr><p>回家之后，妈妈给彤宝弄虾滑吃，我就带着她玩，没事就给她做了点小玩具，和早教课上的功能差不多。第一个是让她把小球塞进杯子里，可以正着塞，也可以盖子扣过来塞。也可以用锤子把它锤下去。玩法自己探索啦。看看简单的小玩具吧！</p><p>上面用剪刀简单的剪几道口子，边缘记得把<code>尖角</code>减掉，防止划到手</p><p><img src="/img/20210619/4.jpg" alt="杯子玩具"></p><p><img src="/img/20210619/5.jpg" alt="杯子玩具"></p><p>第二个是想让她投篮，然后用杯子去接的，做的比较简易随便。玩玩还是可以的。</p><p><img src="/img/20210619/6.jpg" alt="投篮"></p><p>其实也不知道这个游戏锻炼个啥，反正玩点之前没玩过的总归没错的。</p><h3 id="2-结语"><a href="#2-结语" class="headerlink" title="2.结语"></a>2.结语</h3><hr><p>今天到这应该就结束了，以后有时间可以想想怎么带她玩！</p><hr><p><strong>20210626更新</strong></p><hr><p>之前上课的照片没放，现在补放一下子</p><p><img src="/img/20210619/11.jpg" alt="感统课照片"></p><p><img src="/img/20210619/12.jpg" alt="感统课照片"></p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 早教 </tag>
            
            <tag> 带娃 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Word合并工具</title>
      <link href="contactTool.html"/>
      <url>contactTool.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>帮好兄弟的朋友写的一个小工具，就是把Word中的表格合并到Excel中去</p></blockquote><p>下面是相关代码</p><pre><code class="vbScript">Sub main()     ' 清空表格    Sheet1.Range("A5:AP20").ClearContents    Set dirFSO = CreateObject("Scripting.FileSystemObject")    Set wdapp = CreateObject("Word.Application")        Set regEx = CreateObject("vbscript.regexp")    regEx.Pattern = "\d+"    regEx.IgnoreCase = True '设置是否区分大小写    regEx.Global = True '设置全程匹配    wdapp.Visible = False        fileNum = 4    ' 获得目录下所有的word文件    filePath = Sheet1.Cells(1, 2).Value    Set dirFiles = dirFSO.getfolder(filePath)    For Each file In dirFiles.Files        If dirFSO.getExtensionName(file.Path) = "doc" Or dirFSO.getExtensionName(file.Path) = "docx" Then            ' 打开word 获取内容            On Error GoTo Err_Handle            Set worddoc = wdapp.Documents.Open(file.Path)            Set objTable = worddoc.Tables(1)            rowNum = fileNum + 1            ' 序号            Sheet1.Cells(rowNum, 1).Value = fileNum - 3            ' 名称            Sheet1.Cells(rowNum, 2).Value = Replace(objTable.Cell(1, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")            ' 所属行业            Sheet1.Cells(rowNum, 3).Value = Replace(objTable.Cell(5, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")            ' 联系人            Sheet1.Cells(rowNum, 4).Value = Replace(objTable.Cell(3, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")            ' 联系电话            Sheet1.Cells(rowNum, 5).Value = Replace(objTable.Cell(3, 4).Range.Text, Chr$(13) &amp; Chr$(7), "")            ' 员工人数            ygrs = Replace(objTable.Cell(6, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")            Sheet1.Cells(rowNum, 6).Value = Replace(ygrs, "人", "")            ' 厂房面积（㎡）            cfmj = Replace(objTable.Cell(7, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")            If InStr(cfmj, "/") &gt; 0 Then                Sheet1.Cells(rowNum, 7).Value = Replace(Split(cfmj, "/")(0), "㎡", "")            Else                Sheet1.Cells(rowNum, 7).Value = "/"            End If            ' 仓库面积（㎡）            ckmj = Replace(objTable.Cell(7, 4).Range.Text, Chr$(13) &amp; Chr$(7), "")            If InStr(ckmj, "/") &gt; 0 Then                Sheet1.Cells(rowNum, 8).Value = Replace(Split(ckmj, "/")(0), "㎡", "")            Else                 Sheet1.Cells(rowNum, 8).Value = "/"            End If            ' 产值（万元）            cz = Replace(objTable.Cell(8, 4).Range.Text, Chr$(13) &amp; Chr$(7), "")                        If InStr(cz, "万") &gt; 0 Then                 Sheet1.Cells(rowNum, 9).Value = Replace(cz, "万", "")            Else                 Sheet1.Cells(rowNum, 9).Value = "/"            End If                                    '特种设备解析            tzsb = Replace(objTable.Cell(11, 2).Range.Text, Chr$(13) &amp; Chr$(7), "")            If tzsb = "" Then                tzsb = "  "            End If                                    numbers = 0            For i = 0 To UBound(Split(tzsb, "、"))                ' 提取数字                Set Matches = regEx.Execute(Split(tzsb, "、")(i))                numbers = ""                For Each Match In Matches                    numbers = numbers + Match.Value                Next                                If InStr(tzsb, "叉车") &gt; 0 Then                    Sheet1.Cells(rowNum, 10).Value = numbers                    Sheet1.Cells(rowNum, 11).Value = "/"                Else                    Sheet1.Cells(rowNum, 10).Value = "/"                    Sheet1.Cells(rowNum, 11).Value = "/"                End If                                If InStr(tzsb, "起重") &gt; 0 Then                    Sheet1.Cells(rowNum, 12).Value = numbers                    Sheet1.Cells(rowNum, 13).Value = "/"                Else                    Sheet1.Cells(rowNum, 12).Value = "/"                    Sheet1.Cells(rowNum, 13).Value = "/"                End If                                If InStr(tzsb, "电梯") &gt; 0 Then                    Sheet1.Cells(rowNum, 14).Value = numbers                    Sheet1.Cells(rowNum, 15).Value = "/"                Else                    Sheet1.Cells(rowNum, 14).Value = "/"                    Sheet1.Cells(rowNum, 15).Value = "/"                End If                                If InStr(tzsb, "锅炉") &gt; 0 Then                    Sheet1.Cells(rowNum, 16).Value = numbers                    Sheet1.Cells(rowNum, 17).Value = "/"                Else                    Sheet1.Cells(rowNum, 16).Value = "/"                    Sheet1.Cells(rowNum, 17).Value = "/"                End If                                If InStr(tzsb, "压力") &gt; 0 Then                    Sheet1.Cells(rowNum, 18).Value = Split(tzsb, "、")(i)                    Sheet1.Cells(rowNum, 19).Value = "/"                Else                    Sheet1.Cells(rowNum, 18).Value = "/"                    Sheet1.Cells(rowNum, 19).Value = "/"                End If            Next                        tzsbry = Replace(objTable.Cell(11, 4).Range.Text, Chr$(13) &amp; Chr$(7), "")                        If tzsbry = "" Then                tzsbry = "  "            End If                        numbers = 0            For i = 0 To UBound(Split(tzsbry, "、"))                ' 提取数字                Set Matches = regEx.Execute(Split(tzsbry, "、")(i))                numbers = ""                For Each Match In Matches                    numbers = numbers + Match.Value                Next                                If InStr(tzsbry, "电工") &gt; 0 Then                    Sheet1.Cells(rowNum, 20).Value = numbers                    Sheet1.Cells(rowNum, 21).Value = "/"                Else                    Sheet1.Cells(rowNum, 20).Value = "/"                    Sheet1.Cells(rowNum, 21).Value = "/"                End If                                If InStr(tzsbry, "焊工") &gt; 0 Then                    Sheet1.Cells(rowNum, 22).Value = numbers                    Sheet1.Cells(rowNum, 23).Value = "/"                Else                    Sheet1.Cells(rowNum, 22).Value = "/"                    Sheet1.Cells(rowNum, 23).Value = "/"                End If                                If InStr(tzsbry, "叉车工") &gt; 0 Then                    Sheet1.Cells(rowNum, 24).Value = numbers                    Sheet1.Cells(rowNum, 25).Value = "/"                Else                    Sheet1.Cells(rowNum, 24).Value = "/"                    Sheet1.Cells(rowNum, 25).Value = "/"                End If                                If InStr(tzsbry, "行车工") &gt; 0 Then                    Sheet1.Cells(rowNum, 26).Value = numbers                    Sheet1.Cells(rowNum, 27).Value = "/"                Else                    Sheet1.Cells(rowNum, 26).Value = "/"                    Sheet1.Cells(rowNum, 27).Value = "/"                End If                                If InStr(tzsbry, "司炉工") &gt; 0 Then                    Sheet1.Cells(rowNum, 28).Value = numbers                    Sheet1.Cells(rowNum, 29).Value = "/"                Else                    Sheet1.Cells(rowNum, 28).Value = "/"                    Sheet1.Cells(rowNum, 29).Value = "/"                End If                                                If InStr(tzsbry, "电梯操作工") &gt; 0 Then                    Sheet1.Cells(rowNum, 30).Value = numbers                    Sheet1.Cells(rowNum, 31).Value = "/"                Else                    Sheet1.Cells(rowNum, 30).Value = "/"                    Sheet1.Cells(rowNum, 31).Value = "/"                End If                                If InStr(tzsbry, "压力容器操作工") &gt; 0 Then                    Sheet1.Cells(rowNum, 32).Value = numbers                    Sheet1.Cells(rowNum, 33).Value = "/"                Else                    Sheet1.Cells(rowNum, 32).Value = "/"                    Sheet1.Cells(rowNum, 33).Value = "/"                End If            Next                        fileNum = fileNum + 1        End If    Next    MsgBox "处理完成", vbOKOnly, "星阳提醒"Err_Handle:    worddoc.Close False    wdapp.QuitEnd Sub</code></pre>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 工具 </tag>
            
            <tag> VBA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周末记事</title>
      <link href="dayshare210612.html"/>
      <url>dayshare210612.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>这次端午小长假，唯一遗憾的是周六得加班一天。但是我不在，妈妈会给宝贝拍很多的照片</p></blockquote><h3 id="0-早教＋游玩"><a href="#0-早教＋游玩" class="headerlink" title="0.早教＋游玩"></a>0.早教＋游玩</h3><hr><p>今天的课是妈妈陪宝宝去的，我只能通过照片来了解情况了，下面和我一起欣赏吧</p><p><video src="/img/20210612/0.mp4" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><p><video src="/img/20210612/1.mp4" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><p><video src="/img/20210612/2.mp4" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><p><img src="/img/20210612/3.jpeg" alt="专心玩"></p><p><img src="/img/20210612/5.jpeg" alt="看轮滑"></p><h3 id="1-结语"><a href="#1-结语" class="headerlink" title="1.结语"></a>1.结语</h3><hr><p>最近彤彤鼻子堵了，睡觉的时候会因为它咳嗽。还好精神状态不错，希望她快快好起来。</p><hr><p><strong>2021年06月19日 更新</strong></p><hr><blockquote><p>彤宝可以钻“山洞”了，不害怕了。</p></blockquote><h3 id="0-0初级山洞"><a href="#0-0初级山洞" class="headerlink" title="0.0初级山洞"></a>0.0初级山洞</h3><hr><p>早上起来之后，又没有什么特别的事情。就带她在床上玩玩。起先是玩的钻被子，玩的天黑和天亮。玩着玩着感觉可以更进阶一点，就想着用枕头和被子搭个”山洞”给她玩，这不一会儿的功夫就玩上了，发现她开始适应和喜欢这个东西了。要知道之前上课的时候她是拒绝的。现在她居然能够玩，而且还玩的很开心，这是我意料之外的。<br>但是玩着玩着发现了这”山洞”的漏洞，两边的”墙”并不是很坚固啊，总是塔下来。所以想着用之前买的小板子搭起来，发现还是太软，还是不行。所以准备升级一下装备，来了一个说走就走的购物。</p><h3 id="1-0中级山洞"><a href="#1-0中级山洞" class="headerlink" title="1.0中级山洞"></a>1.0中级山洞</h3><hr><p>去超时买了几个地垫，准备用地垫搭一个，一开始准备用它支撑的，后来发现这个太软了，撑不住。所以最后就想给它搞成个三角形的固定的”山洞”。<br><img src="/img/20210619/7.jpg" alt="山洞"><br>这个东西还是挺稳的，玩的不亦乐乎</p><p><video src="/img/20210619/10.mp4" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><h3 id="2-0上课实战"><a href="#2-0上课实战" class="headerlink" title="2.0上课实战"></a>2.0上课实战</h3><hr><p>早上玩过之后，下午的感统课也有相关的项目，一开始还是不能够接收，但是在引导后，还是能够很好的完成的。这是一次成功的引导，很棒，希望能够继续加油！<br>没能够拍到精彩的画面，只能看看别的了<br><img src="/img/20210619/9.jpg" alt="给松鼠老板喂水果"><br><img src="/img/20210619/8.jpg" alt="放好"></p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 早教 </tag>
            
            <tag> 遛娃 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>替换工具</title>
      <link href="replaceTool.html"/>
      <url>replaceTool.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>最近有个需求，需要替换配置文件中的一个字段，因为配置文件较多，所以想着写工具来做。</p></blockquote><p>一开始准备用批处理的，奈何需要替换的内容中有特殊字符，如果没有还是挺方便的。既然批处理不行就转战vba了。代码不复杂，就是记录下，以后可能有用</p><pre class="line-numbers language-vbscript" data-language="vbscript"><code class="language-vbscript">rootPath="NCBS/"resulePath="Result/"logPath="Run.log"oldStr= ""newStr=""Set logfso = CreateObject("Scripting.FileSystemObject")Set logfile = logfso.CreateTextFile(logpath,True)Set fso = CreateObject("Scripting.FileSystemObject")Set folders = fso.GetFlolder(rootPath) Set files = folders.filesnum=0startDate=Now()For Each file In filesIf instr(file.name,"_system_") &gt; 0 Thenlogfile.WriteLine("开始处理文件[" &amp; file.name &amp; "]")Set stream = fso.opentextfile(rootPath &amp; file.name,1)content =  stream.readall()stream.close()content= Replace(content,oldStr,newStr)Set stream = fso.CreateTextFile(resulePath &amp; file.name,True)stream.write(content)stream.close()num = num +1End IfNextendDate = Now()timeDiff=DateDiff("s",startDate,endDate)logfile.WriteLine("共处理[" &amp; num &amp; "]个文件，耗时[" &amp; timeDiff &amp;"]s")Set fso = NothingSet logfso = Nothing<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>到这里就结束了</p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VBA </tag>
            
            <tag> 批量替换 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>久违的感统课</title>
      <link href="dayshare210530.html"/>
      <url>dayshare210530.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>感统课已经缺席很久了，今天去连老师叫啥都记混了</p></blockquote><h3 id="0-感统课"><a href="#0-感统课" class="headerlink" title="0.感统课"></a>0.感统课</h3><hr><p>昨天出去玩太累了，早上就带她多睡了会，到早上10点左右才起床，起床后洗洗弄弄就准备去上感统课了。今天老师特意交代了要爸爸陪同，因为今天的课程会比较累。到了发现确实比较累，需要抱着她走跑跳，还是挺累的，这个环节就不展示照片了，毕竟累的都不想贴了。</p><p>这周的游戏环节是 3个垫子，走上去之后跳下来，接着过网格桥，然后顺着滑滑梯滑下来。走上搭的小桥，在桥上双手拍打气球，接着走过被彩虹伞盖住的小桥，就结束了。整个环节下来，发现彤彤现在还不会跳，不能够自己独立走小桥，需要有爸爸妈妈搀扶才行，然后过未知的被彩虹伞盖住的就直接放弃了。以后还是需要多多加强。不过走小桥的时候，在前面引导的时候还是能够自己去走的，有时候她可以，只是她不敢或者是家长不愿意放手。下面就欣赏下其中的照片吧。</p><p><img src="/img/20210530/0.jpg" alt="去上课的路上"></p><p>扶着走网格桥，笑的还是挺开心的，</p><p><img src="/img/20210530/1.jpg" alt="网格桥"></p><p>因为拒绝彩虹伞盖住，本想和她说爸爸在后面，让她勇敢些的，最后还是拒绝，没办法老师撤了，过了没有彩虹伞的</p><p><img src="/img/20210530/2.jpg" alt="爸爸在后面保护"></p><p>一开始让她抓住我的裤子，她还是可以放心大胆的走的，最后的时候，我尝试在前面引导她，让她来抓住我的手，发现她还是能够自己完成的。有时候还是要放开手，过分的保护可能会让她失去一些能力，但是也有可能会跌到更多次吧。在保证安全的前提下，还是需要让她自己去完成。</p><p><img src="/img/20210530/3.jpg" alt="放开手，自己走"></p><p>完成的还是可以的，游戏结束</p><p><img src="/img/20210530/4.jpg" alt="游戏结束"></p><p>上课结束后的放松</p><p><img src="/img/20210530/5.jpg" alt="放松一下"></p><h3 id="1-结语"><a href="#1-结语" class="headerlink" title="1.结语"></a>1.结语</h3><hr><p>孩子总需要独立成长，在保证安全的前提下，还是需要放手让她们去尝试，也许她会给你想不到的惊喜！！！</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 早教 </tag>
            
            <tag> 感统 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>红山动物园游记</title>
      <link href="dayshare210529.html"/>
      <url>dayshare210529.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>又到了每周的周末，哈哈，快乐的带娃生活开始了。这周得重拾早教课程，然后去红山动物园逛逛。</p></blockquote><h3 id="0-行程简介"><a href="#0-行程简介" class="headerlink" title="0.行程简介"></a>0.行程简介</h3><hr><p> 首先还是去亲子课，结束后去红山动物园。</p><h3 id="1-亲子课"><a href="#1-亲子课" class="headerlink" title="1.亲子课"></a>1.亲子课</h3><hr><p>好久没去上课了，刚刚开始还是有点放不开的。在家里做自我介绍能够很流利，但是在课上还是有那么点腼腆。但是听课还是很认真的。而且现在的指令感越来越强了，自我意识也越来越强。能够完成她想完成的指令。比以前也更加的能够耐住性子。今天老师授课的时候，虽然她的同学一直在不停的走动，但是她能够认真耐心的听完老师的讲解。</p><p><img src="/img/20210529/0.jpg" alt="认真的Girl"></p><p><img src="/img/20210529/1.jpg" alt="认真的两人"></p><p>这周的游戏是击打小飞人和小鱼嵌板，都是锻炼宝宝的手部控制，音乐环节是手摇铃。最后是大运动是跨过障碍运送水果。大运动环节还是有点薄弱，需要爸妈牵着，不能够自己放手去做，平衡性也得提高，后面得多跨跨。</p><p><img src="/img/20210529/2.jpg" alt="摇铃宝宝"></p><p>就这样，结束了今天的课程，准备奔赴动物园啦！</p><h3 id="2-动物园"><a href="#2-动物园" class="headerlink" title="2.动物园"></a>2.动物园</h3><hr><p>去动物园当然少不了约小伙伴了啊，这次还是和福宝宝一起去的。下了地铁，彤宝说要睡觉，就让她趴在我的肩膀上睡觉，福宝看到了也要睡觉，最后彤宝没睡，福宝宝睡着了。路上拍的抱娃的爸爸。同款小帽子，还是不错的哟。</p><p><img src="/img/20210529/3.jpg" alt="抱娃的爸爸"></p><p>接着福宝睡觉，彤宝就跟我们一起把饭给吃了。就在吃饭的时间，福宝妈妈想给咱们群聊想个名字，要求是有福又有彤，然后 <strong><code>有福彤享</code></strong> 就正式出道了。接下来就是逛动物园啦，今天看了很多动物，动物照片咱就不来了，来些宝宝的照片吧。</p><p>大象的护栏太高了，宝宝看不到，这不人肉增高就来了。</p><p><img src="/img/20210529/4.jpg" alt="扛着看大象"></p><p>两栖动物馆里，我在外面看东西，彤妈拍的 ”<code>一家四口</code>“</p><p><img src="/img/20210529/5.jpg" alt="”一家四口“"></p><p>快乐的时光总是短暂的，又到了说再见的时刻了。但是游客照还是得拍的啊，记录下，到此一游。两个宝宝笑得开心的。</p><p><img src="/img/20210529/6.jpg" alt="游客照"></p><p>乖乖的坐地铁回家咯。期待下一个快乐周末。</p><p><img src="/img/20210529/7.jpg" alt="乖宝宝"></p><h3 id="3-结语"><a href="#3-结语" class="headerlink" title="3.结语"></a>3.结语</h3><hr><p>希望  <strong><code>有福彤享</code></strong> 以后也能够  <strong><code>有福同享</code></strong> ， <strong><code>平安喜乐</code></strong></p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 遛娃 </tag>
            
            <tag> 动物园 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBlade初探</title>
      <link href="SpringBlade.html"/>
      <url>SpringBlade.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>SpringBlade 是一个由商业级项目升级优化而来的 SpringCloud 分布式微服务架构、SpringBoot单体式微服务架构并存的综合型项目，采用Java8 API重构了业务代码，完全遵循阿里巴巴编码规范。采用Spring Boot 2.4 、Spring Cloud 2020 、Mybatis 等核心技术，同时提供基于React和Vue的两个前端框架用于快速搭建企业级的SaaS多租户微服务平台。</p></blockquote><h3 id="0-环境搭建"><a href="#0-环境搭建" class="headerlink" title="0.环境搭建"></a>0.环境搭建</h3><hr><p>首先得有基础环境，这边就不讨论了，应该都能搞定。接着需要安装Nacos和Sentinel，可以参看它的开发手册。<a href="https://www.kancloud.cn/smallchill/blade/1482369">SpringBlade开发手册</a> <a href="https://www.kancloud.cn/smallchill/saber/1302049">Saber开发手册</a> 环境搭建的免费阅读，可以看看</p><p>这边使用的docker安装的，安装完成之后的界面如下：</p><p><img src="/img/20210525/0.png" alt="docker"></p><p><img src="/img/20210525/2.png" alt="Nacos"></p><p><img src="/img/20210525/1.png" alt="Sentinel"></p><h3 id="1-导入运行"><a href="#1-导入运行" class="headerlink" title="1.导入运行"></a>1.导入运行</h3><hr><p>将后端项目导入到<code>IntelliJ IDEA</code>，前端项目使用<code>Visual Studio Code</code> 打开。项目是从Nacos上取配置的，相关配置在<code>doc/nacos/blade.yaml</code>中，在Nacos上新建配置并发布，最后的结果如上图所示了。别忘记将自己的相关信息修改正确哈。接着开始启动应用了。</p><p><img src="/img/20210525/3.png" alt="后端应用启动"></p><p>使用<code>npm run serve</code>启动前端应用</p><p><img src="/img/20210525/4.png" alt="前端应用启动"></p><h3 id="2-相关信息展示"><a href="#2-相关信息展示" class="headerlink" title="2.相关信息展示"></a>2.相关信息展示</h3><hr><p>登录页面地址 <a href="http://localhost:1888/">http://localhost:1888/</a></p><p><img src="/img/20210525/cover.png" alt="登陆页面"></p><p>Sentinel页面地址 <a href="http://localhost:8858/#/dashboard/home">http://localhost:8858/#/dashboard/home</a> Nacos页面地址 <a href="http://localhost:8848/nacos">http://localhost:8848/nacos</a></p><p>接口文档地址 <a href="http://127.0.0.1:18000/doc.html">http://127.0.0.1:18000/doc.html</a></p><p><img src="/img/20210525/5.png" alt="接口文档页面"></p><h3 id="3-总结"><a href="#3-总结" class="headerlink" title="3.总结"></a>3.总结</h3><hr><p>环境搭建已经完毕，下面开始研究这个框架</p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBlade </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown工具</title>
      <link href="joplin.html"/>
      <url>joplin.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>最近想在手机上写写东西，想用MD记录下生活。目前在用的<code>Typora</code>没有移动端，所以想找找有没有别的可以使用的工具</p></blockquote><h3 id="0-简介"><a href="#0-简介" class="headerlink" title="0.简介"></a>0.简介</h3><hr><p>网络上有很多Markdown编辑器，各种评测都有，但是工具这种东西没有绝对的事情，所以很多还是要自己去感受。看了些评测之后决定下载<code>Joplin</code>试试水。<a href="https://joplinapp.org/">官网地址</a></p><h3 id="1-使用感受"><a href="#1-使用感受" class="headerlink" title="1.使用感受"></a>1.使用感受</h3><hr><p><code>Typora</code>是所见即所得，敲的东西能够立马帮你显现出来。而<code>Joplin</code>是采用预览的方式。都能马上看到成果，只是实现方式不同，看个人喜好了。<code>Joplin</code>貌似不能打开本地目录，在写博客的时候可能就比较麻烦。但是记录下生活的需要的东西还是很棒的，而且它还有同步功能，折腾了一下，还是挺好的。</p><h3 id="2-同步配置"><a href="#2-同步配置" class="headerlink" title="2.同步配置"></a>2.同步配置</h3><hr><ol start="0"><li>下载<code>WebDAV Server</code>套件，然后启动下，可以参看<a href="https://www.myxzy.com/sort/71.html">这个教程</a></li><li>创建相应的共享文件夹，目录名称为 <code>webdav/Joplin</code><br><img src="/img/20210524/0.png" alt="共享文件夹"></li><li>进行端口映射，把端口暴露到公网<br><img src="/img/20210524/1.png" alt="端口映射"></li><li>打开Joplin中的同步，配置相关参数<br><img src="/img/20210524/2.png" alt="同步配置"></li><li>大功告成，可以愉快的同步了<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3></li></ol><hr><p>很多东西还是得尝试才行，试过才知道好不好，适不适合。</p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
            <tag> Joplin </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>园博园游记</title>
      <link href="dayshare210522.html"/>
      <url>dayshare210522.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>彤妈的学校组织的活动，南京园博园一日游</p></blockquote><h3 id="0-行程简介"><a href="#0-行程简介" class="headerlink" title="0.行程简介"></a>0.行程简介</h3><hr><p>早上8:30集合，从学校出发去园博园，进去后自由活动，下午3点半集合回学校。</p><h3 id="1-游玩记录"><a href="#1-游玩记录" class="headerlink" title="1.游玩记录"></a>1.游玩记录</h3><hr><p>这次去没怎么拍照片，主要是景区里基本都是台阶<span class="github-emoji"><span>😂</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>,推车基本没法推，没法推只能抱着，然后就很累。所以园林就没咋看，找个地方给宝宝们吃吃饭，睡睡觉，一天就过去了。所以带小娃不适合来这样的景点，还不如找个公园，扎个帐篷来的好玩。</p><h3 id="2-照片欣赏"><a href="#2-照片欣赏" class="headerlink" title="2.照片欣赏"></a>2.照片欣赏</h3><hr><p>国际惯例，照片是少不了的，首先是出发前几个宝宝一起的合照，感觉这次去的都是带着小孩去玩的。</p><p><img src="img/20210522/0.jpeg" alt="宝宝集会"></p><p>在排队买票的时候，彤宝还是最喜欢挖挖土了，这次出来忘记给她带小铲子了，拿了我的身份证挖，最后拿了小勺子和她换才给我。</p><p><img src="img/20210522/1.jpeg" alt="挖挖土"></p><p>前面也说了，园林里都是台阶，逛了一个无锡馆之后再无动力，索性找个亭子坐下来给宝宝们吃点东西，休息休息。下面这个就是在亭子里拍的，还是蛮有感觉的哦</p><p><img src="img/20210522/2.jpeg" alt="福宝宝和彤宝宝"></p><p>吃完了之后时间也不早了，准备找找这里面的先锋书店和可口可乐的什么东东的，记不清了<span class="github-emoji"><span>😂</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> ，做了接驳车，到了小火车的轨道处，感觉风景不错，遂拍照留恋。</p><p><img src="img/20210522/3.jpeg" alt="宝宝们和妈妈们"></p><p>接着赶路去目的地，这时候宝宝们已经坚持不住了，纷纷开始睡觉模式，这时候也可以轻松轻松，找了个奶茶店休息休息。休息了一会，宝宝们也都醒了，继续玩耍了。下面就是可口可乐和先锋书店了</p><p><img src="img/20210522/4.jpeg" alt="彤宝"></p><p>福宝妈妈给两个宝宝作纪念的可乐</p><p><img src="img/20210522/5.jpeg" alt="可乐留恋"></p><p>最后先锋书店逛逛就结束了今天的行程了。</p><p><img src="img/20210522/6.jpeg" alt="先锋书店"></p><h3 id="3-总结"><a href="#3-总结" class="headerlink" title="3.总结"></a>3.总结</h3><hr><p>小宝宝出去玩还是建议不要去园林类的了，不好推车。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 遛娃 </tag>
            
            <tag> 园博园 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>教师分数登记助手</title>
      <link href="jszs.html"/>
      <url>jszs.html</url>
      
        <content type="html"><![CDATA[<h3 id="0-背景介绍"><a href="#0-背景介绍" class="headerlink" title="0.背景介绍"></a>0.背景介绍</h3><hr><p>这个是之前给老婆写的小工具，用来登记分数的，功能比较简单</p><h3 id="1-实现介绍"><a href="#1-实现介绍" class="headerlink" title="1.实现介绍"></a>1.实现介绍</h3><hr><p>在Excel中绘制一个按钮，然后把按钮绑定到指定的函数上就行。<code>记得启用宏</code></p><h3 id="2-代码展示"><a href="#2-代码展示" class="headerlink" title="2.代码展示"></a>2.代码展示</h3><hr><pre class="line-numbers language-vbscript" data-language="vbscript"><code class="language-vbscript">Sub recordScore()    stuscore = ""    danyuan = InputBox("请输需要录入的单元[请填写阿拉伯数字]", "提示")    danyan = 2 + danyuan    Do While stuscore &lt;&gt; "q"        stuscore = InputBox("请输入学号和成绩[以英文逗号分割],退出输入q", "提示")        If LCase(stuscore) = "q" Then            Exit Do        End If        If InStr(stuscore, ",") = 0 Then            MsgBox "输入的格式有误！", vbOKOnly, "提示"            Exit Sub        Else            arr = Split(stuscore, ",")            xh = arr(0)            cj = arr(1)            For j = 1 To Sheet1.[A65536].End(xlUp).Row                If CStr(Sheet1.Cells(j, 1).Value) = CStr(xh) Then                    Sheet1.Cells(j, danyan).Value = cj                    Exit For                End If            Next                End If    LoopEnd Sub<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>代码简单的，一看就明白</p><h3 id="3-使用截图"><a href="#3-使用截图" class="headerlink" title="3.使用截图"></a>3.使用截图</h3><hr><p><img src="/img/20210519/jietu.png" alt="截图"></p><h3 id="4-总结"><a href="#4-总结" class="headerlink" title="4.总结"></a>4.总结</h3><hr><p>其实生活中有很多的地方可以使用编程的，只是很多时候自己已经适应了这些劳动，不想去改变，觉得就这样就挺好的。所以写工具偷懒也是一种进步的方式。之前是，现在是，以后也会是。</p><h3 id="5-下载Excel"><a href="#5-下载Excel" class="headerlink" title="5.下载Excel"></a>5.下载Excel</h3><hr><p><a href="/download/%E6%95%99%E5%B8%88%E5%88%86%E6%95%B0%E7%99%BB%E8%AE%B0%E5%8A%A9%E6%89%8B.xlsm">点击下载</a> Excel</p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教师 </tag>
            
            <tag> Excel </tag>
            
            <tag> VBScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Grafana接入HA</title>
      <link href="grafana-image-renderer.html"/>
      <url>grafana-image-renderer.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>Grafana已经搭好了，想把他的图表接入到HA里，下面就看看如何接入的吧</p></blockquote><h3 id="0-尝试"><a href="#0-尝试" class="headerlink" title="0.尝试"></a>0.尝试</h3><hr><p>在论坛里逛逛逛，发现讲接入的不多，找到一篇 <a href="https://bbs.hassbian.com/forum.php?mod=viewthread&amp;tid=4185&amp;highlight=Grafana">HA历史记录和图表太慢,太丑?试试grafana吧</a> 这边他使用的都是老版的，所以之前的都参考不了，但是后面接入HA的思想还是可以考虑下的，用了camera，还是很巧妙的。按照他的图上，我始终找不到 <strong><code>Direct link rendered image</code></strong> 这个按钮。想试试直接贴URL地址看看是否可行，发现并不行。然后就开始多方查找了。</p><h3 id="1-实施"><a href="#1-实施" class="headerlink" title="1.实施"></a>1.实施</h3><hr><p>官网网上找了找，找到了 <a href="https://grafana.com/docs/grafana/latest/administration/image_rendering/">这个</a> 发现了这个东西就是帮助渲染图标成图片形式的。</p><p><img src="/img/20210509/jietu0.png" alt="网站截图"></p><p>这就是我要找的东西啊，于是开始干起来。</p><ol><li><p>下载 grafana-image-renderer 镜像，相关的环境变量介绍和配置在<a href="https://github.com/grafana/grafana-image-renderer/blob/master/docs/remote_rendering_using_docker.md">这里</a> </p></li><li><p>按照介绍配置一下环境变量</p></li><li><p>因为之前我们已经装好了 <code>Grafana</code> 所以还要改下它的变量，加上如下的配置</p><blockquote><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">GF_RENDERING_SERVER_URL: http://renderer:8081/renderGF_RENDERING_CALLBACK_URL: http://grafana:3000/GF_LOG_FILTERS: rendering:debug<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></blockquote></li><li><p>重启<code>Grafana</code>之后就能看到那个按钮了</p></li></ol><p><img src="/img/20210509/jietu1.png" alt="网站截图"></p><p>接着配置一下HA就行了，配置如下：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">camera</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> generic    <span class="token key atrule">name</span><span class="token punctuation">:</span> 名称    <span class="token key atrule">still_image_url</span><span class="token punctuation">:</span> <span class="token string">'链接地址'</span>    <span class="token key atrule">username</span><span class="token punctuation">:</span> 用户名    <span class="token key atrule">password</span><span class="token punctuation">:</span> 密码<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>接着在界面加一个图片实体就行了</p><p><img src="/img/20210509/jietu2.png" alt="网站截图"></p><h3 id="3-总结"><a href="#3-总结" class="headerlink" title="3.总结"></a>3.总结</h3><hr><p>凡事不要放弃，努力的去找，去学习，总会有收获的。</p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> grafana-image-renderer </tag>
            
            <tag> HA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>通过Grafana展示HA数据</title>
      <link href="grafana.html"/>
      <url>grafana.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>上次搞了下influxdb，能够成功采集到NAS的系统状态信息，在结尾说要将HA接入到其中，所以今天这篇博客咱们就来弄这个东西。</p></blockquote><h3 id="0-准备活动"><a href="#0-准备活动" class="headerlink" title="0.准备活动"></a>0.准备活动</h3><hr><p>之前安装的<code>influxdb</code>是最新的，网上的教程基本都是1.X版的，所以只能自己尝试。因为HA的版本也低了，不能是用2.0的，所以HA也得升级。HA升级就比较坑了，很多之前的插件都用不了了，还得一个个修复，不过升级后很多设备都可以通过集成来配置了，很方便。</p><p><img src="/img/20210507/jietu0.png" alt="更新后的HA"></p><h3 id="1-安装Grafana"><a href="#1-安装Grafana" class="headerlink" title="1.安装Grafana"></a>1.安装Grafana</h3><hr><p>这步就很简单，搜索grafana下载，并运行就行，没什么特殊的配置。</p><p><img src="/img/20210507/jietu1.png" alt="下载Grafana镜像"></p><h3 id="2-配置HA"><a href="#2-配置HA" class="headerlink" title="2.配置HA"></a>2.配置HA</h3><hr><p>在<code>configuration.yaml</code>中添加相关的配置</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">influxdb</span><span class="token punctuation">:</span>    <span class="token key atrule">api_version</span><span class="token punctuation">:</span> <span class="token number">2</span>    <span class="token key atrule">ssl</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>    <span class="token key atrule">host</span><span class="token punctuation">:</span> 192.168.xxx.xxx    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8086</span>    <span class="token key atrule">token</span><span class="token punctuation">:</span> XXXXXXX    <span class="token key atrule">organization</span><span class="token punctuation">:</span> freefitter.com    <span class="token key atrule">bucket</span><span class="token punctuation">:</span> home_assistant    <span class="token key atrule">tags</span><span class="token punctuation">:</span>        <span class="token key atrule">source</span><span class="token punctuation">:</span> HA    <span class="token key atrule">tags_attributes</span><span class="token punctuation">:</span>        <span class="token punctuation">-</span> HA    <span class="token key atrule">default_measurement</span><span class="token punctuation">:</span> units<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>token</code>从<code>influxdb</code>中获取，从Data -&gt; Tokens中获取</p><p><img src="/img/20210507/jietu2.png" alt="获取Token"></p><p>配置完成重启HA就能够把数据注入到influxdb了，使用前不要忘记创建bucket</p><p><img src="/img/20210507/jietu3.png" alt="创建Buckets"></p><p>配置完成之后就能够看到数据了，下面是挑了一个搞的图表。</p><p><img src="/img/20210507/jietu4.png" alt="网络速率图"></p><p>其实influxdb2是自带图表的，不过功能没有Grafana强大。</p><h3 id="3-配置Grafana"><a href="#3-配置Grafana" class="headerlink" title="3.配置Grafana"></a>3.配置Grafana</h3><hr><p>配置数据源，将相关信息填写进去即可，注意 <code>Query Language</code> 要选择 <code>Flux</code> 然后把Token啥的填填就Okay了。</p><p><img src="/img/20210507/jietu5.png" alt="配置数据源"></p><p><img src="/img/20210507/jietu6.png" alt="填写相关信息"></p><p>然后创建一个面板把数据展现出来就行了。搞了几个示例，后面慢慢弄吧</p><p><img src="/img/20210507/jietu7.png" alt="成果展示"></p><h3 id="4-总结"><a href="#4-总结" class="headerlink" title="4.总结"></a>4.总结</h3><hr><p>总的来说搞起来并不是很难，现在的工具做的越来越简单。花点时间去理解就行。很多细节还是得自己去了解的。</p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> homeassistant </tag>
            
            <tag> grafana </tag>
            
            <tag> influxdb2.0 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>五一小长假</title>
      <link href="tourist.html"/>
      <url>tourist.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>这次五一放5天，是个小长假，想着带宝宝出去逛逛。这不昨晚买了个旅游年卡，带小孩出去逛逛去。年卡是在 <strong><code>我的南京</code></strong> 上买的。带宝宝出去逛逛，年卡是一个不错的选择。</p></blockquote><h3 id="0-排计划"><a href="#0-排计划" class="headerlink" title="0.排计划"></a>0.排计划</h3><hr><p>刚刚买的年卡肯定得用起来，考虑到回家路线，所以选择了三个景点游玩，分别是 <strong>金牛湖</strong> <strong>雨发生态园</strong> <strong>红山森林动物园</strong> 这几个都是带小孩去玩的不错选择。</p><table><thead><tr><th align="left">日期</th><th>安排</th><th>天气</th><th>备注</th></tr></thead><tbody><tr><td align="left">五月一日</td><td>南京 -&gt; 老家</td><td>⛅️/☀️</td><td>中午老家休整，晚上吃饭</td></tr><tr><td align="left">五月二日</td><td>老家 -&gt; 金牛湖 -&gt; 南京</td><td>⛅️</td><td>吃个早午饭出发</td></tr><tr><td align="left">五月三日</td><td>雨发生态园</td><td>☀️/⛈</td><td>和福宝一起去，可晚上约饭</td></tr><tr><td align="left">五月四日</td><td>新冠疫苗接种 / 长江峰景 / 龙湖天街</td><td>⛈/⛅️</td><td>和小哥哥一起玩耍</td></tr><tr><td align="left">五月五日</td><td>红山森林动物园</td><td>☀️</td><td>休整收心</td></tr></tbody></table><h3 id="1-旅游照欣赏"><a href="#1-旅游照欣赏" class="headerlink" title="1.旅游照欣赏"></a>1.旅游照欣赏</h3><hr><p>照片后面贴，还在整理中……</p><h3 id="2-总结"><a href="#2-总结" class="headerlink" title="2.总结"></a>2.总结</h3><hr><p>出去玩还是得提前准备，夏天最好带足水和补给。</p><h3 id="3-年卡景点列表"><a href="#3-年卡景点列表" class="headerlink" title="3.年卡景点列表"></a>3.年卡景点列表</h3><hr><table><thead><tr><th>景点名称</th><th>不分年份 所有年卡可用</th><th>服务热线（025）</th></tr></thead><tbody><tr><td>明孝陵景区（含梅花山、梅花谷、孙权纪念馆等）<code>HOT</code></td><td>√</td><td>84446111</td></tr><tr><td>灵谷景区</td><td>√</td><td>84446111</td></tr><tr><td>音乐台</td><td>√</td><td>84446111</td></tr><tr><td>美龄宫</td><td>√</td><td>84431600</td></tr><tr><td>中山植物园(含南园)</td><td>周一闭馆</td><td>84347062</td></tr><tr><td>红山森林动物园<code>HOT</code></td><td>√</td><td>85620178</td></tr><tr><td>白马石刻公园</td><td>√</td><td>85408062</td></tr><tr><td>紫金山天文台</td><td>√</td><td>84347503</td></tr><tr><td>总统府（南京中国近代史遗址博物馆）<code>HOT</code></td><td>周一闭馆，不包括夜游</td><td>84578888</td></tr><tr><td>六朝博物馆</td><td>周一闭馆</td><td>52326032</td></tr><tr><td>毗卢寺景区</td><td>√</td><td>84405431</td></tr><tr><td>莫愁湖公园</td><td>√</td><td>86613724</td></tr><tr><td>瞻园（太平天国历史博物馆）<code>HOT</code></td><td>周一闭馆，不包括夜游</td><td>52201849</td></tr><tr><td>南京城墙景区（东水关至集庆门段 含中华门瓮城）<code>HOT</code></td><td>不包括夜游</td><td>83608359</td></tr><tr><td>南京城墙景区（中山门至光华东街段）</td><td>√</td><td>83217776</td></tr><tr><td>南京城墙景区（神策门至太平门段 含明城垣史博物馆）</td><td>不包括夜游</td><td>83608359</td></tr><tr><td>甘熙宅第（南京市民俗博物馆）<code>HOT</code></td><td>周一闭馆</td><td>52217104</td></tr><tr><td>阅江楼景区</td><td>√</td><td>58590298</td></tr><tr><td>珍珠泉风景区（含狮虎园）<code>HOT</code></td><td>√</td><td>58601545</td></tr><tr><td>珍珠泉名石艺术馆</td><td>√</td><td>58302699</td></tr><tr><td>明文化村（阳山碑材）（江宁区）</td><td>√</td><td>84111108</td></tr><tr><td>汤山古猿人洞（江宁区）</td><td>闭园升级改造中</td><td>84101828</td></tr><tr><td>江宁方山国家地质公园（江宁区）</td><td>周一闭馆</td><td>68720777</td></tr><tr><td>长江观音景区</td><td>√</td><td>83576343</td></tr><tr><td>燕子矶公园</td><td>√</td><td>85311337</td></tr><tr><td>达摩古洞景区（五马渡附近）</td><td>√</td><td>83576343</td></tr><tr><td>天生桥风景区（溧水区）</td><td>√</td><td>57225656</td></tr><tr><td>老山国家森林公园（浦口区）</td><td>√</td><td>58112708</td></tr><tr><td>金牛湖风景区（六合区）<code>HOT</code></td><td>√</td><td>57552888</td></tr><tr><td>大金山风景区（溧水区）</td><td>√</td><td>57493099</td></tr><tr><td>南京市博物馆（朝天宫）</td><td>周一闭馆</td><td>84466460</td></tr><tr><td>雨发生态园（浦口区）</td><td>√</td><td>52899999</td></tr><tr><td>万成生态园（浦口区）</td><td>√</td><td>58185888</td></tr><tr><td>国防教育馆（南京国防园内）</td><td>√</td><td>83313180</td></tr><tr><td>李剑晨艺术馆（清凉山公园内）</td><td>√</td><td>83728013</td></tr><tr><td>魏紫熙艺术馆（清凉山公园内）</td><td>√</td><td>83728013</td></tr><tr><td>龚贤纪念馆（清凉山公园内）</td><td>闭馆中，开放时间另行通知</td><td>83728013</td></tr><tr><td>大报恩寺遗址公园<code>HOT</code></td><td>(持卡参观时间：9:00-17:00,不包括夜游)(每月最后一周的周三闭园）</td><td>52009999</td></tr><tr><td>李香君故居（夫子庙景区内）</td><td>√</td><td>52249600</td></tr><tr><td>王导谢安纪念馆（夫子庙景区内）</td><td>√</td><td>86620852</td></tr><tr><td>宝船厂遗址公园</td><td>√</td><td>86227011</td></tr><tr><td>固城湖水慢城（高淳区）</td><td>√</td><td>68765015</td></tr><tr><td>江宁织造博物馆</td><td>周一闭馆</td><td>83416802</td></tr><tr><td>秦大士故居</td><td>√</td><td>86620852</td></tr><tr><td>芥子园（芥子园+惜抱轩）</td><td>周一闭馆</td><td>86227011</td></tr><tr><td>四方当代美术馆（浦口区）</td><td>周一闭馆</td><td>68765015</td></tr><tr><td>郭兴庄园2021</td><td>√</td><td>56210203</td></tr><tr><td>无想山景区2021</td><td>√</td><td>56205199</td></tr><tr><td>南京医用耗材国际博览馆2021</td><td>预计2021年5月初正式开馆</td><td>58262693、86275063</td></tr></tbody></table><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 游玩 </tag>
            
            <tag> 假期 </tag>
            
            <tag> 计划 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客更新记录</title>
      <link href="blogupdate.html"/>
      <url>blogupdate.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>这个博客写了有一段时间了，基础的功能都有了，现在想折腾折腾别的。所以开一篇，以后更新的内容都放在这里。</p></blockquote><h3 id="0-增加Twikoo"><a href="#0-增加Twikoo" class="headerlink" title="0.增加Twikoo"></a>0.增加Twikoo</h3><hr><p>之前一直没有评论功能，想加一个，看了里面有很多，但是很多都不好用，最后选择了<code>Twikoo</code>。 这个配置本来就有，就是需要安装下云函数。按照教程来就行，下面贴下教程的地址。 <a href="https://twikoo.js.org/quick-start.html">Twikoo 中文文档</a> </p><h3 id="1-代码托管至-vercel"><a href="#1-代码托管至-vercel" class="headerlink" title="1.代码托管至 vercel"></a>1.代码托管至 vercel</h3><hr><p>本来准备做博客的SEO的，因为GitHub反爬，所以有人提出了这个方案。然后就找了一下这个网站，发现很多同学都在这上面托管，访问速度也变快了。基于这个处罚，就开始搞了，现在的代码以及托管到 <code>vercel </code> l了。贴一个教程吧，网上一搜一大堆的。这是其中一个 <a href="https://blog.ahrisy.com/2020/08/20/%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E7%BD%91%E7%AB%99%EF%BC%882%EF%BC%89%EF%BC%9AGithub%E5%92%8CVercel%E5%BB%BA%E7%AB%99%E4%BB%A5%E5%8F%8A%E9%85%8D%E7%BD%AEDNS/">Github和Vercel建站以及配置DNS</a> 。解析这一块我把DNS换成了提供的，之前用GitHub Pages的时候配置了解析，我觉得得把她停掉，所以我停掉了，后面看看有没有影响。</p><h3 id="2-SEO"><a href="#2-SEO" class="headerlink" title="2.SEO"></a>2.SEO</h3><hr><p>这是一个长期的工作，找找教程慢慢来。目前加入百度收录，也加入了百度统计。</p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> blog </tag>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>想法记录</title>
      <link href="ideal210425.html"/>
      <url>ideal210425.html</url>
      
        <content type="html"><![CDATA[<h3 id="0-想法的来源"><a href="#0-想法的来源" class="headerlink" title="0.想法的来源"></a>0.想法的来源</h3><hr><blockquote><p>在给宝宝上早教的路上，有很多教编程的机构，想着自己也是学这行的。能不能够自己编写一些东西教给自己的宝宝。</p></blockquote><p>没做过老师，目前也没有试听过此类课程，所以不知道怎么教小孩子，小孩子需要学什么，有什么可以教给他们。想自作主张写个教程教小朋友玩Scratch，这不想了一个教程的编写步骤，后面想根据这个步骤来写小孩子的教程。小年龄段的小孩还不能够打字，让他们现在开始编程显然不太合适。所以用小孩子的游戏作为素材，等长大后让他们能够把自己玩的游戏抽象到编程中去。因为他们自己玩过，所以其中的规则啥的都很清楚，不需要过多的解释需求。然后教给他们如何编写，让他们能够实现自己儿时玩的游戏。</p><h3 id="1-想法明细"><a href="#1-想法明细" class="headerlink" title="1.想法明细"></a>1.想法明细</h3><hr><p>下面的脑图是教程的编写的目录结构，想通过这个目录结构，能够让小孩子明白自己需要做什么，怎么做，这个做完了之后我还能做些什么。下面分解分解。</p><p>前提条件 得知道<code>你要做什么</code>，脑海里要有一个大致的映像，因为是做之前玩过的游戏，所以立体映像他们应该是有的。可以用画图的方式描述出你想做出来的游戏。</p><p>现在知道要做什么了，那<code>怎么实现我想做</code>的呢。需要把你要做的东西分解出来映射到程序中。具体就是这个游戏有几个角色，各个角色负责什么，这些角色的关系又是什么等等把这些理清了对后面编写会很有好处。可能很多角色还有不通的状态，在状态变更时，需要做哪些事情等等。</p><p>整理好了思路，就可以按照自己的思路开始编程了，知道每一个模块的意思是必须的。下面就是编程中的难点和后面的难度升级了。自己写的步骤，这个只是初版，后面编写边优化，感觉还有很多需要考虑的地方。</p><p><img src="/img/20210425/buzhou.png" alt="步骤脑图"></p><h3 id="2-总结"><a href="#2-总结" class="headerlink" title="2.总结"></a>2.总结</h3><hr><p>写了博客之后，感觉啥事都得记录，希望自己能够坚持写下去。</p>]]></content>
      
      
      <categories>
          
          <category> 想法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 儿童 </tag>
            
            <tag> 编程 </tag>
            
            <tag> 想法 </tag>
            
            <tag> scratch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周末记事</title>
      <link href="dayshare210424.html"/>
      <url>dayshare210424.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>因为五一小长假要补班，所以这周的周末只有短短的一天。虽然只有一天，但是彤彤的行程还是很满的。</p></blockquote><h3 id="0-行程简介"><a href="#0-行程简介" class="headerlink" title="0.行程简介"></a>0.行程简介</h3><hr><blockquote><ol><li><p><strong><code>上午</code></strong>   <strong><code>亲子课</code></strong></p></li><li><p><strong><code>下午</code></strong>   <strong><code>七田真体验课</code></strong></p></li></ol></blockquote><h3 id="1-亲子课"><a href="#1-亲子课" class="headerlink" title="1.亲子课"></a>1.亲子课</h3><hr><p>本周的亲子课的两个玩具是上周的色彩分类杯和碗，勺的使用。乐器是鼓，最后的大运动是瑜伽球。彤彤现在还是能够自己进行分类的，但是她有自己的思维，可能按照你的指令做了一会，就会按照她自己的想法来了。碗和勺的使用感觉她已经掌握了，能够把小馒头用勺子挖到自己的嘴里了。真的很棒。乐器感觉她不是很喜欢边走边敲。不过玩瑜伽球的时候她还是十分的开心的。说了这么多，还是看看图片吧。</p><p>妈妈老师一起看着她玩玩具</p><p><img src="/img/20210424/1.0.jpg" alt="一起玩颜色分类杯"></p><p>老师的本意是用勺子将小馒头从一个碗里挖到另外一个碗里，玩着玩着就变成了，从碗里到嘴里了。在这里让她和爸妈和老师分享食物时还是毫不吝啬的。</p><p><img src="/img/20210424/1.1.jpg" alt="用勺子挖小馒头"></p><p><img src="/img/20210424/1.2.jpg" alt="用勺子挖小馒头"></p><p><img src="/img/20210424/1.3.jpg" alt="用勺子挖小馒头"></p><p>开始音乐环节，边走边打鼓。</p><p><img src="/img/20210424/1.4.jpg" alt="打鼓宝宝"></p><p>接着是大运动的环节，就是用宝宝的身体去撞击瑜伽球。她玩的很开心，笑到模糊。</p><p><img src="/img/20210424/1.5.jpg" alt="撞撞撞"></p><h3 id="2-七田真体验课"><a href="#2-七田真体验课" class="headerlink" title="2.七田真体验课"></a>2.七田真体验课</h3><hr><p>约了下午3点的体验课，和福宝一起。这次上课是妈妈陪着她的，我只能看监控了。不过听说她上课还是很认真的，注意力也比较集中。这个早教机构主要是注重孩子的大脑开发和之前报的不是很一样，想给她报，但是觉得也不能报的太多。现在彤彤的语言还是发展的很好的，能够和你进行简单的对话，能够表达出她心理的想法，能够复述你的话。等这边的课上的差不多了再考虑吧。下面看看这两个小家伙上课时的情景吧。</p><p><img src="/img/20210424/1.6.jpg" alt="认真听课"></p><p><img src="/img/20210424/1.7.jpg" alt="认真听课"></p><h3 id="3-总结"><a href="#3-总结" class="headerlink" title="3.总结"></a>3.总结</h3><hr><p>现在孩子的教育大家还是挺重视的。我觉得报早教是一方面，最主要的还是爸妈的陪伴，回到家还是放下手机，一起陪她是最好的。现在彤妈值得表扬，虽然每天回来都有工作，但是都是等到彤彤睡着之后。早上看到爸爸的行为对孩子的影响很大，突然觉得自己身上压了个山，自己得实时注意自己的行为习惯。</p><h3 id="4-一些想法"><a href="#4-一些想法" class="headerlink" title="4.一些想法"></a>4.一些想法</h3><hr><p>后面准备把这些早教的小游戏用编程的方式实现出来，当做以后学习的素材。后面准备开始谢谢这类的教程，希望能给她后面用到。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 宝宝 </tag>
            
            <tag> 早教 </tag>
            
            <tag> 周末 </tag>
            
            <tag> 朋友 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>InfluxDB时序数据库</title>
      <link href="influxdb.html"/>
      <url>influxdb.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>InfluxDB使开发人员能够构建物联网，分析和监控软件。它专门用于处理传感器，应用程序和基础架构所产生的大量和无数个带有时间戳的数据源。之前看到论坛上有使用这个数据库接入HA的，所以想试试。</p></blockquote><h3 id="0-安装"><a href="#0-安装" class="headerlink" title="0.安装"></a>0.安装</h3><hr><p>我是在群晖docker上安装的 InfluxDB ，直接拉取，配置下启动即可。按照如下步骤操作即可</p><p><img src="/img/20210422/jietu0.png" alt="下载镜像"></p><p><img src="/img/20210422/jietu1.png" alt="启动配置"></p><p><img src="/img/20210422/jietu2.jpg" alt="启动配置"></p><p><img src="/img/20210422/jietu3.png" alt="启动配置"></p><p>启动完成后输入群晖的地址加上8086端口就能看到了，根据提示设置用户名密码等信息。</p><p><img src="/img/20210422/jietu4.png" alt="起始页"></p><h3 id="1-注入灵魂"><a href="#1-注入灵魂" class="headerlink" title="1.注入灵魂"></a>1.注入灵魂</h3><hr><p>数据库装好了，但是没数据，别担心，这就安排。使用 Telegraf 监控系统状态</p><blockquote><p>Telegraf 是收集和报告指标和数据的代理，是TICK Stack的一部分，是一个插件驱动的服务器代理，用于收集和报告指标。</p><p>Telegraf 集成了直接从其运行的容器和系统中提取各种指标，事件和日志，从第三方API提取指标，甚至通过StatsD和Kafka消费者服务监听指标。</p></blockquote><p>还是在docker里安装的 <strong>telegraf</strong> ，按照前面的步骤操作就行。就是配置 <strong>卷</strong> 的时候注意下 ，换成  <strong>docker/telegraf/telegraf.conf</strong>  |   <strong>/etc/telegraf/telegraf.conf</strong> 然后启动即可。</p><p>点击<strong>Load Data</strong> -&gt; <strong>Telegraf</strong>  -&gt; <strong>Create Configuration</strong></p><p><img src="/img/20210422/jietu5.png" alt="Telegraf配置"></p><p>选择System</p><p><img src="/img/20210422/jietu6.png" alt="选择System"></p><p>填写相关信息</p><p><img src="/img/20210422/jietu7.png" alt="填写相关信息"></p><p>配置完成， <strong><code>记录下这个页面的Token等相关信息</code></strong></p><p><img src="/img/20210422/jietu8.png" alt="配置完成"></p><p>接着点击 <strong><code>新建的标题</code></strong> 就能查看到相关的配置信息了</p><p><img src="/img/20210422/jietu9.png" alt="Telegraf配置信息"></p><p>直接把里面的内容贴到 <strong>docker/telegraf/telegraf.conf</strong> 中，重启 telegraf  即可，导出的配置如下：</p><pre class="line-numbers language-none"><code class="language-none"># Configuration for telegraf agent[agent]  ## Default data collection interval for all inputs  interval = "10s"  ## Rounds collection interval to 'interval'  ## ie, if interval="10s" then always collect on :00, :10, :20, etc.  round_interval = true  ## Telegraf will send metrics to outputs in batches of at most  ## metric_batch_size metrics.  ## This controls the size of writes that Telegraf sends to output plugins.  metric_batch_size = 1000  ## For failed writes, telegraf will cache metric_buffer_limit metrics for each  ## output, and will flush this buffer on a successful write. Oldest metrics  ## are dropped first when this buffer fills.  ## This buffer only fills when writes fail to output plugin(s).  metric_buffer_limit = 10000  ## Collection jitter is used to jitter the collection by a random amount.  ## Each plugin will sleep for a random time within jitter before collecting.  ## This can be used to avoid many plugins querying things like sysfs at the  ## same time, which can have a measurable effect on the system.  collection_jitter = "0s"  ## Default flushing interval for all outputs. Maximum flush_interval will be  ## flush_interval + flush_jitter  flush_interval = "10s"  ## Jitter the flush interval by a random amount. This is primarily to avoid  ## large write spikes for users running a large number of telegraf instances.  ## ie, a jitter of 5s and interval 10s means flushes will happen every 10-15s  flush_jitter = "0s"  ## By default or when set to "0s", precision will be set to the same  ## timestamp order as the collection interval, with the maximum being 1s.  ##   ie, when interval = "10s", precision will be "1s"  ##       when interval = "250ms", precision will be "1ms"  ## Precision will NOT be used for service inputs. It is up to each individual  ## service input to set the timestamp at the appropriate precision.  ## Valid time units are "ns", "us" (or "碌s"), "ms", "s".  precision = ""  ## Logging configuration:  ## Run telegraf with debug log messages.  debug = false  ## Run telegraf in quiet mode (error log messages only).  quiet = false  ## Specify the log file name. The empty string means to log to stderr.  logfile = ""  ## Override default hostname, if empty use os.Hostname()  hostname = ""  ## If set to true, do no set the "host" tag in the telegraf agent.  omit_hostname = false[[outputs.influxdb_v2]]  ## The URLs of the InfluxDB cluster nodes.  ##  ## Multiple URLs can be specified for a single cluster, only ONE of the  ## urls will be written to each interval.  ## urls exp: http://127.0.0.1:8086  urls = ["http://192.XXX.XX.XXX:8086"]  ## Token for authentication.  token = "XXXXXXXX"  ## Organization is the name of the organization you wish to write to; must exist.  organization = "QQQQQ.com"  ## Destination bucket to write into.  bucket = "qqqqq"[[inputs.cpu]]  ## Whether to report per-cpu stats or not  percpu = true  ## Whether to report total system cpu stats or not  totalcpu = true  ## If true, collect raw CPU time metrics.  collect_cpu_time = false  ## If true, compute and report the sum of all non-idle CPU states.  report_active = false[[inputs.disk]]  ## By default stats will be gathered for all mount points.  ## Set mount_points will restrict the stats to only the specified mount points.  # mount_points = ["/"]  ## Ignore mount points by filesystem type.  ignore_fs = ["tmpfs", "devtmpfs", "devfs", "overlay", "aufs", "squashfs"][[inputs.diskio]][[inputs.mem]][[inputs.net]][[inputs.processes]][[inputs.swap]][[inputs.system]]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-结果查看"><a href="#2-结果查看" class="headerlink" title="2.结果查看"></a>2.结果查看</h3><hr><p>到此配置结束了，去 <strong>Dashboards</strong> 页签就能看到采集到的数据图表信息了。</p><p><img src="/img/20210422/cover.jpg" alt="系统状态"></p><h3 id="3-总结"><a href="#3-总结" class="headerlink" title="3.总结"></a>3.总结</h3><hr><p>后面准备把HA的数据也推送过来，看看效果。</p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> InfluxDB </tag>
            
            <tag> 时序数据库 </tag>
            
            <tag> telegraf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESB流控分析</title>
      <link href="esbflow.html"/>
      <url>esbflow.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>最近有被问到现在产品的流控实现机制，之前知道得并不详细，这次准备翻翻代码，看看到底是如何实现的。下面就一探它的庐山正面目。</p></blockquote><h3 id="0-简介"><a href="#0-简介" class="headerlink" title="0.简介"></a>0.简介</h3><hr><p>流控是可以一起部署或者分机器部署的，故可分为本地流控和流控服务器，可以通过开关决定使用哪个。在交易进来后，会去申请流控，如果超过设置的流控阈值就会报错，拒绝交易，达到流量控制的目的。</p><h3 id="1-实现逻辑"><a href="#1-实现逻辑" class="headerlink" title="1.实现逻辑"></a>1.实现逻辑</h3><hr><p>在适配流程中配置了流控的基础服务，当交易进来后。先检查是否是使用的本地流控，如果不是检查流控服务器是否正常，如果不正常这走本地流控，如果正常则去申请流控，如果申请出现异常也从本地流控走。</p><p>流控配置在数据库中存储，在重启时加载。可根据多个维度设置，目前常用的是调用方，交易码。当然也有按照年月日等等维度设置的。根据设置的流控阈值创建相应个数的token放入list的中。</p><p>去取流控时根据如下规则取出令牌</p><blockquote><ol><li>精确查询是否存在 <strong><code>调用方</code></strong> <strong><code>交易码</code></strong> 配置</li><li>查询 <strong><code>ALL</code></strong>  <strong><code>交易码</code></strong> 配置是否存在</li><li>查询 <strong><code>调用方</code></strong> <strong><code>ALL</code></strong> 配置是否存在</li><li>查询 <strong><code>ALL</code></strong> <strong><code>ALL</code></strong> 配置是否存在</li></ol></blockquote><p>如果拿不到就表示超出流量控制了。</p><h3 id="3-调用脑图"><a href="#3-调用脑图" class="headerlink" title="3.调用脑图"></a>3.调用脑图</h3><hr><p><img src="/img/20210421/esbflow.png" alt="esb脑图"></p>]]></content>
      
      
      <categories>
          
          <category> 工作 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ESB </tag>
            
            <tag> 流控 </tag>
            
            <tag> 学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周末记事</title>
      <link href="dayshare210418.html"/>
      <url>dayshare210418.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>时间过的真快，转眼又到了愉快的周末。这周末没有特别的计划，就是家附近逛逛了。<span class="github-emoji"><span>⚠</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/26a0.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><strong>多图预警</strong> <span class="github-emoji"><span>⚠</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/26a0.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p></blockquote><h3 id="0-实际行程"><a href="#0-实际行程" class="headerlink" title="0.实际行程"></a>0.实际行程</h3><hr><blockquote><p> <strong>周六</strong></p><ol><li>亲子课</li><li>走走赛</li><li>彤，福两宝会晤</li></ol></blockquote><blockquote><p><strong>周日</strong></p><ol><li>我与泡泡</li><li>感统课</li><li>接着遛娃</li></ol></blockquote><h3 id="1-亲子课"><a href="#1-亲子课" class="headerlink" title="1.亲子课"></a>1.亲子课</h3><hr><p>这周的亲子课主要套杯和颜色分类杯，主要锻炼宝宝认知大小和颜色分类配对的能力。下面是图片欣赏时间，分别是颜色分类杯，套杯，沙锤以及和老师的合影。</p><p><img src="/img/20210418/1.0.jpg" alt="颜色分类杯"></p><p><img src="/img/20210418/1.1.jpg" alt="套杯"></p><p><img src="/img/20210418/1.2.jpg" alt="沙锤"></p><p><img src="/img/20210418/1.3.jpg" alt="合影"></p><h3 id="2-走走赛"><a href="#2-走走赛" class="headerlink" title="2.走走赛"></a>2.走走赛</h3><hr><p>上完课之后，得回家休息休息，吃个午饭，下午还得参加走走赛呢。估计是上午玩得太累了，快到出发的点还没醒，只能叫醒她了。下午约了福宝一起参加走走赛的，但福宝来的晚些，排到彤彤了，就先自己先参赛了。比赛规则很简单，起点出发走到终点，抱起地上的奶粉罐回头交给爸妈就行。下面是她参赛的照片，表情还是很赞的。</p><p><img src="/img/20210418/1.4.jpg" alt="赛前准备">  </p><p><img src="/img/20210418/1.5.jpg" alt="这个表情太赞了">  </p><h3 id="3-彤，福会晤"><a href="#3-彤，福会晤" class="headerlink" title="3.彤，福会晤"></a>3.彤，福会晤</h3><hr><p>彤宝比赛结束后，福宝来了。等福宝比赛结束后，拿了比赛的礼品之后来个合照。接下来准备和小伙伴出去逛逛，出去之后看到小的喷泉，要留下来玩会。感觉小孩子对水没有抵抗力啊。</p><p><img src="/img/20210418/1.7.jpg" alt="彤宝和福宝"></p><p><img src="/img/20210418/1.6.jpg" alt="玩喷泉"></p><h3 id="4-我与泡泡"><a href="#4-我与泡泡" class="headerlink" title="4.我与泡泡"></a>4.我与泡泡</h3><hr><p>感统课在下午，早上时间还是挺富足的。准备带着彤宝出去买个早餐顺便逛逛，玩玩她的泡泡机。</p><p><img src="/img/20210418/2.0.jpg" alt="泡泡机"></p><p><img src="/img/20210418/2.1.jpg" alt="泡泡机"></p><h3 id="5-感统课"><a href="#5-感统课" class="headerlink" title="5.感统课"></a>5.感统课</h3><hr><p>吃完午饭，休息一会之后就要去上感统课了，这次的游戏还是有些难度的。因为走得迟些，彤妈先过去了，我去停车了。过去之后发现第一个游戏是要举着彤彤，我到的时候彤妈直呼举不动 <span class="github-emoji"><span>😄</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 。下面是彤彤的课上表现，还是很棒的，并且今天能够自己做自我介绍了，虽然他在家已经能够很好的说出来了，但是在课上一直不想说，今天是一个很大的突破，虽然我没有看到。</p><p><img src="/img/20210418/2.2.jpg" alt="滑滑梯"></p><p><img src="/img/20210418/2.3.jpg" alt="还想要贴纸"></p><h3 id="6-接着遛娃"><a href="#6-接着遛娃" class="headerlink" title="6.接着遛娃"></a>6.接着遛娃</h3><hr><p>课程结束后，准备带宝宝买个裤子，就逛了逛，不知不觉就已经很晚了。准备在商场吃个晚饭就回去了，彤宝看到小火车了，坐了趟小火车。</p><p><img src="/img/20210418/2.4.jpg" alt="等小火车的彤宝"></p><h3 id="7-总结"><a href="#7-总结" class="headerlink" title="7.总结"></a>7.总结</h3><hr><p>这个周末依然充实，两个人带娃，虽然累，但是很快乐。哈哈哈</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 宝宝 </tag>
            
            <tag> 早教 </tag>
            
            <tag> 周末 </tag>
            
            <tag> 朋友 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ESP32-Camera初探</title>
      <link href="esp32cam.html"/>
      <url>esp32cam.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>接触智能家居时间也不少了，写的东西都是偏软件的。所以想突破下尝试玩玩硬件。但是一直不知道搞什么，一次偶然的机会，发现了人家制作的ESP32-Camera，来了兴趣，就开始找资料，准备开始干。</p></blockquote><h3 id="0-材料准备"><a href="#0-材料准备" class="headerlink" title="0.材料准备"></a>0.材料准备</h3><hr><p>折腾硬件首先得有硬件，这是得找万能的某宝了。买了个板子和USB-TTL加起来三十块钱左右，性价比还是刚刚的。</p><blockquote><ol><li><p>ESP32-Cam开发板</p></li><li><p>USB转TTL</p></li><li><p>杜邦线若干</p></li></ol></blockquote><p> 我买的第一家的ESP32-Cam但是收到后引脚没有焊好，导致后面刷固件死活刷不进去。后面重新买了这家的<a href="https://detail.tmall.com/item.htm?spm=a230r.1.14.36.3d91b3514xTMwM&amp;id=616162319808&amp;ns=1&amp;abbucket=4&amp;skuId=4604638375622">ESP32-Cam</a>，然后就Okay了</p><p><img src="/img/20210416/jietu0.jpg" alt="买到的ESP32-Cam"></p><h3 id="1-环境准备"><a href="#1-环境准备" class="headerlink" title="1.环境准备"></a>1.环境准备</h3><hr><p>a) <strong>驱动安装</strong></p><p>刷固件首先都要装上驱动，我用的CP2102的，网上找了驱动，进入 <a href="https://cn.silabs.com/">MAC驱动下载地址</a> 进去搜索即可，装上就行。windows会自动安装，不用操心。</p><p>接着下载</p><p>b) <strong>Arduino环境配置</strong></p><p>去<a href="https://www.arduino.cc/en/software">官网</a>下载Arduino，选择合适的平台下载</p><p><img src="/img/20210416/jietu0.png" alt="Arduino网站截图"></p><p>接下来照着这个<a href="https://blog.csdn.net/weixin_45825635/article/details/106081995">教程</a>配置一下Arduino</p><h3 id="2-接线烧录"><a href="#2-接线烧录" class="headerlink" title="2.接线烧录"></a>2.接线烧录</h3><hr><p>按照之前教程上的图接线，下面这是我连好后的，烧录的时候一定要记得<strong>IO0和GND短接</strong></p><p><img src="/img/20210416/jietu1.jpg" alt="实际接线图"></p><p>烧录完成运行的时候发现它贼烫手，所以找了个散热片给它贴上了。</p><h3 id="3-总结"><a href="#3-总结" class="headerlink" title="3.总结"></a>3.总结</h3><hr><p>上面的教程已经很详细了，我就不多多赘述了，后面想用它做点别的东西，到时候再分享给大家哈。</p>]]></content>
      
      
      <categories>
          
          <category> 智能家居 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 硬件 </tag>
            
            <tag> esp32cam </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>南京儿童医保缴费发票打印</title>
      <link href="etax.html"/>
      <url>etax.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>在我的南京上给宝宝缴了社保，但是没有发票怎么办，别担心，下面就带你们去了解下。</p></blockquote><h3 id="0-第一步"><a href="#0-第一步" class="headerlink" title="0.第一步"></a>0.第一步</h3><hr><p>打开 <a href="https://etax.jiangsu.chinatax.gov.cn/sso/login">国家税务总局江苏省电子税务局</a> 的网站，然后点击 有下方的 <strong>公众服务</strong>[下方红框标注的]</p><p><img src="/img/20210415/jietu0.png" alt="网站截图"></p><p>在下一个页面的侧边栏找到<strong>社保费缴费凭证打印</strong>[下方红框标注的] </p><p><img src="/img/20210415/jietu1.png" alt="网站截图"></p><p>当然也可以省略前面的步骤，直接单击 <a href="https://etax.jiangsu.chinatax.gov.cn:4433/zrr/templates/dzswj/sbf/sbfjnpz/sbfdzpzdy_new.jsp">江苏社保缴费凭证查询</a>如下图：</p><p><img src="/img/20210415/jietu2.png" alt="网站截图"></p><h3 id="1-第二步"><a href="#1-第二步" class="headerlink" title="1.第二步"></a>1.第二步</h3><hr><p>填写相关信息，点击提交即可，在跳转的页面中选择你要查询的日期，找到后点击打印即可</p><p><img src="/img/20210415/jietu3.png" alt="网站截图"></p><h3 id="2-总结"><a href="#2-总结" class="headerlink" title="2.总结"></a>2.总结</h3><hr><p>记录下来，以备以后查询。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 发票打印 </tag>
            
            <tag> 医保 </tag>
            
            <tag> 儿童 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>闲置的手机可以这样玩</title>
      <link href="mobile.html"/>
      <url>mobile.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>现在的家里，谁还没有几个旧手机啊，可是旧手机用吧，不想用，扔了吧又可惜。换不锈钢脸盆吧，又怕信息泄露。今天咱就把这个闲置的手机利用其起来。</p></blockquote><h3 id="0-准备工作"><a href="#0-准备工作" class="headerlink" title="0.准备工作"></a>0.准备工作</h3><hr><p>首先得下载个软件，名字叫 <strong>IP 摄像头</strong> 找找，应该挺多的。我用的是下面图标的软件</p><p><img src="/img/20210414/tubiao.png" alt="软件图标"></p><p>我用的是免费版的，监控是够了。</p><p><img src="/img/20210414/jietu0.jpg" alt="软件截图"></p><p>打开软件，点击下方的打开IP摄像头服务器就行了，在新的页面上有浏览的地址，在浏览上输入地址就能够看到图像了。</p><h3 id="1-接入HA"><a href="#1-接入HA" class="headerlink" title="1.接入HA"></a>1.接入HA</h3><hr><p>接入HA很简单，照着下面配置一下就行，信息在打开服务器后会在下方显示的。用提供的信息填写完整就行。用户名密码是自己设的。</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">android_ip_webcam</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> 手机的IP地址    <span class="token key atrule">port</span><span class="token punctuation">:</span> 端口    <span class="token key atrule">name</span><span class="token punctuation">:</span> IPCam0    <span class="token key atrule">username</span><span class="token punctuation">:</span> 用户名    <span class="token key atrule">password</span><span class="token punctuation">:</span> 密码<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>重启一下HA，在页面上添加一下这个传感器。如果要实现实时预览，可以使用 picture-entity 这个卡片，设置如下</p><p><img src="/img/20210414/jietu1.png" alt="软件截图"></p><p>记得要选上live哦，到此HA接入完毕</p><h3 id="2-接入HB"><a href="#2-接入HB" class="headerlink" title="2.接入HB"></a>2.接入HB</h3><hr><p>我在群晖上用docker搭了个HB，所以自然也想接入他，接入之后就可以使用苹果的家庭查看录像了。搭建HB的教程网上有的，这里就不介绍了。说一下我当时接入的坑吧。我的HB搭建的有点早了，nodejs的版本还很低的，导致我装插件装了半天都不行，换了好几个平台都没用，后面拉了一个新的镜像就行了，所以建议大家还是拉取最新的镜像吧。这是<a href="https://www.npmjs.com/package/homebridge-ip-camera">插件的介绍页</a>大家可以参考着配置和安装。给大家看看我的配置</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">{</span>         <span class="token property">"platform"</span><span class="token operator">:</span> <span class="token string">"Camera-IP"</span><span class="token punctuation">,</span>         <span class="token property">"cameras"</span><span class="token operator">:</span> <span class="token punctuation">[</span>            <span class="token punctuation">{</span>               <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"My Camera"</span><span class="token punctuation">,</span>               <span class="token property">"videoConfig"</span><span class="token operator">:</span> <span class="token punctuation">{</span>                   <span class="token property">"source"</span><span class="token operator">:</span> <span class="token string">"-re -i http://username:password@IP:PORT"</span><span class="token punctuation">,</span>                   <span class="token property">"maxStreams"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>                   <span class="token property">"maxWidth"</span><span class="token operator">:</span> <span class="token number">1280</span><span class="token punctuation">,</span>                   <span class="token property">"maxHeight"</span><span class="token operator">:</span> <span class="token number">720</span><span class="token punctuation">,</span>                   <span class="token property">"maxFPS"</span><span class="token operator">:</span> <span class="token number">60</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token punctuation">,</span>            <span class="token punctuation">{</span>               <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"My Camera0"</span><span class="token punctuation">,</span>               <span class="token property">"videoConfig"</span><span class="token operator">:</span> <span class="token punctuation">{</span>                   <span class="token property">"source"</span><span class="token operator">:</span> <span class="token string">"-re -i http://username:password@IP:PORT"</span><span class="token punctuation">,</span>                   <span class="token property">"maxStreams"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>                   <span class="token property">"maxWidth"</span><span class="token operator">:</span> <span class="token number">1280</span><span class="token punctuation">,</span>                   <span class="token property">"maxHeight"</span><span class="token operator">:</span> <span class="token number">720</span><span class="token punctuation">,</span>                   <span class="token property">"maxFPS"</span><span class="token operator">:</span> <span class="token number">60</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token punctuation">]</span>      <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>重启之后用苹果家庭添加新设备就行了。</p><p>看看接入后的效果：</p><p><img src="/img/20210414/jietu2.jpg" alt="接入截图"></p><h3 id="3-总结"><a href="#3-总结" class="headerlink" title="3.总结"></a>3.总结</h3><hr><p>如果要一直能看到的话，就得一直开着手机才行的。可能有点费电，但是手机还是发挥了他的余热。家里的已经做了内网穿透，HA可以外网访问，在其中的摄像头自然也可以外网访问了。HB的话需要家里有一个IPad，HomePod或者其他支持的设备作为家庭中枢，就可以在外面也可以访问了。还是很棒的。</p>]]></content>
      
      
      <categories>
          
          <category> 智能家居 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> homeassistant </tag>
            
            <tag> homebridge </tag>
            
            <tag> 摄像头 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HA中燃插件</title>
      <link href="gas.html"/>
      <url>gas.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>这是中燃的燃气插件，抓包后的api还是比较友好的</p></blockquote><h3 id="0-抓包"><a href="#0-抓包" class="headerlink" title="0.抓包"></a>0.抓包</h3><hr><p>按照国际惯例，首先抓包。从小程序入手，微信搜索 <strong>中燃慧生活</strong> 。然后打开抓包工具，开始抓包即可</p><h3 id="1-分析抓包数据"><a href="#1-分析抓包数据" class="headerlink" title="1.分析抓包数据"></a>1.分析抓包数据</h3><hr><p>中燃的接口还是挺友好的，都是json格式的。查看抓包的数据，找到这么一个地址 <strong><a href="https://zrds.zrhsh.com/controller/payfee/getcustomerMoneyListForMp.do">https://zrds.zrhsh.com/controller/payfee/getcustomerMoneyListForMp.do</a></strong> ，这个地址里面有咱想要的数据。数据咱就不贴了，都是看的到的。</p><h3 id="2-开发插件"><a href="#2-开发插件" class="headerlink" title="2.开发插件"></a>2.开发插件</h3><hr><p>分析数据，插件代码如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""Support for zhongran gas# Author:    freefitter# Created:    2020/9/2"""</span><span class="token keyword">import</span> logging<span class="token keyword">import</span> json<span class="token keyword">import</span> datetime<span class="token keyword">from</span> dateutil<span class="token punctuation">.</span>relativedelta <span class="token keyword">import</span> relativedelta <span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>const <span class="token keyword">import</span> <span class="token punctuation">(</span>    CONF_API_KEY<span class="token punctuation">,</span> CONF_NAME<span class="token punctuation">,</span> ATTR_ATTRIBUTION<span class="token punctuation">,</span> CONF_ID    <span class="token punctuation">)</span><span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>helpers<span class="token punctuation">.</span>entity <span class="token keyword">import</span> Entity<span class="token keyword">import</span> homeassistant<span class="token punctuation">.</span>helpers<span class="token punctuation">.</span>config_validation <span class="token keyword">as</span> cv<span class="token keyword">import</span> voluptuous <span class="token keyword">as</span> vol<span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>components<span class="token punctuation">.</span>sensor <span class="token keyword">import</span> PLATFORM_SCHEMA<span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup_Log<span class="token operator">=</span>logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>DEFAULT_NAME <span class="token operator">=</span> <span class="token string">'zrgas'</span>CUSTCODE <span class="token operator">=</span> <span class="token string">'custCode'</span>PLATFORM_SCHEMA <span class="token operator">=</span> PLATFORM_SCHEMA<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>    vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>CUSTCODE<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>    vol<span class="token punctuation">.</span>Optional<span class="token punctuation">(</span>CONF_NAME<span class="token punctuation">,</span> default<span class="token operator">=</span> DEFAULT_NAME<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>HEADERS <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">,</span>    <span class="token string">'Upgrade-Insecure-Requests'</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>    <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'</span><span class="token punctuation">,</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (iPhone; CPU iPhone OS 12_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 MicroMessenger/7.0.5(0x17000523) NetType/WIFI Language/zh_CN'</span><span class="token punctuation">}</span>API_URL <span class="token operator">=</span> <span class="token string">"https://zrds.zrhsh.com/controller/payfee/getcustomerMoneyListForMp.do"</span><span class="token keyword">def</span> <span class="token function">setup_platform</span><span class="token punctuation">(</span>hass<span class="token punctuation">,</span> config<span class="token punctuation">,</span> add_devices<span class="token punctuation">,</span> discovery_info<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    custCode <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>CUSTCODE<span class="token punctuation">)</span>    sensor_name <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>CONF_NAME<span class="token punctuation">)</span>    today <span class="token operator">=</span> datetime<span class="token punctuation">.</span>date<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span>    current_month <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span>today<span class="token punctuation">,</span> <span class="token string">"%Y%m"</span><span class="token punctuation">)</span>            last_2_month <span class="token operator">=</span> today <span class="token operator">+</span> relativedelta<span class="token punctuation">(</span>months<span class="token operator">=</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span>    last_two_month <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span>last_2_month<span class="token punctuation">,</span> <span class="token string">"%Y%m"</span><span class="token punctuation">)</span>        data_dict <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">'custCode'</span><span class="token punctuation">:</span> custCode<span class="token punctuation">,</span>        <span class="token string">'envir'</span><span class="token punctuation">:</span><span class="token string">'2'</span><span class="token punctuation">,</span>        <span class="token string">'startTime'</span><span class="token punctuation">:</span>last_two_month<span class="token punctuation">,</span>        <span class="token string">'endTime'</span><span class="token punctuation">:</span>current_month<span class="token punctuation">,</span>    <span class="token punctuation">}</span>    add_devices<span class="token punctuation">(</span><span class="token punctuation">[</span>ZRGas<span class="token punctuation">(</span>sensor_name<span class="token punctuation">,</span>data_dict<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">ZRGas</span><span class="token punctuation">(</span>Entity<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Representation of a Nanjing water """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>sensor_name<span class="token punctuation">,</span>data_dict<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>attributes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token boolean">None</span>        self<span class="token punctuation">.</span>_data_dict <span class="token operator">=</span> data_dict        self<span class="token punctuation">.</span>_name <span class="token operator">=</span> sensor_name    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the name of the sensor."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_name    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">state</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the state of the sensor."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_state    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">icon</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""返回mdi图标."""</span>        <span class="token keyword">return</span> <span class="token string">'mdi:fire'</span>    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">device_state_attributes</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the state attributes."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>attributes    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">unit_of_measurement</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the unit this state is expressed in."""</span>        <span class="token keyword">return</span> <span class="token string">"元"</span>    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>API_URL<span class="token punctuation">,</span>params<span class="token operator">=</span>self<span class="token punctuation">.</span>_data_dict<span class="token punctuation">,</span>headers <span class="token operator">=</span> HEADERS<span class="token punctuation">)</span>        <span class="token keyword">except</span> ReadTimeout<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Connection timeout...."</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> ConnectionError<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Connection Error...."</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> RequestException<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Unknown Error"</span><span class="token punctuation">)</span>        res <span class="token operator">=</span> response<span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>res<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"receivable"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'recordMonth'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"recordMonth"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'curRecord'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"curRecord"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'curQty'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"curQty"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'balance'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"balance"</span><span class="token punctuation">]</span>         self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'received'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"received"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'laterFee'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"laterFee"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'lastRecord'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"lastRecord"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'timeCurRecord'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"payGasCheckList"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"timeCurRecord"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-配置HA"><a href="#4-配置HA" class="headerlink" title="4.配置HA"></a>4.配置HA</h3><hr><p>插件需要客户号，上面抓包的请求就有，拿就完事了。接着照着下面配置就行。配置完成后，重启HA就行了</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> zrgas    <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'燃气费'</span>    <span class="token key atrule">custCode</span><span class="token punctuation">:</span> <span class="token string">'XXXXXXX'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="5-成果展示"><a href="#5-成果展示" class="headerlink" title="5.成果展示"></a>5.成果展示</h3><p><img src="/img/20210413/gas.jpg" alt="插件展示"></p><p>至此，家里的水电燃气已经接入完毕，后面再把其他的整理整理，分享出来。</p>]]></content>
      
      
      <categories>
          
          <category> 智能家居 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> homeassistant </tag>
            
            <tag> python </tag>
            
            <tag> 插件 </tag>
            
            <tag> 燃气 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>周末记事</title>
      <link href="dayshare210412.html"/>
      <url>dayshare210412.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>又是一个平常的周末，周末就该带娃，遛娃，多图和视频预警</p></blockquote><h3 id="0-第一天"><a href="#0-第一天" class="headerlink" title="0.第一天"></a>0.第一天</h3><p>周六是一节亲子课，9:00上课。忙忙弄弄还是迟到了一会。学习路线和往常一样，蒙氏线，然后是儿歌环节，接着是玩具的教学，最后一个大动作。这次玩具是套杯，让她感知大小。大动作是海洋球的投掷，就是将海洋球投掷过大圆环。</p><p>一开始的自我介绍，</p><p><img src="/img/20210412/1.0.jpg" alt="认真听课"></p><p>中间的玩具光陪她玩了，没拍照。大动作的时候拍了，感觉她不喜欢投掷，更喜欢大圆环本身<span class="github-emoji"><span>😂</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f602.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> </p><p><img src="/img/20210412/1.1.jpg" alt="爱玩大圆环"></p><p>上课结束后要去趟江南，开车实在是堵，也不好停车，所以就准备开车去。这是小家伙第二次坐地铁。感觉比第一次好很多了。地铁上有个大哥哥给我们让了座，坐下来的彤彤还是很乖的哦。</p><p><img src="/img/20210412/1.2.jpg" alt="坐地铁的彤彤"></p><p>到了之后，妈妈去看了彤彤外婆了，我负责在楼下带着她，一开始喝着果汁，还是很乖的，果汁喝完了之后就要下来跑。下来之后，她就是脱缰的野马，四处跑，我根本无暇顾及其他，小车放在一边。下面看看跑动的彤。人像模式没P，颜值很是能打的吧，<span class="github-emoji"><span>😆</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f606.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> </p><p><img src="/img/20210412/1.3.jpg" alt="跑动中的彤"></p><p>事情办完之后就去逛了逛商场。逛完之后也不早了，就在那边吃了个晚饭。下面看看神同步的眼神</p><p><img src="/img/20210412/1.4.jpg" alt="神同步"></p><p><img src="/img/20210412/1.5.jpg" alt="神同步"></p><p>今天玩得太晚了，回家澡都不愿意洗。</p><h3 id="1-第二天"><a href="#1-第二天" class="headerlink" title="1.第二天"></a>1.第二天</h3><p>周日是感统课，早上起来之后带她玩玩给他弄个午饭，睡个午觉就出发了。这次没迟到，早早到了。今天的感统课是锻炼手臂力量。还是套圈，走玻璃的斜坡，蹦床，之后就是爬滚筒。这次的感统课彤彤表现的都很好，很多能够自己独立完成。完成大游戏之后就是泡泡环节，希望他们能够用自己的一根手指头去接住泡泡，锻炼他们的五指分化能力。</p><p><img src="/img/20210412/2.0.jpg" alt="套圈的小姑娘"></p><p><img src="/img/20210412/2.1.jpg" alt="走玻璃"></p><p><img src="/img/20210412/2.2.jpg" alt="开心的泡泡环节"></p><p><img src="/img/20210412/2.3.jpg" alt="开心的泡泡环节"></p><p>下面是魔性的live抓泡泡</p><p><video src="/img/20210412/0.MOV" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><p><video src="/img/20210412/1.MOV" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><p><video src="/img/20210412/2.MOV" controls="controls" width="100%" muted="" autoplay="true" loop="loop"></video></p><h3 id="3-结语"><a href="#3-结语" class="headerlink" title="3.结语"></a>3.结语</h3><p>周末还是很充实的，彤彤现在越来越厉害了。不要一成不变，要变得更好。加油！</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 宝宝 </tag>
            
            <tag> 早教 </tag>
            
            <tag> 周末 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>收藏网站列表</title>
      <link href="urlLists.html"/>
      <url>urlLists.html</url>
      
        <content type="html"><![CDATA[<h3 id="0-素材类网址"><a href="#0-素材类网址" class="headerlink" title="0.素材类网址"></a>0.素材类网址</h3><ul><li><a href="https://www.pexels.com/zh-cn/">免费素材图片</a></li><li><a href="https://www.flaticon.com/">免费SVG图标</a></li><li><a href="http://tool.c7sky.com/webcolor/">网页设计常用色彩搭配表</a></li><li><a href="https://www.17sucai.com/">17素材网</a></li></ul><h3 id="1-工具类网站"><a href="#1-工具类网站" class="headerlink" title="1.工具类网站"></a>1.工具类网站</h3><ul><li><a href="http://www.bejson.com/jsoneditoronline/">JSON在线编辑器</a></li><li><a href="https://picsvg.com/">免费SVG转换</a></li><li><a href="http://playground.tensorflow.org/">神经网络</a></li><li><a href="http://patorjk.com/software/taag/#p=display&amp;f=Graffiti&amp;t=Type%20Something%20">SpringBoot banner生成工具 </a></li></ul><h3 id="2-免费API"><a href="#2-免费API" class="headerlink" title="2.免费API"></a>2.免费API</h3><ul><li><a href="http://zhwnlapi.etouch.cn/Ecalender/api/v2/weather?citykey=101190101">华风新天气API</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 备忘 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网址 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MQTT,Node-RED初探</title>
      <link href="mqttsensor.html"/>
      <url>mqttsensor.html</url>
      
        <content type="html"><![CDATA[<h3 id="0-简介"><a href="#0-简介" class="headerlink" title="0.简介"></a>0.简介</h3><hr><p>MQTT 简介</p><blockquote><p>MQTT(消息队列遥测传输)是ISO 标准(ISO/IEC PRF 20922)下基于发布/订阅范式的消息协议。它工作在 TCP/IP协议族上，是为硬件性能低下的远程设备以及网络状况糟糕的情况下而设计的发布/订阅型消息协议，为此，它需要一个消息中间件 。<br>MQTT是一个基于客户端-服务器的消息发布/订阅传输协议。MQTT协议是轻量、简单、开放和易于实现的，这些特点使它适用范围非常广泛。在很多情况下，包括受限的环境中，如：机器与机器（M2M）通信和物联网（IoT）。其在，通过卫星链路通信传感器、偶尔拨号的医疗设备、智能家居、及一些小型化设备中已广泛使用。</p></blockquote><p>Node-RED简介</p><blockquote><p>Node-RED是一款基于NodeJS的构建物联网应用程序的强大工具,其重点是简化代码块的“连接”以执行任务。它使用可视化编程方法，允许开发人员将预定义的代码块（称为“节点”，Node）连接起来执行任务。连接的节点，通常是输入节点、处理节点和输出节点的组合，当它们连接在一起时，构成一个“流”(Flows)。<br>Node-RED最初是IBM在2013年末开发的一个开源项目，以满足他们快速连接硬件和设备到Web服务和其他软件的需求——作为物联网的一种粘合剂，它很快发展成为一种通用的物联网编程工具。重要的是，Node-RED已经迅速形成一个重要的、不断增长的用户基础和一个活跃的开发人员社区，他们正在开发新的节点，同时允许程序员复用Node-RED代码来完成各种各样的任务。</p></blockquote><h3 id="1-配置HA中的MQTT"><a href="#1-配置HA中的MQTT" class="headerlink" title="1.配置HA中的MQTT"></a>1.配置HA中的MQTT</h3><hr><p>在 <strong>configuration.yaml</strong> 中配置如下内容：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">mqtt</span><span class="token punctuation">:</span>  <span class="token key atrule">discovery</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">discovery_prefix</span><span class="token punctuation">:</span> homeassistant  <span class="token key atrule">password</span><span class="token punctuation">:</span> XXXXXXX<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>具体配置可以参看 <a href="https://www.home-assistant.io/docs/mqtt/">官方文档</a> 。 重启HA就可以了。</p><h3 id="2-配置Node-RED"><a href="#2-配置Node-RED" class="headerlink" title="2.配置Node-RED"></a>2.配置Node-RED</h3><hr><p>自己安装下Node-Red。我是在群晖docker里面装的，<a href="https://registry.hub.docker.com/r/nodered/node-red-docker/">镜像说明</a> 是这个。这边是网上的<a href="https://www.feeus.com/%E7%BE%A4%E6%99%96%E4%BD%BF%E7%94%A8docker%E5%AE%89%E8%A3%85node-red/">安装教程</a>可以参照着安装</p><p>安装好了浏览器输入 <a href="http://192.168.xxx.xxx:1880/">http://192.168.XXX.XXX:1880/</a> 就可以看到界面了。</p><p><img src="/img/20210408/nodered.png" alt="Node-RED界面"></p><p>配置broker，输入MQTT的IP和端口，上面配置了密码，所以安全中要输入下</p><p><img src="/img/20210408/mqtt0.png" alt="MQTT配置"></p><p><img src="/img/20210408/mqtt1.png" alt="MQTT配置"></p><p>配置完了就可以使用了。</p><h3 id="3-给传感器注入灵魂"><a href="#3-给传感器注入灵魂" class="headerlink" title="3.给传感器注入灵魂"></a>3.给传感器注入灵魂</h3><hr><p>按照图示拖拽相关的节点</p><p><img src="/img/20210408/flow.jpg" alt="流"></p><p>下面以微博热搜为例</p><p><a href="https://s.weibo.com/ajax/jsonp/gettopsug?uid=&amp;ref=PC_topsug&amp;url=https://s.weibo.com/weibo/%2525E7%2525BC%252585%2525E7%252594%2525B8%2525E4%2525BB%2525B0%2525E5%252585%252589%2525E9%252583%2525A8%2525E5%252588%252586%2525E5%25259C%2525B0%2525E5%25258C%2525BA%2525E5%2525AE%25259E%2525E6%252596%2525BD%2525E5%252586%25259B%2525E4%2525BA%25258B%2525E7%2525AE%2525A1%2525E5%252588%2525B6?topnav=1&amp;wvr=6&amp;Refer=top_button&amp;Mozilla=Mozilla/5.0%20(Windows%20NT%2010.0;%20Win64;%20x64)%20AppleWebKit/537.36%20(KHTML,%20like%20Gecko)%20Chrome/89.0.4389.82%20Safari/537.36&amp;_cb=STK_16157756566583">热搜接口地址</a> 通过Get请求到相关数据。数据不是Json格式的，需要转化</p><p>转化方法如下：</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> respText <span class="token operator">=</span> msg<span class="token punctuation">.</span>payload<span class="token punctuation">;</span><span class="token keyword">var</span> str <span class="token operator">=</span> respText<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"try{window.STK_16157756566583&amp;STK_16157756566583("</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">")}catch(e){}"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>msg<span class="token punctuation">.</span>payload <span class="token operator">=</span> str<span class="token keyword">return</span> msg<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注册传感器数据如下：</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">msg<span class="token punctuation">.</span>payload <span class="token operator">=</span> <span class="token punctuation">{</span>    unique_id<span class="token operator">:</span> <span class="token string">"HA-sensor_wbhot"</span><span class="token punctuation">,</span>    name<span class="token operator">:</span> <span class="token string">"wbhot"</span><span class="token punctuation">,</span>    icon<span class="token operator">:</span> <span class="token string">"mdi:sina-weibo"</span><span class="token punctuation">,</span>    state_topic<span class="token operator">:</span> <span class="token string">"device20210312/sensor_wbhot/state"</span><span class="token punctuation">,</span>    json_attributes_topic<span class="token operator">:</span> <span class="token string">"device20210312/sensor_wbhot/attributes"</span><span class="token punctuation">,</span>    unit_of_measurement<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>    device<span class="token operator">:</span> <span class="token punctuation">{</span>        identifiers<span class="token operator">:</span> <span class="token string">"20210312"</span><span class="token punctuation">,</span>        manufacturer<span class="token operator">:</span> <span class="token string">"MQTT_Sensor"</span><span class="token punctuation">,</span>        model<span class="token operator">:</span> <span class="token string">"HA"</span><span class="token punctuation">,</span>        name<span class="token operator">:</span> <span class="token string">"微博热搜"</span><span class="token punctuation">,</span>        sw_version<span class="token operator">:</span> <span class="token string">"1.0"</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">return</span> msg<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注册状态数据如下：</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">note <span class="token operator">=</span> msg<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>data<span class="token punctuation">.</span>list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>notemsg<span class="token punctuation">.</span>payload <span class="token operator">=</span> note<span class="token keyword">return</span> msg<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>注册属性数据如下：</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> jsonArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">var</span> dataList <span class="token operator">=</span> msg<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>data<span class="token punctuation">.</span>list<span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>     <span class="token keyword">var</span> jsObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    jsObj<span class="token punctuation">.</span>name <span class="token operator">=</span> dataList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>note<span class="token punctuation">;</span>    jsObj<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token string">"https://s.weibo.com/weibo?q=%23"</span> <span class="token operator">+</span> dataList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>note <span class="token operator">+</span> <span class="token string">"%23&amp;Refer=top"</span><span class="token punctuation">;</span>    jsObj<span class="token punctuation">.</span>num <span class="token operator">=</span> dataList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>num    jsonArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>jsObj<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">var</span> retList <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>retList<span class="token punctuation">.</span>lists <span class="token operator">=</span> jsonArraymsg<span class="token punctuation">.</span>payload <span class="token operator">=</span> retList<span class="token punctuation">;</span><span class="token keyword">return</span> msg<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>属性数据用的是Json对象，以便后面展示用。当然也可以弄成字符串，自由发挥。</p><h3 id="4-效果展示"><a href="#4-效果展示" class="headerlink" title="4.效果展示"></a>4.效果展示</h3><hr><p>展示界面比较简陋，用的vue，之前已经放过结果图了。数据是通过HA的api来获取的。界面就不贴了，太简陋。脚本如下：</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>el<span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span><span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span>info<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>lists<span class="token operator">:</span> <span class="token keyword">null</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/states/sensor.wbhot'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>  headers <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">'Authorization'</span><span class="token operator">:</span> <span class="token string">"Bearer XXXXXXXX"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>lists <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>attributes<span class="token punctuation">.</span>lists<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>再盗用下之前的图吧</p><p><img src="/img/20210406/info.png" alt="MQTT插件展示"></p>]]></content>
      
      
      <categories>
          
          <category> 智能家居 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> homeassistant </tag>
            
            <tag> mqtt </tag>
            
            <tag> Node-red </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Scratch飞花令</title>
      <link href="fhl.html"/>
      <url>fhl.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>这是一个Scratch的飞花令教程</p></blockquote><h3 id="0-背景"><a href="#0-背景" class="headerlink" title="0.背景"></a>0.背景</h3><hr><p>老婆的学校有个教学短视频制作的比赛，她不知道做什么，我就提议将编程和教学联合起来。小学生现在都流行图形化编程，Scratch就是其中一个，所以我就想把这两个结合起来，做个东西。</p><h3 id="1-简介"><a href="#1-简介" class="headerlink" title="1.简介"></a>1.简介</h3><hr><p>下面是飞花令和Scratch的简介</p><blockquote><p>飞花令，原本是古人行酒令时的一个文字游戏，源自古人的诗词之趣，得名于唐代诗人韩翃《寒食》中的名句“春城无处不飞花”。行飞花令时可选用诗词曲中的句子，但选择的句子一般不超过七个字。</p></blockquote><blockquote><p>Scratch是麻省理工学院的“终身幼儿园团队”开发的图形化编程工具，主要面对青少年开放。</p></blockquote><h3 id="2-制作过程"><a href="#2-制作过程" class="headerlink" title="2.制作过程"></a>2.制作过程</h3><hr><p><img src="/img/20210407/fhl0.jpg" alt="飞花令"></p><p><img src="/img/20210407/fhl1.jpg" alt="飞花令"></p><p><img src="/img/20210407/fhl2.jpg" alt="飞花令"></p><p><img src="/img/20210407/fhl3.jpg" alt="飞花令"></p><h3 id="3-成果展示"><a href="#3-成果展示" class="headerlink" title="3.成果展示"></a>3.成果展示</h3><hr><p><video src="/img/20210407/fhl.mp4" width="100%" controls="controls"></video></p><h3 id="4-比赛结果"><a href="#4-比赛结果" class="headerlink" title="4.比赛结果"></a>4.比赛结果</h3><hr><p>这次比赛获得了精品作品奖</p><p><img src="/img/20210407/zs.png" alt="荣誉证书"></p><p>还是不错的，以后继续加油吧!</p>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Scratch </tag>
            
            <tag> 编程 </tag>
            
            <tag> 飞花令 </tag>
            
            <tag> 少儿 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>生活记事</title>
      <link href="life-20210407.html"/>
      <url>life-20210407.html</url>
      
        <content type="html"><![CDATA[<h3 id="0-照片分享"><a href="#0-照片分享" class="headerlink" title="0.照片分享"></a>0.照片分享</h3><hr><p>下班后彤彤就到小区门口接我们，接着去拿了个快递。以下是彤妈拍的漂亮彤</p><p><img src="/img/20210407/0.jpg" alt="漂亮可爱的宝宝"></p><p><img src="/img/20210407/1.jpg" alt="漂亮可爱的宝宝"></p><p><img src="/img/20210407/2.jpg" alt="漂亮可爱的宝宝"></p><h3 id="1-说在最后"><a href="#1-说在最后" class="headerlink" title="1.说在最后"></a>1.说在最后</h3><hr><p>小孩的魔力真的很大，很能感染你。家人可能会为了宝宝的成长有些许分歧，但是目标总是希望她健康快乐成长。生活就是这样，好好享受这个过程。</p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 宝宝 </tag>
            
            <tag> 照片 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>交易制作工具</title>
      <link href="maketranstool.html"/>
      <url>maketranstool.html</url>
      
        <content type="html"><![CDATA[<h3 id="0-工具简介"><a href="#0-工具简介" class="headerlink" title="0.工具简介"></a>0.工具简介</h3><hr><p>由于开发交易是固定繁琐的动作，所以想开发一款交易制作工具来达到提高生产力。有更多的时间去做更有意义的事情。工具定制性比较强，可能都不能用。但是可以共享其中的想法和思路。是18年写的，也运行了几年了，没出什么大问题，运行还算稳定。小工具采用VBS编码，比较轻便，能够在Windows平台下顺利运行，也不占用系统空间。这个小程序主要使用了 模拟POST请求，使用Sqlplus和数据库进行交互，xml文件解析和文件的读写操作以及移动。代码不是很复杂</p><h3 id="1-目录结构"><a href="#1-目录结构" class="headerlink" title="1.目录结构"></a>1.目录结构</h3><hr><p>|   MakeTrans.vbs     —&gt;  小工具的运行程序,双击即可运行<br>|<br>|   CheckIsValid.vbs  —&gt;  检查XML报文是否合法[要在文件都修改完成后检测]<br>|<br>+—Log                       —&gt;  日志输出文件夹<br>|       Run-[20180417092345].log        —&gt;   日志文件<br>|    Script.log            —&gt;   协议相关脚本<br>|<br>+—traninfo.txt      —&gt;  交易粘贴处<br>|<br>+—Metadata          —&gt;  元数据输出文件夹<br>|       3001300000333-metadata.zip      —&gt;   元数据文件<br>|       service       —&gt;  模板修改后的文件会出现在这个文件夹下<br>|<br>+—Template          —&gt;  模板文件夹<br>|       BIBPS.xml     —&gt;  会将拆组报文件中的Body内的内容替换模板中的 XXXXXXXXXXXXXXXXXXXX 内容<br>|<br>+—Tmp                                 —&gt;  临时文件夹[用于存储从SVN中拷贝过来的文件]<br>|       metadata.xml             —&gt;  修改的元数据文件<br>|       serviceIdentify.xml    —&gt;  修后的服务识别文件<br>|       systemIdentify.xml    —&gt;  修改后的系统识别<br>|<br>-–SQLScript                               —&gt;  工具中用到的SQL脚本文件夹[勿删勿改]<br>        CheckTran.sql                   —&gt;   检查交易是否为存量脚本<br>        GetInfo.sql                         —&gt;   获得下载Metadata的参数<br>        GetName.sql                     —&gt;   获得系统名对应的简称<br>        AddChannel.sql                —&gt;   添加新增渠道<br>        AddSystem.sql                  —&gt;   添加新增系统方<br>        GetCHName.sql                —&gt;   获得中文描述</p><h3 id="2-功能介绍"><a href="#2-功能介绍" class="headerlink" title="2.功能介绍"></a>2.功能介绍</h3><hr><p><strong>0、 更新SVN[需要安装svn命令行]<br>1、 登录服务治理平台下载脚本以及配置文件<br>2、 将下载好的脚本入库<br>3、 检查交易的类型[存量或者新增]<br>4、 将配置文件拷贝至本地SVN[根据交易类型进行拷贝]<br>5、 比对元数据并修改<br>6、 修改公共文件[服务识别，系统识别]<br>7、 根据模板文件修改拆组包报文<br>8、 增加XML可用性检测[由于多次出现低级错误，故添加]<br>9、 可选择执行的步骤</strong></p><h3 id="3-常见问题"><a href="#3-常见问题" class="headerlink" title="3.常见问题"></a>3.常见问题</h3><hr><p>Q：换到其他机器上时出现错误，原因是sqlplus连接出现乱码<br>A：可以使用 echo %NLS_LANG% 查看，并配置该环境变量<br>    C:\Users\XXXXX&gt;echo %NLS_LANG%<br>    AMERICAN_AMERICA.ZHS32GB18030</p><p>Q: 出现 BComp.exe 不是命令<br>A: 使用BCompare工具时需要添加环境变量</p><p>Q: 出现不能解压文件时<br>A: 需要将winrar加入环境变量</p><h3 id="4-代码展示"><a href="#4-代码展示" class="headerlink" title="4.代码展示"></a>4.代码展示</h3><hr><pre class="line-numbers language-vbscript" data-language="vbscript"><code class="language-vbscript">'Author:wangxingyang'Date:20180413'write at nanjing bankSet http=CreateObject("MSXML2.XMLHTTP")Set html = CreateObject("htmlfile")Set wshshell = CreateObject("wscript.shell")Set xdoc = CreateObject("MSXML2.DOMDocument")Set logfso = CreateObject("Scripting.FileSystemObject")Set tranfso = CreateObject("Scripting.FileSystemObject")Set scriptfdo = CreateObject("Scripting.FileSystemObject")Set attrDict = CreateObject("Scripting.Dictionary")nowdate = Now()nowdate = Year(nowdate) &amp; Right("0" &amp; Month(nowdate),2)&amp; Right("0" &amp; Day(nowdate),2)&amp; Right("0" &amp; Hour(nowdate),2)&amp; Right("0" &amp; Minute(nowdate),2)&amp;  Right("0" &amp; Second(nowdate),2)logpath = "Log/Run-[" &amp; nowdate &amp; "].log"tranpath = "Log/Tran-[" &amp; nowdate &amp; "].log"scriptpath1 = "Log/Script.log"Set logfile = logfso.CreateTextFile(logpath,True)Set tranfile = tranfso.CreateTextFile(tranpath,True)Set scriptfile = scriptfdo.CreateTextFile(scriptpath1,True)Dim cookies'---------服务治理控制台地址----------- [ 注意:需要斜杠 ]mainurl = "http://159.1.XXX.XXX:PPPP/"'---------跑库的连接地址---------------linkurl33 = "XXXX/XXXX@159.1.XX.XXX:PPPP/RFRFR"linkurl39 = "XXXX/XXXXX@159.1.XX.XXX:PPPP/DEDEE"'---------服务治理库地址---------------serviceurl = "SSS/SSS@159.1.XX.XXX:PPPP/SESES"'---------生成临时文件----------------- [ 注意:需要斜杠 ]commpath = "Tmp\"'---------脚本存放目录----------------- [ 注意:需要斜杠 ]scriptpath = "SQLScript\"'---------元数据存放目录--------------- [ 注意:需要斜杠 ]metadatapath = "Metadata\"'---------svn metadata-----------------'---------svn路径----------------------svnpath = "Z:\WorkSpace\SmartESB\configs"inconfpath = svnpath &amp; "\in_conf\"outconfpath = svnpath &amp; "\out_conf\"svndestin = inconfpath &amp; "metadata\"svndestout = outconfpath &amp; "metadata\"svnmetadata = svndestin &amp; "metadata.xml"'---------服务定义文件-----------------newpath = "C:\Users\WWW\Desktop\交易制作工具\Metadata\"'存放数据字典中所有字段名称alldata = ""'存放需要增加的语句allNewData = ""'----------是否为存量交易标识-----------'True  存量'False 新增复用isExistFlag = True  totalNum = 0'======================='版本更新日志打印'=======================Sub versionLog()logfile.WriteLine("------------------" &amp; Now() &amp; "---------------------" &amp; Chr(13) &amp; Chr(13) &amp; Chr(13))logfile.WriteLine("=============================================================" &amp; Chr(13))logfile.WriteLine("︻┳═一 " &amp; Now() &amp; "---&gt;Author : wangxingyang")logfile.WriteLine("︻┳═一 " &amp; Now() &amp; "---&gt;Date : 2018/04/13")    logfile.WriteLine("︻┳═一 " &amp; Now() &amp; "---&gt;Contact : freefitter@163.com")logfile.WriteLine("=============================================================" &amp; Chr(13))logfile.WriteLine(Now() &amp; "---&gt;Version : v1.0 At 2018/04/13")logfile.WriteLine(Now() &amp; "---&gt;1、 检查交易是否为新增")logfile.WriteLine(Now() &amp; "---&gt;2、 导出并只执行脚本")logfile.WriteLine(Now() &amp; "---&gt;3、 导出相关配置文件")logfile.WriteLine(Now() &amp; "---&gt;4、 修改公共文件结构")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.0 At 2018/04/16")logfile.WriteLine(Now() &amp; "---&gt;1、 增加解压文件功能")logfile.WriteLine(Now() &amp; "---&gt;2、 增加比较元数据功能")logfile.WriteLine(Now() &amp; "---&gt;3、 增加拷贝至配置库功能")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.1 At 2018/05/04")logfile.WriteLine(Now() &amp; "---&gt;1、 修改弹出框BUG[弹出框有长度限制，导致处理交易报错]")logfile.WriteLine(Now() &amp; "---&gt;2、 修改文件系统名称小写问题")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.2 At 2018/05/06")logfile.WriteLine(Now() &amp; "---&gt;1、 增加交易执行判断日志")logfile.WriteLine(Now() &amp; "---&gt;2、 增加读文件进行处理交易")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.3 At 2018/05/10")logfile.WriteLine(Now() &amp; "---&gt;1、 修改元数据检查不出新增的BUG")logfile.WriteLine(Now() &amp; "---&gt;2、 修改重复添加元数据BUG")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.4 At 2018/05/14")logfile.WriteLine(Now() &amp; "---&gt;1、 修改当元数据中包含元数据时不能添加的问题")logfile.WriteLine(Now() &amp; "---&gt;2、 新增修改元数据文件功能")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.5 At 2018/05/15")logfile.WriteLine(Now() &amp; "---&gt;1、 增加文件比对功能，使用BCompare打开需要比较的工具")logfile.WriteLine(Now() &amp; "---&gt;2、 服务定义文件中，不存在的调用关系会新增")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.6 At 2018/05/17")logfile.WriteLine(Now() &amp; "---&gt;1、 新增根据交易类型判断是否跑库")logfile.WriteLine(Now() &amp; "---&gt;2、 添加交易简称查询缓存，在一次运行中相同名称值检查一次")logfile.WriteLine(Now() &amp; "---&gt;3、 新增渠道会自动新增服务识别并跑新增脚本")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.7 At 2018/05/13")logfile.WriteLine(Now() &amp; "---&gt;1、 新增根据模板替换拆组报文件功能")logfile.WriteLine(Now() &amp; "---&gt;2、 新增拼接更新适配器SQL功能")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.8 At 2018/05/30")logfile.WriteLine(Now() &amp; "---&gt;1、 新增选择执行指定流程")logfile.WriteLine(Now() &amp; "---&gt;2、 优化路径，尽量少更改路径")logfile.WriteLine(Now() &amp; "---&gt;Version : v2.9 At 2018/06/12")logfile.WriteLine(Now() &amp; "---&gt;1、 修改元数据少添加的BUG")logfile.WriteLine(Now() &amp; "---&gt;Version : v3.0 At 2018/11/15")logfile.WriteLine(Now() &amp; "---&gt;1、 修改查询元数据比对堆栈溢出BUG")logfile.WriteLine(Now() &amp; "---&gt;2、 增加粘贴格式校验")logfile.WriteLine("------------------" &amp; Now() &amp; "---------------------" &amp; vbcrlf &amp; vbcrlf)End Sub'======================='登录服务治理系统'=======================Sub login(username,password)url = mainurl &amp; "login/"http.Open "POST",url,Falsehttp.setRequestHeader "Content-Type","application/x-www-form-urlencoded; charset=UTF-8"http.Send "username=" &amp; username &amp; "&amp;password=" &amp; passwordstrHtml = http.responsetextcookies = http.getResponseHeader("Set-Cookie")logfile.WriteLine(Now() &amp; "---&gt;登录服务治理成功")End Sub'======================='检查交易是否是新增复用'=======================Sub checkTran(code,from,dest)logfile.WriteLine(Now() &amp; "---&gt;开始查看["&amp; code &amp;"]是否是全新交易")cmdstr = "sqlplus "&amp; linkurl33 &amp;" @" &amp; scriptpath &amp; "CheckTran.sql" &amp; " " &amp; codeSet exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()logfile.WriteLine(Now() &amp; "---&gt;查询结果如下:")logfile.WriteLine(Now() &amp; "---&gt;"&amp; retmsg)If InStr(retmsg,"no rows") = 0 Thenlogfile.WriteLine(Now() &amp; "---&gt;交易[" &amp; code &amp; "]为新增复用交易!!!")fromname = queryName(from)tranfile.WriteLine("交易[" &amp; code &amp; "] ------&gt; 新增复用，调用关系为: [ " &amp; from &amp; " = " &amp; fromname &amp;" ] -&gt; " &amp; code &amp; " -&gt; [ " &amp; dest &amp; " ]")isExistFlag = TruetotalNum = totalNum + 2Elselogfile.WriteLine(Now() &amp; "---&gt;交易[" &amp; code &amp; "]为全新交易!!!")fromname = queryName(from)tranfile.WriteLine("交易[" &amp; code &amp; "] ------&gt; 全新，调用关系为: [ " &amp; from &amp; " = " &amp; fromname &amp;" ] -&gt; " &amp; code &amp; " -&gt; [ " &amp; dest &amp; " ]")isExistFlag = FalsetotalNum = totalNum + 6End Iflogfile.WriteLine(Now() &amp; "---&gt;查看["&amp; code &amp;"]是否是全新交易结束")End Sub'======================='导出并执行脚本'=======================Sub exportAndRunSQLOne(tranId)'--------导出脚本--------------'判断是否是存量，如果是存量，不用跑数据库脚本If isExistFlag Thenlogfile.WriteLine(Now() &amp; "---&gt;交易[" &amp; tranId &amp; "]为新增复用交易，不跑脚本。直接退出！")Exit SubEnd Iflogfile.WriteLine(Now() &amp; "---&gt;开始导出[" &amp; tranId &amp; "]SQL脚本")type1 = "service"operationIds = tranIdurl = mainurl &amp; "esbScriptExport/preview"http.Open "POST",url,Falsehttp.setRequestHeader "Content-Type","application/x-www-form-urlencoded; charset=UTF-8"http.setRequestHeader "Cookie",cookieshttp.Send "type=" &amp; type1 &amp; "&amp;operationIds=" &amp; operationIdsstrHtml = http.responsetextSet window = html.parentWindowwindow.execScript "var json = " &amp; strHtml, "JScript"Set ret = window.jsonsqltmp = ret.result'----------替换Adapter----------'---后期添加'------可采用先跑在更新的方式'------或者拿到后替换更新'----------写文件---------------Set fso = CreateObject("Scripting.FileSystemObject")Set file = fso.CreateTextFile( scriptpath &amp; operationIds &amp;".sql",True)file.WriteLine(sqltmp)file.WriteLine("commit;")file.WriteLine("exit;")file.close()logfile.WriteLine(Now() &amp; "---&gt;导出[" &amp; tranId &amp; "]SQL脚本完成")logfile.WriteLine(Now() &amp; "---&gt;导出内容如下：")logfile.WriteLine(Now() &amp; "---&gt; ")logfile.WriteLine(sqltmp &amp; "commit;")logfile.WriteLine(sqltmp &amp; "exit;")'-----------跑刚刚保存下来的SQL文件---------logfile.WriteLine(Now() &amp; "---&gt;在["&amp; linkurl33 &amp;"]开始执行导出脚本 " &amp; scriptpath &amp; operationIds &amp;".sql")Set exeRs = wshshell.exec("sqlplus " &amp; linkurl33 &amp;" @" &amp; scriptpath &amp; operationIds &amp;".sql")retmsg = exeRs.StdOut.ReadAll()If InStr(retmsg,"ORA") &gt; 0 Thenlogfile.WriteLine(Now() &amp; " Error-&gt;执行["&amp; tranId &amp;"]存在错误，请查看日志......")End Iflogfile.WriteLine(Now() &amp; "---&gt;拼接更新适配器语句开始..................."&amp; vbcrlf)'拼接服务场景码，用于写SQL更新sqlText = ""scriptfile.WriteLine("---" &amp; tranId)If InStr(retmsg,"BIND_PROTOCOLID_REF") &gt; 0 ThensqlText = "insert into BINDMAP(SERVICEID, STYPE, LOCATION, VERSION, PROTOCOLID, MAPTYPE) VALUES('" &amp; tranId &amp; "', 'SERVICE', 'local_out', '0', '" &amp; tranId &amp; "Adapter', 'request');" &amp; vbcrlfEnd IfsqlText = sqlText &amp; "UPDATE SERVICESYSTEMMAP SET ADAPTER = '" &amp; tranId &amp; "Adapter' WHERE SERVICEID = '" &amp; tranId &amp; "';" &amp; vbcrlfsqlText = sqlText &amp; "UPDATE BINDMAP SET PROTOCOLID = '" &amp; tranId &amp; "Adapter' WHERE SERVICEID = '" &amp; tranId &amp; "';" &amp; vbcrlfscriptfile.WriteLine(sqlText)logfile.WriteLine(sqlText)logfile.WriteLine(Now() &amp; "---&gt;拼接更新适配器语句结束..................."&amp; vbcrlf)logfile.WriteLine(Now() &amp; "---&gt;执行结果：")logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")logfile.WriteLine(retmsg)logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")logfile.WriteLine(Now() &amp; "---&gt;导出脚本执行结束 " &amp; scriptpath &amp; operationIds &amp;".sql")'-----------跑刚刚保存下来的SQL文件---------logfile.WriteLine(Now() &amp; "---&gt;在["&amp; linkurl39 &amp;"]开始执行导出脚本 " &amp; scriptpath &amp; operationIds &amp;".sql")Set exeRs = wshshell.exec("sqlplus " &amp; linkurl39 &amp;" @" &amp; scriptpath &amp; operationIds &amp;".sql")retmsg = exeRs.StdOut.ReadAll()If InStr(retmsg,"ORA") &gt; 0 Thenlogfile.WriteLine(Now() &amp; " Error-&gt;执行["&amp; tranId &amp;"]存在错误，请查看日志......")End Iflogfile.WriteLine(Now() &amp; "---&gt;执行结果：")logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")logfile.WriteLine(retmsg)logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")logfile.WriteLine(Now() &amp; "---&gt;导出脚本执行结束 " &amp; scriptpath &amp; operationIds &amp;".sql")Set sfile = fso.getfile(scriptpath &amp; operationIds &amp;".sql")sfile.deleteSet fso = NothingEnd Sub'======================='执行SQL脚本'=======================Sub RunSqlScript(en_name,ch_name,sqlname)If sqlname = "AddChannel" Thencmdstr = "sqlplus "&amp; linkurl33 &amp;" @" &amp; scriptpath &amp; sqlname &amp; ".sql" &amp; " " &amp; en_name &amp; " " &amp; en_name &amp; "Connector " &amp; ch_nameElsecmdstr = "sqlplus "&amp; linkurl33 &amp;" @" &amp; scriptpath &amp; sqlname &amp; ".sql" &amp; " " &amp; en_name &amp; " " &amp; en_name &amp; "Adapter " &amp; ch_nameEnd If'logfile.WriteLine(Now() &amp; " RunSqlScript " &amp; cmdstr)Set exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()If InStr(retmsg,"ORA") &gt; 0 Thenlogfile.WriteLine(Now() &amp; " Error-&gt;执行新增渠道["&amp; en_name &amp;"]存在错误，请查看日志......")End Iflogfile.WriteLine(Now() &amp; "---&gt;执行结果：")logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")logfile.WriteLine(retmsg)logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")If sqlname = "AddChannel" Thencmdstr = "sqlplus "&amp; linkurl39 &amp;" @" &amp; scriptpath &amp; sqlname &amp; ".sql" &amp; " " &amp; en_name &amp; " " &amp; en_name &amp; "Connector " &amp; ch_nameElsecmdstr = "sqlplus "&amp; linkurl39 &amp;" @" &amp; scriptpath &amp; sqlname &amp; ".sql" &amp; " " &amp; en_name &amp; " " &amp; en_name &amp; "Adapter " &amp; ch_nameEnd IfSet exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()If InStr(retmsg,"ORA") &gt; 0 Thenlogfile.WriteLine(Now() &amp; " Error-&gt;执行新增渠道["&amp; en_name &amp;"]存在错误，请查看日志......")End Iflogfile.WriteLine(Now() &amp; "---&gt;执行结果：")logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")logfile.WriteLine(retmsg)logfile.WriteLine(Now() &amp; "-----------------------------------------------------------")End Sub'======================='导出脚本并执行，支持多个'=======================Sub exportAndRunSql(tranIds)If InStr(tranIds,",") = 0  ThenexportAndRunSQLOne(tranIds)Elsemyarray = Split(tranIds,",")For i= 0 To UBound(myarray)exportAndRunSQLOne(myarray(i))nextEnd IfEnd Sub'======================='导出交易的配置文件'=======================Sub exportConf(from,dest,code)'连接数据库查询相关数据logfile.WriteLine(Now() &amp; "---&gt;准备导出配置文件")logfile.WriteLine(Now() &amp; "---&gt;查询导出配置文件所需参数")serviceId = Left(code,11)senceId = Right(code,2)cmdstr = "sqlplus "&amp; serviceurl &amp;" @" &amp; scriptpath &amp; "GetInfo.sql" &amp; " " &amp; serviceId &amp; " " &amp; senceId &amp; " " &amp; from &amp; " " &amp; destSet exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()logfile.WriteLine(Now() &amp; "---&gt;查询导出配置文件所需参数如下:")logfile.WriteLine(Now() &amp; "---&gt;"&amp; retmsg)If InStr(retmsg,"no rows") = 0 Thenlogfile.WriteLine(Now() &amp; "---&gt;开始导出["&amp; code &amp;"]配置文件")rets = Split(retmsg,"--------------------------------------------------------------------------------")tttt = Split(rets(4),"Disconnected")result = tttt(0)ret = Split(result,Chr(10))val1 = Replace(Trim(ret(1)),Chr(13),"")val2 = Replace(Trim(ret(3)),Chr(13),"")val3 = Replace(Trim(ret(2)),Chr(13),"")val4 = Replace(Trim(ret(4)),Chr(13),"")val1 = Replace(val1,Chr(10),"")val2 = Replace(val2,Chr(10),"")val3 = Replace(val3,Chr(10),"")val4 = Replace(val4,Chr(10),"")url = mainurl &amp; "export/exportBatch"http.Open "POST",url,Falsehttp.setRequestHeader "Content-Type","application/x-www-form-urlencoded; charset=UTF-8"http.setRequestHeader "Accept-Encoding","gzip,deflate,sdch"http.setRequestHeader "Cache-Control","max-age=0"http.setRequestHeader "Connection","keep-alive"http.setRequestHeader "Cookie",cookieshttp.Send "list[0].consumerServiceInvokeId=" &amp; val1 &amp; "&amp;list[0].providerServiceInvokeId=" &amp; val2 &amp; "&amp;list[0].conGeneratorId=" &amp; val3 &amp; "&amp;list[0].proGeneratorId=" &amp; val4Set file1 = CreateObject("ADODB.Stream")file1.Mode = 3file1.Type = 1file1.Open()file1.write(http.responseBody)file1.SaveToFile metadatapath &amp; code &amp; "-" &amp; "metadata.zip",2logfile.WriteLine(Now() &amp; "---&gt;导出["&amp; code &amp;"]配置文件完成")Set file1 = NothingElseMsgBox "数据库未查询到配置信息,注意查看!!!"Exit SubEnd If '-------------解压文件---------------cmdstr = "cmd /c cd %cd%\" &amp; metadatapath  &amp; " &amp; winrar.exe x -ad -y "&amp; code &amp;"-metadata.zip"Set exeRs = wshshell.exec(cmdstr)'添加这句才能够等待执行完成结果，才能串行retmsg = exeRs.StdOut.ReadAll()'-------------比较元数据--------------'compareMeteData(code)'-------------拷贝文件至ESB路径下-----------'copyConfToSvn(code)End Sub'======================='查询对应系统的简称'=======================Function queryName(from)result = ""If attrDict.Exists(from) Thenresult = attrDict.Item(from)logfile.WriteLine(Now() &amp; "---&gt; 字典中已缓存，直接取缓存")Elselogfile.WriteLine(Now() &amp; "---&gt; 字典中未缓存，需要查库")cmdstr = "sqlplus "&amp; serviceurl &amp;" @" &amp; scriptpath &amp; "GetName.sql" &amp; " " &amp; fromSet exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()If InStr(retmsg,"no rows") = 0 Thenrets = Split(retmsg,"--------------------------------------------------------------------------------")tttt = Split(rets(1),"Disconnected")result = Replace(tttt(0),Chr(10),"")result = Replace(result,Chr(13),"")ElseMsgBox "未查询到[" &amp; from &amp; "]对应的简称,注意查看!!!"End IfattrDict.Add from,resultEnd IfqueryName = resultEnd Function'======================='查询对应系统的名称'=======================Function queryCHName(from)result = ""If attrDict.Exists(from) Thenresult = attrDict.Item(from)logfile.WriteLine(Now() &amp; "---&gt;字典中已缓存，直接取缓存")Elselogfile.WriteLine(Now() &amp; "---&gt; 字典中未缓存，需要查库")cmdstr = "sqlplus "&amp; serviceurl &amp;" @" &amp; scriptpath &amp; "GetCHName.sql" &amp; " " &amp; fromlogfile.WriteLine(Now() &amp; "---&gt; " &amp; cmdstr)Set exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()If InStr(retmsg,"no rows") = 0 Thenrets = Split(retmsg,"--------------------------------------------------------------------------------")tttt = Split(rets(1),"Disconnected")result = Replace(tttt(0),Chr(10),"")result = Replace(result,Chr(13),"")ElseMsgBox "未查询到[" &amp; from &amp; "]对应的简称,注意查看!!!"End IfattrDict.Add from,resultEnd IfqueryCHName = resultEnd Function'======================='修改服务识别和系统识别'=======================Sub modifyXml(from,dest,code)logfile.WriteLine(Now() &amp; "---&gt;开始修改公共文件")pathService = commpath &amp; "serviceIdentify.xml"pathSystem = commpath &amp; "systemIdentify.xml"'连接数据库查询相关数据logfile.WriteLine(Now() &amp; "---&gt;开始查询[" &amp; from &amp; "]对应的简称")serviceId = Left(code,11)senceId = Right(code,2)result = queryName(from)If result = "" Thenlogfile.WriteLine(Now() &amp; "---&gt;没查到简称呢，直接退出了哟.....")Exit SubEnd If logfile.WriteLine(Now() &amp; "---&gt;[" &amp; from &amp; "]===&gt;[" &amp; result &amp; "]")logfile.WriteLine(Now() &amp; "---&gt;查询[" &amp; from &amp; "]对应的简称结束")logfile.WriteLine(Now() &amp; "---&gt;开始修改[" &amp; pathService &amp; "]文件")xdoc.Load(pathService)ReadServiceXml xdoc,result,from,dest,codexdoc.Save pathServicelogfile.WriteLine(Now() &amp; "---&gt;修改[" &amp; pathService &amp; "]文件结束")logfile.WriteLine(Now() &amp; "---&gt;开始修改[" &amp; pathSystem &amp; "]文件")xdoc.Load(pathSystem)ReadSystemXml  xdoc,result,dest,codexdoc.Save pathSystemlogfile.WriteLine(Now() &amp; "---&gt;修改[" &amp; pathSystem &amp; "]文件结束")logfile.WriteLine(Now() &amp; "---&gt;修改公共文件结束")End Sub'======================='解析服务识别文件并添加新交易'=======================Sub ReadServiceXml(xdoc,from,ch_name,dest,code)'取出所有channelSet nodes = xdoc.documentElement.selectNodes(".//channel")For Each node In nodesSet Alist = node.AttributesDim node2For i = 0 To Alist.Length - 1Dim attrSet attr = Alist.Item(i)If attr.NodeName = "id" And attr.NodeValue = from Then'取出所有 switchSet m = node.getElementsByTagName("switch")(0)Set childs = m.childNodesFor Each node1 In node.selectNodes(".//switch")For j = 0 To node1.ChildNodes.Length -1Set tmp = node1.ChildNodes(j)Set node2 = node1'判断是否存在该交易If tmp.NodeType = 1 And tmp.NodeName = "case" And Trim(tmp.Text) = code Then'有的话直接退出logfile.WriteLine(Now() &amp; "---&gt;存在该调用关系"&amp; from &amp;" -- " &amp; code)Exit SubEnd If NextNext'在注释处插入该交易For n = 1 To childs.length-1If childs(n).NodeType = 8 ThenIf Trim(childs(n).NodeValue) = dest ThenSet nodetmp = xdoc.createElement("case")Set nodeattr = xdoc.createAttribute("value")If from = "ECIF" Or from = "PPL" Or from = "BIBPS" Thennodeattr.text = codenodetmp.setAttributeNode nodeattrnodetmp.text = codeElsenodeattr.text = "Req" &amp; codenodetmp.setAttributeNode nodeattrnodetmp.text = codeEnd Ifm.insertBefore nodetmp,childs(n+1)logfile.WriteLine(Now() &amp; "---&gt; 在注释处插入该交易 "&amp; from &amp;" --&gt; " &amp; code &amp; " --&gt; " &amp; dest)Exit SubEnd If End IfNext'插入注释和交易Set nodetmp = xdoc.createElement("case")Set nodeattr = xdoc.createAttribute("value")Set nodecomm = xdoc.createComment(dest)If from = "ECIF" Or from = "PPL" Or from = "BIBPS"Thennodeattr.text = codenodetmp.setAttributeNode nodeattrnodetmp.text = codeElsenodeattr.text = "Req" &amp; codenodetmp.setAttributeNode nodeattrnodetmp.text = codeEnd Ifm.appendChild(nodecomm)m.appendChild(nodetmp)Exit SubEnd If NextNext'若没有查到CHANNEL则为新增渠道，需要新增渠道logfile.WriteLine(Now() &amp; "---&gt;**********此渠道为新增渠道 "&amp; from &amp;" --&gt; " &amp; code &amp; " --&gt; " &amp; dest)Set channels = xdoc.documentElementlogfile.WriteLine(Now() &amp; "---&gt; 新增 CHANNEL 节点")Set channel = xdoc.createElement("channel")Set channelid = xdoc.createAttribute("id")Set channeltype = xdoc.createAttribute("type")channelid.text = fromchannel.setAttributeNode channelidchanneltype.text = "dynamic"channel.setAttributeNode channeltypelogfile.WriteLine(Now() &amp; "---&gt; 新增 Switch 节点")Set switch = xdoc.createElement("switch")Set switchmode = xdoc.createAttribute("mode")Set switchexpression = xdoc.createAttribute("expression")switchmode.text = "soap"switch.setAttributeNode switchmodeswitchexpression.text = "/soapenv:Envelope/soapenv:Body"switch.setAttributeNode switchexpressionlogfile.WriteLine(Now() &amp; "---&gt; 新增 namespace 节点")Set namespace = xdoc.createElement("namespace")Set namespacevalue = xdoc.createAttribute("value")namespacevalue.text = "soapenv"namespace.setAttributeNode namespacevaluenamespace.text = "http://schemas.xmlsoap.org/soap/envelope/"logfile.WriteLine(Now() &amp; "---&gt; 新增 交易 节点")Set nodetmp = xdoc.createElement("case")Set nodeattr = xdoc.createAttribute("value")Set nodecomm = xdoc.createComment(dest)If from = "ECIF" Or from = "PPL" Or from = "BIBPS" Thennodeattr.text = codenodetmp.setAttributeNode nodeattrnodetmp.text = codeElsenodeattr.text = "Req" &amp; codenodetmp.setAttributeNode nodeattrnodetmp.text = codeEnd Ifchannels.appendChild(channel)channel.appendChild(switch)switch.appendChild(namespace)switch.appendChild(nodecomm)switch.appendChild(nodetmp)'执行 渠道插入脚本 RunSqlScript from,"","AddChannel"End Sub'======================='将执行结果写回到文件'=======================Sub AddLineAfterWord(frompath,topath,word,text)'非标准的XML文件，不能使用XML函数处理logfile.WriteLine(Now() &amp; "---&gt;开始添加元数据的差异")If Trim(text) = "" Thenlogfile.WriteLine(Now() &amp; "---&gt;无差异，无需操作")Exit Sub End If Set fso = CreateObject("Scripting.FileSystemObject")pathMetadata4Read = frompathpathMetadata4Write = topathSet fileMetadata4Read = fso.OpenTextFile(pathMetadata4Read,1,False)Set fileMetadata4Write = fso.OpenTextFile(pathMetadata4Write,2,True)Do While fileMetadata4Read.AtEndOfStream &lt;&gt; Trueline = fileMetadata4Read.ReadLine()If Trim(line) = "&lt;/"&amp; word &amp;"&gt;" Then fileMetadata4Write.Write(text)fileMetadata4Write.WriteLine("&lt;/"&amp; word &amp;"&gt;")ElsefileMetadata4Write.WriteLine lineEnd IfLoopfileMetadata4Read.close()fileMetadata4Write.close()Set fso = Nothinglogfile.WriteLine(Now() &amp; "---&gt;内容如下")logfile.WriteLine(Now() &amp; "---&gt;")logfile.WriteLine(text)logfile.WriteLine(Now() &amp; "---&gt;完成添加元数据的差异")End Sub'======================='未使用'=======================Sub notuse()Set xdocu = CreateObject("MSXML2.DOMDocument")pathMetadata = commpath &amp; "metadata.xml"xdocu.Load(pathMetadata)Set nodetmp1 = xdocu.documentElementMsgBox (nodetmp1 Is Nothing)Set cNode = xdocu.createElement(nodename)Set nodeattr1 = xdocu.createAttribute("type")nodeattr1.text = nodetypecNode.setAttributeNode nodeattr1If nodetype = "string" Then Set nodeattr2 = xdocu.createAttribute("length")nodeattr2.text = "255"cNode.setAttributeNode nodeattr2End If nodetmp1.appendChild(cNode)xdocu.Save pathMetadataEnd Sub '======================='解析系统识别并添加新增交易'=======================Sub ReadSystemXml(xdoc,from,dest,code)logfile.WriteLine(Now() &amp; from &amp;" --&gt; " &amp; code &amp; " --&gt; " &amp; dest)Set nodes = xdoc.documentElement.selectNodes(".//system")For Each node In nodesSet Alist = node.AttributesFor i = 0 To Alist.Length - 1Dim attrSet attr = Alist.Item(i)If attr.NodeName = "id" And attr.NodeValue = dest ThenFor Each node1 In node.selectNodes(".//service")If node1.Text = code Thenlogfile.WriteLine(Now() &amp; "存在该交易.......")Exit Sub End IfNext'插入该交易Set cNode = xdoc.createElement("service")cNode.Text = codenode.appendChild(cNode)Exit SubEnd IfNextNext'若是新增系统问题logfile.WriteLine(Now() &amp; "---&gt;**********系统[ " &amp; dest &amp; " ]为新增提供方 "&amp; from &amp;" --&gt; " &amp; code &amp; " --&gt; " &amp; dest)Set systems = xdoc.documentElementSet system = xdoc.createElement("system")Set systemid = xdoc.createAttribute("id")systemid.text = destsystem.setAttributeNode systemidSet cNode = xdoc.createElement("service")cNode.Text = codesystems.appendChild(system)system.appendChild(cNode)ch_name=queryCHName(dest)'MsgBox (dest &amp; "--&gt;" &amp; ch_name)'执行 系统插入脚本 RunSqlScript dest,ch_name,"AddSystem"End Sub'======================='加载元数据'=======================Sub loadMetaData()logfile.WriteLine(Now() &amp; "---&gt;开始加载最新Metadata.xml文件...")Set fso = CreateObject("Scripting.FileSystemObject")Set svnfile = fso.OpenTextFile(svnmetadata,1,False)Do While svnfile.AtEndOfStream &lt;&gt; Trueline = svnfile.ReadLine()If InStr(line,"type") &gt; 0 Then tmpp = Split(line,"&lt;")(1)name = Trim(Split(tmpp," ")(0))alldata = alldata &amp; name &amp; ","End IfLooplogfile.WriteLine(Now() &amp; "---&gt;加载最新Metadata.xml完成..." )Set fso = NothingEnd Sub '======================='比对元数据'=======================Sub compareMeteData(code)'文件方式比较logfile.WriteLine(Now() &amp; "---&gt;开始比较[" &amp; code &amp; "]与元数据的差异")Set fso = CreateObject("Scripting.FileSystemObject")temp = newpath &amp; code &amp; "-metadata\in_config\servicedefine"Set localfile = fso.GetFolder(temp)Set outpath = fso.CreateTextFile(newpath &amp; "\out" &amp; code &amp; ".txt",True)Set oFiles = localfile.FilesFor Each oFile In oFilestmppath = oFile.PathSet file1 = fso.OpenTextFile(tmppath,1,False)Do While file1.AtEndOfStream &lt;&gt; Trueline = file1.ReadLine()If InStr(line,"metadataid") &gt; 0 Thentmpp = Split(line,"metadataid")(1)tmpp1 = Trim(Split(tmpp,Chr(34))(1))If InStr(line,"type") &gt; 0 Thentmpp2 = Split(line,"type")(1)tmpp3 = Split(tmpp2,Chr(34))(1)isExists = 1checkExists alldata,tmpp1,isExists'MsgBox len(alldata)   416771If (tmpp3 = "array" Or tmpp3 = "sopform") And isExists = 0 Thenoutpath.WriteLine("&lt;" &amp; tmpp1 &amp; " type=" &amp; Chr(34) &amp; "array"&amp; Chr(34) &amp;"/&gt;")logfile.WriteLine(Now() &amp; "---&gt;开始添加[" &amp; tmpp1 &amp; "]元数据,类型为[array]")'添加已经添加的字段，以免重复新增allNewData = allNewData &amp; "&lt;" &amp; tmpp1 &amp; " type=" &amp; Chr(34) &amp; "array"&amp; Chr(34) &amp;"/&gt;"&amp; vbcrlfalldata = alldata &amp; tmpp1 &amp; ","End If ElseisExists = 1checkExists alldata,tmpp1,isExistsIf isExists = 0 Thenoutpath.WriteLine("&lt;" &amp; tmpp1 &amp; " type=" &amp; Chr(34) &amp; "string"&amp; Chr(34) &amp;" length="&amp; Chr(34) &amp; "255" &amp; Chr(34) &amp;"/&gt;")logfile.WriteLine(Now() &amp; "---&gt;开始添加[" &amp; tmpp1 &amp; "]元数据,类型为[string]")allNewData = allNewData &amp; "&lt;" &amp; tmpp1 &amp; " type=" &amp; Chr(34) &amp; "string"&amp; Chr(34) &amp;" length="&amp; Chr(34) &amp; "255" &amp; Chr(34) &amp;"/&gt;" &amp; vbcrlfalldata = alldata &amp; tmpp1 &amp; ","End IfEnd IfEnd IfLoopNextSet fso = Nothinglogfile.WriteLine(Now() &amp; "---&gt;完成比较[" &amp; code &amp; "]与元数据的差异")End Sub'======================='修改拆组包文件'=======================Sub modifyPackFile(from,dest,code)'此处需要根据各个现场修改'修改拆组包文件逻辑需要再次判断'isExistFlag = FalseSet fso = CreateObject("Scripting.FileSystemObject")logfile.WriteLine(Now() &amp; "---&gt;开始修改拆组包文件[" &amp; code &amp; "]")If Not fso.fileExists("Template\" &amp; dest &amp; ".xml") Or isExistFlag Thenlogfile.WriteLine(Now() &amp; "---&gt;没有模版文件[" &amp; code &amp; "]")Exit Sub End If servicepath = newpath &amp; code &amp; "-metadata\out_config\" &amp; dest &amp; "\service_"&amp; code &amp;"_system_" &amp; dest &amp; ".xml"servicenewpath = newpath &amp; "service\service_"&amp; code &amp;"_system_" &amp; dest &amp; ".xml"channelepath = newpath &amp; code &amp; "-metadata\out_config\" &amp; dest &amp; "\channel_" &amp; dest &amp; "_service_" &amp; code &amp; ".xml"channelenewpath = newpath &amp; "service\channel_" &amp; dest &amp; "_service_" &amp; code &amp; ".xml"logfile.WriteLine(Now() &amp; "---&gt;开始修改组包文件[" &amp; code &amp; "]")xdoc.load(servicepath)tmp1 = Replace(xdoc.xml,"s:","")tmp2 = Replace(tmp1,"d:","")tmp = Replace(tmp2,":","")tp = Replace(tmp,"xmlns=" &amp; Chr(34) &amp; "http//esb.dcitsbiz.com/services/"&amp; Left(code,11) &amp; Chr(34),"")xdoc.loadXML(tp)Set nodes = xdoc.documentElement.selectNodes(".//ReqAppBody")(0)addstr = ""For Each node In nodes.ChildNodesaddstr = addstr  &amp; "" &amp; node.Xml &amp; vbcrlfNextRepalceFile "Template\" &amp; dest &amp; ".xml",servicenewpath,addstrlogfile.WriteLine(Now() &amp; "---&gt;开始修改拆包文件[" &amp; code &amp; "]")xdoc.load(channelepath)tmp1 = Replace(xdoc.xml,"s:","")tmp2 = Replace(tmp1,"d:","")tmp = Replace(tmp2,":","")tp = Replace(tmp,"xmlns=" &amp; Chr(34) &amp; "http//esb.dcitsbiz.com/services/"&amp; Left(code,11) &amp; Chr(34),"")xdoc.loadXML(tp)Set nodes = xdoc.documentElement.selectNodes(".//RspAppBody")(0)addstr = ""For Each node In nodes.ChildNodesaddstr = addstr  &amp; "" &amp; node.Xml &amp; vbcrlfNextRepalceFile "Template\" &amp; dest &amp; ".xml",channelenewpath,addstrlogfile.WriteLine(Now() &amp; "---&gt;完成修改拆组包文件[" &amp; code &amp; "]")End Sub'======================='替换文件'=======================Sub RepalceFile(fromfile,tofile,text)Set file1 = CreateObject("ADODB.Stream")file1.Mode = 3file1.Type = 1file1.Open()file1.LoadFromFile fromfilefile1.Position = 0file1.Type = 2file1.Charset = "utf-8"tmpfile = file1.ReadTextfile1.Position = 0file1.SetEosfile1.Type = 2file1.Charset = "utf-8"file1.WriteText Replace(tmpfile,"XXXXXXXXXXXXXXXXXXXX",text)file1.SaveToFile tofile,2Set file1 = NothingEnd Sub'======================='检查元数据是否存在'=======================Function checkExists(strBase,strNeed,isExists)startPos = InStr(strBase,strNeed)If startPos = 0 ThenisExists = 0Exit FunctionElse'此处若需要的元数据在字段结尾会出现问题isExists = startPosEnd IfendPos = InStr(startPos,strBase,",")newstart = InstrRev(Mid(strBase,1,startPos),",")newval =  Mid(strBase,newstart+1,endPos-newstart-1)newStrBase = Mid(strBase,endPos)'只有长度相等的元数据才继续检查,减少递归的次数While Len(newval) &lt;&gt; Len(strNeed)startPos = InStr(newStrBase,strNeed)'若新的基础字符串中不含需要的元数据，直接退出If startPos = 0 ThenisExists = 0Exit FunctionEnd IfendPos = InStr(startPos,newStrBase,",")newstart = InstrRev(Mid(newStrBase,1,startPos),",")newval =  Mid(newStrBase,newstart+1,endPos-newstart-1)newStrBase = Mid(newStrBase,endPos)WendIf strNeed &lt;&gt; newval ThencheckExists newStrBase,strNeed,isExistsElseisExists = newstart+1Exit FunctionEnd If End Function'======================='拷贝元数据至SVN'=======================Sub copyConfToSvn(code,from)logfile.WriteLine(Now() &amp; "---&gt;开始拷贝文件至SVN[" &amp; code &amp; "]")intemp = newpath &amp; code &amp; "-metadata\in_config\"outtemp = newpath &amp; code &amp; "-metadata\out_config\"Set fso = CreateObject("Scripting.FileSystemObject")Set oFolder = fso.GetFolder(intemp)Set oSubFolder = oFolder.SubFoldersSet outFolder = fso.GetFolder(outtemp)Set outSubFolder = outFolder.SubFolders'isExistFlag = FalseFor Each otmp In oSubFolderIf isExistFlag ThenIf Trim(LCase(otmp.Name)) &lt;&gt; "servicedefine" Then logfile.WriteLine(Now() &amp; "---&gt;开始拷贝文件夹--&gt;[" &amp; intemp &amp; otmp.Name &amp; "]")fso.CopyFolder intemp &amp; otmp.Name &amp; "*",svndestinEnd If Elselogfile.WriteLine(Now() &amp; "---&gt;开始拷贝文件夹--&gt;[" &amp; intemp &amp; otmp.Name &amp; "]")fso.CopyFolder intemp &amp; otmp.Name &amp; "*",svndestinEnd If Next For Each itmp In outSubFolderIf Not isExistFlag Thenlogfile.WriteLine(Now() &amp; "---&gt;开始拷贝文件夹--&gt;[" &amp; outtemp &amp; "]")fso.CopyFolder outtemp &amp; "*",svndestoutEnd If NextSet fso = NothingEnd Sub'======================='加载文件中的交易'=======================Function LoadTrans()versionLog()Set fso = CreateObject("Scripting.FileSystemObject")Set traninfo = fso.OpenTextFile("traninfo.txt",1,False)tmpstr = ""Do While traninfo.AtEndOfStream &lt;&gt; Trueline = traninfo.ReadLine()If Trim(line) &lt;&gt; "" Thennum = Len(line)- Len(Replace(line," ",""))If num &lt;&gt; 2 ThenExit FunctionEnd If tmpstr = tmpstr &amp; Replace(line," ",",") &amp; ";"End IfLoop'拷贝文件至tmp下serviceIdentify = "serviceIdentify.xml"systemIdentify = "systemIdentify.xml"metadata = "metadata.xml"fso.copyfile inconfpath &amp; serviceIdentify,commpath &amp; serviceIdentifyfso.copyfile inconfpath &amp; systemIdentify,commpath &amp; systemIdentifyfso.copyfile svnmetadata,commpath &amp; metadataLoadTrans = tmpstrSet fso = NothingEnd Function'=======================' 更新SVN'=======================Function updateSVN()logfile.WriteLine(Now() &amp; "---&gt;开始更新 SVN .......")cmdstr = "svn update "&amp; svnpathSet exeRs = wshshell.exec(cmdstr)retmsg = exeRs.StdOut.ReadAll()logfile.WriteLine(Now() &amp; "---&gt;更新 SVN 日志如下:")logfile.WriteLine( retmsg)logfile.WriteLine(Now() &amp; "---&gt;更新 SVN 完成.......")End Function'======================='主方法'=======================Sub Main()'tranText = InputBox("请输入需要开发的交易，形如[3001300000333,双屏系统,NCBS;]","提醒","3001300000333,双屏系统,NCBS;")'==========更新SVN至最新============updateSVN'==========加载文本文件中的交易============tranText = LoadTrans()If tranText = "" ThenMsgBox "请检查[ traninfo.txt ]是否已[ 经粘贴交易 ] 或 [ 有多余空格 ]!",0,"星阳提醒"Exit SubElseAns = MsgBox("[开始处理]:   共[ " &amp;  UBound(Split(tranText,";")) &amp; " ]个交易" &amp; Chr(13) &amp; tranText,VbOKCancel,"星阳提醒")If Ans = vbCancel ThenMsgBox "你取消了操作！",0,"星阳提醒"Exit Sub End If'==========登录服务治理平台============login "admin","753951"'===========加载最新元数据=============loadMetaData()'分割每条记录trans = Split(tranText,";")'根据填写的执行方法进行tranFlow = InputBox("请输入需要执行的动作:" &amp; Chr(13) &amp; "    1.  检查交易是否为新增       [ 1 ]" &amp; Chr(13) &amp; "    2.  导出并只执行脚本         [ 2 ]" &amp; Chr(13) &amp; "    3.  导出相关配置文件         [ 3 ]" &amp; Chr(13) &amp; "    4.  修改公共文件结构         [ 4 ]" &amp; Chr(13) &amp; "    5.  比较元数据差异           [ 5 ]" &amp; Chr(13) &amp; "    6.  拷贝文件至SVN路径        [ 6 ]" &amp; Chr(13) &amp; "    7.  修改组包文件             [ 7 ]" &amp; Chr(13) &amp; "    8.  修改Metadata.xml文件     [ 8 ]" &amp; Chr(13) &amp; "    9.  运行文件比对             [ 9 ]" &amp; Chr(13) &amp; "    10. 流程全部执行             [ A ]","提醒","A")tranFlow = UCase(tranFlow)If tranFlow = "" Then MsgBox "你取消了操作！"Exit SubEnd IfFor i= 0 To UBound(trans)'分割交易明细信息  --&gt;  3001300000333,双屏系统,NCBS;If trans(i) &lt;&gt; "" Thentraninfo =  Split(trans(i),",")code = Trim(traninfo(0))from = Trim(traninfo(1))dest = Trim(traninfo(2))'=========检查交易是否为新增===========If InStr(tranFlow,"1") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThencheckTran code,from,destEnd If '==========导出并只执行脚本============If InStr(tranFlow,"2") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThenexportAndRunSQLOne(code)End If '==========导出相关配置文件============If InStr(tranFlow,"3") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThenexportConf from,dest,codeEnd If'==========修改公共文件结构============If InStr(tranFlow,"4") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThenmodifyXml from,dest,codeEnd If '===========比较元数据差异=============If InStr(tranFlow,"5") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThencompareMeteData codeEnd If '========拷贝文件至SVN路径=============If InStr(tranFlow,"6") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThencopyConfToSvn code,fromEnd If '===========修改组包文件===============If InStr(tranFlow,"7") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThenmodifyPackFile from,dest,codeEnd If End If Next'修改Metadata.xml文件If InStr(tranFlow,"8") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 ThenAddLineAfterWord svnmetadata,commpath &amp; "metadata.xml","metadata",allNewDataEnd If '运行文件比对'CompareAns = MsgBox("需要进行文件比对吗？",VbOKCancel,"星阳提醒")'If CompareAns &lt;&gt; vbCancel ThenIf InStr(tranFlow,"9") &gt; 0 Or InStr(tranFlow,"A") &gt; 0 Then'比对 serviceIdentify.xmlwshshell.run("BComp.exe " &amp; commpath &amp; "serviceIdentify.xml "&amp; inconfpath &amp;"serviceIdentify.xml")'比对 systemIdentify.xmlwshshell.run("BComp.exe " &amp; commpath &amp; "systemIdentify.xml "&amp; inconfpath &amp;"systemIdentify.xml")'比对 metadata.xmlwshshell.run("BComp.exe " &amp; commpath &amp; "metadata.xml "&amp; inconfpath &amp;"metadata\metadata.xml")'in out 比对wshshell.run("BComp.exe " &amp; outconfpath &amp; "systemIdentify.xml "&amp; inconfpath &amp;"systemIdentify.xml")wshshell.run("BComp.exe " &amp; outconfpath &amp; "metadata\metadata.xml "&amp; inconfpath &amp;"metadata\metadata.xml")'End IfEnd IfEnd Iflogfile.WriteLine(Now() &amp; "---&gt;配置文件共[" &amp; totalNum &amp; "]个")MsgBox "o(∩_∩)o 啦啦啦-&gt;[ 全部处理完成 ] o(∩_∩)o",0,"星阳提醒"End SubMain()Set http = NothingSet html = NothingSet wshshell = NothingSet xdoc = NothingSet logfso = NothingSet tranfso = Nothing<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-总结"><a href="#5-总结" class="headerlink" title="5.总结"></a>5.总结</h3><hr><p>代码不复杂，就是要把各个东西串联起来比较麻烦。在这做个备份，以防以后会用到中间的东西。</p>]]></content>
      
      
      <categories>
          
          <category> 工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 工具 </tag>
            
            <tag> vbs </tag>
            
            <tag> 效率 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HA江苏电费插件</title>
      <link href="jsdf.html"/>
      <url>jsdf.html</url>
      
        <content type="html"><![CDATA[<h3 id="0-前言介绍"><a href="#0-前言介绍" class="headerlink" title="0.前言介绍"></a>0.前言介绍</h3><hr><p>之前一直想把水电燃气都接入HA，水和燃气都接入了，电费一直没有接入。一开始尝试网上抓包，有个变量没摸透它的规律，所以没办法入手。后面发现小程序也可以查电费，所以准备从小程序入手，抓包看看能不能够有什么发现。</p><h3 id="1-抓包准备"><a href="#1-抓包准备" class="headerlink" title="1.抓包准备"></a>1.抓包准备</h3><hr><p>搜索微信小程序 <strong>国网江苏电力营业厅</strong> 抓下包。抓包的工具可以使用 <strong>Fiddler</strong>  苹果手机上可以使用 <strong>Stream</strong> 都是挺好用的。</p><h3 id="2-抓包"><a href="#2-抓包" class="headerlink" title="2.抓包"></a>2.抓包</h3><hr><p>在抓包的结果中找找有没有哪个返回金额等相关数据的。找了找，找到了 <strong><a href="https://weixin.js.sgcc.com.cn/wxapp_dlsh/wx/oauth_executeNewMini.do?openid=xxxxxxxxx&amp;timestamp=xxxxx&amp;noncestr=xxxxxxx&amp;sign=xxxxxxxx&amp;unionid=xxxxxxx&amp;userInfo=null">https://weixin.js.sgcc.com.cn/wxapp_dlsh/wx/oauth_executeNewMini.do?openid=xxxxxxxxx&amp;timestamp=xxxxx&amp;noncestr=xxxxxxx&amp;sign=xxxxxxxx&amp;unionid=xxxxxxx&amp;userInfo=null</a></strong> 这个地址。通过多次对比这个链接，发现  </p><p><strong>openid=xxxxxxxxx   //固定的</strong><br><strong>timestamp=xxxxx</strong>   <strong>// 变动的</strong></p><p><strong>noncestr=xxxxxxx</strong>  <strong>//变动的</strong><br><strong>sign=xxxxxxxx      // 变动的</strong><br><strong>unionid=xxxxxxx</strong>    <strong>//固定的</strong></p><p><strong>timestamp</strong> <strong>noncestr</strong> <strong>sign</strong> 这三个参数是有关联关系，不能够随意改动。这个地址的返回结果中也会返回这三个字段，所以我们不必考虑他们之间的关系，再次调用是，把之前的参数替换成现在最新的即可。</p><h3 id="3-编写插件"><a href="#3-编写插件" class="headerlink" title="3.编写插件"></a>3.编写插件</h3><hr><p>分析到上面那步之后插件写起来就简单了，其实就是解析参数赋值的事情了。代码如下:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""Support for guojiadianwang# Author:    freefitter# Created:    2020/9/2"""</span><span class="token keyword">import</span> logging<span class="token keyword">import</span> json<span class="token keyword">import</span> configparser<span class="token keyword">import</span> time<span class="token punctuation">,</span> datetime<span class="token keyword">from</span> dateutil<span class="token punctuation">.</span>relativedelta <span class="token keyword">import</span> relativedelta <span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>const <span class="token keyword">import</span> <span class="token punctuation">(</span>    CONF_API_KEY<span class="token punctuation">,</span> CONF_NAME<span class="token punctuation">,</span> ATTR_ATTRIBUTION<span class="token punctuation">,</span> CONF_ID    <span class="token punctuation">)</span><span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>helpers<span class="token punctuation">.</span>entity <span class="token keyword">import</span> Entity<span class="token keyword">import</span> homeassistant<span class="token punctuation">.</span>helpers<span class="token punctuation">.</span>config_validation <span class="token keyword">as</span> cv<span class="token keyword">import</span> voluptuous <span class="token keyword">as</span> vol<span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>components<span class="token punctuation">.</span>sensor <span class="token keyword">import</span> PLATFORM_SCHEMA<span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup_Log<span class="token operator">=</span>logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>DEFAULT_NAME <span class="token operator">=</span> <span class="token string">'gjdw'</span>OPENID <span class="token operator">=</span> <span class="token string">'openid'</span>NONCESTR <span class="token operator">=</span> <span class="token string">'noncestr'</span>SIGN <span class="token operator">=</span> <span class="token string">'sign'</span>UNIONID <span class="token operator">=</span> <span class="token string">'unionid'</span>TIMESTAMP1 <span class="token operator">=</span> <span class="token string">'timestamp'</span>PLATFORM_SCHEMA <span class="token operator">=</span> PLATFORM_SCHEMA<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>OPENID<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>NONCESTR<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>SIGN<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>UNIONID<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>TIMESTAMP1<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>    vol<span class="token punctuation">.</span>Optional<span class="token punctuation">(</span>CONF_NAME<span class="token punctuation">,</span> default<span class="token operator">=</span> DEFAULT_NAME<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>HEADERS <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'Host'</span><span class="token punctuation">:</span> <span class="token string">'weixin.js.sgcc.com.cn'</span><span class="token punctuation">,</span>    <span class="token string">'Connection'</span><span class="token punctuation">:</span>  <span class="token string">'keep-alive'</span><span class="token punctuation">,</span>    <span class="token string">'Content-Length'</span><span class="token punctuation">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span>    <span class="token string">'content-type'</span><span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span>    <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip,compress,br,deflate'</span><span class="token punctuation">,</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (iPhone; CPU iPhone OS 14_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 MicroMessenger/8.0.0(0x18000026) NetType/WIFI Language/zh_CN'</span><span class="token punctuation">,</span>    <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'https://servicewechat.com/wx203b37ad2ad5d2a6/32/page-frame.html'</span><span class="token punctuation">,</span><span class="token punctuation">}</span>API_URL <span class="token operator">=</span> <span class="token string">"https://weixin.js.sgcc.com.cn/wxapp_dlsh/wx/oauth_executeNewMini.do"</span><span class="token keyword">def</span> <span class="token function">setup_platform</span><span class="token punctuation">(</span>hass<span class="token punctuation">,</span> config<span class="token punctuation">,</span> add_devices<span class="token punctuation">,</span> discovery_info<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    sensor_name <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>CONF_NAME<span class="token punctuation">)</span>    openid <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>OPENID<span class="token punctuation">)</span>    unionid <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>UNIONID<span class="token punctuation">)</span>    cfg <span class="token operator">=</span> configparser<span class="token punctuation">.</span>ConfigParser<span class="token punctuation">(</span><span class="token punctuation">)</span>    cfg<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token string">'param.ini'</span><span class="token punctuation">)</span>    timestamp1 <span class="token operator">=</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Param'</span><span class="token punctuation">,</span> <span class="token string">'timestamp'</span><span class="token punctuation">)</span>    noncestr <span class="token operator">=</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Param'</span><span class="token punctuation">,</span> <span class="token string">'noncestr'</span><span class="token punctuation">)</span>    sign <span class="token operator">=</span> cfg<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Param'</span><span class="token punctuation">,</span> <span class="token string">'sign'</span><span class="token punctuation">)</span>        url <span class="token operator">=</span> API_URL <span class="token operator">+</span> <span class="token string">"?openid="</span> <span class="token operator">+</span> openid <span class="token operator">+</span><span class="token string">"&amp;timestamp="</span> <span class="token operator">+</span> timestamp1 <span class="token operator">+</span> <span class="token string">"&amp;noncestr="</span> <span class="token operator">+</span> noncestr <span class="token operator">+</span> <span class="token string">"&amp;sign="</span> <span class="token operator">+</span> sign <span class="token operator">+</span> <span class="token string">"&amp;unionid="</span> <span class="token operator">+</span> unionid <span class="token operator">+</span> <span class="token string">"&amp;userInfo=null"</span>        _Log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"url:"</span> <span class="token operator">+</span> url <span class="token punctuation">)</span>    add_devices<span class="token punctuation">(</span><span class="token punctuation">[</span>GJDW<span class="token punctuation">(</span>sensor_name<span class="token punctuation">,</span>url<span class="token punctuation">,</span>openid<span class="token punctuation">,</span>unionid<span class="token punctuation">,</span>cfg<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">GJDW</span><span class="token punctuation">(</span>Entity<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Representation of a guojiadianwang """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>sensor_name<span class="token punctuation">,</span>url<span class="token punctuation">,</span>openid<span class="token punctuation">,</span>unionid<span class="token punctuation">,</span>cfg<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>attributes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token boolean">None</span>        self<span class="token punctuation">.</span>_name <span class="token operator">=</span> sensor_name        self<span class="token punctuation">.</span>_url <span class="token operator">=</span> url        self<span class="token punctuation">.</span>_openid <span class="token operator">=</span> openid        self<span class="token punctuation">.</span>_unionid <span class="token operator">=</span> unionid        self<span class="token punctuation">.</span>_cfg <span class="token operator">=</span> cfg    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the name of the sensor."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_name    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">state</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the state of the sensor."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_state    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">icon</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""   mdi   ."""</span>        <span class="token keyword">return</span> <span class="token string">'mdi:flash'</span>    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">device_state_attributes</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the state attributes."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>attributes    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">unit_of_measurement</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the unit this state is expressed in."""</span>        <span class="token keyword">return</span> <span class="token string">"元"</span>    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token triple-quoted-string string">"""_Log.error("url:" + self._url)"""</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_url<span class="token punctuation">,</span>headers <span class="token operator">=</span> HEADERS<span class="token punctuation">)</span>        <span class="token keyword">except</span> ReadTimeout<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Connection timeout...."</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> ConnectionError<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Connection Error...."</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> RequestException<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Unknown Error"</span><span class="token punctuation">)</span>        res <span class="token operator">=</span> response<span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> res<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"html"</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"参数存在问题,请重新抓包填写"</span><span class="token punctuation">)</span>            <span class="token keyword">return</span>            <span class="token triple-quoted-string string">"""_Log.error(res)"""</span>        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>res<span class="token punctuation">)</span>        <span class="token keyword">if</span> ret<span class="token punctuation">[</span><span class="token string">"errcode"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"0000"</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token string">"owe_amt"</span> <span class="token keyword">in</span> ret<span class="token punctuation">[</span><span class="token string">"yeModel"</span><span class="token punctuation">]</span> <span class="token punctuation">:</span>                self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token builtin">round</span><span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>ret<span class="token punctuation">[</span><span class="token string">"yeModel"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"owe_amt"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'rca_flag'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"yeModel"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"rca_flag"</span><span class="token punctuation">]</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'cur_amt'</span><span class="token punctuation">]</span> <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">"yeModel"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"cur_amt"</span><span class="token punctuation">]</span>                curfeeMsg <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>ret<span class="token punctuation">[</span><span class="token string">"curfee"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'ymd'</span><span class="token punctuation">]</span> <span class="token operator">=</span> curfeeMsg<span class="token punctuation">[</span><span class="token string">"ymd"</span><span class="token punctuation">]</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'totalMoney'</span><span class="token punctuation">]</span> <span class="token operator">=</span> curfeeMsg<span class="token punctuation">[</span><span class="token string">"totalMoney"</span><span class="token punctuation">]</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'powerSum'</span><span class="token punctuation">]</span> <span class="token operator">=</span> curfeeMsg<span class="token punctuation">[</span><span class="token string">"powerSum"</span><span class="token punctuation">]</span>                dbObjMsg <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>ret<span class="token punctuation">[</span><span class="token string">"dbObj"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'stepNo'</span><span class="token punctuation">]</span> <span class="token operator">=</span> dbObjMsg<span class="token punctuation">[</span><span class="token string">"stepNo"</span><span class="token punctuation">]</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'yearAmount'</span><span class="token punctuation">]</span> <span class="token operator">=</span> dbObjMsg<span class="token punctuation">[</span><span class="token string">"yearAmount"</span><span class="token punctuation">]</span>                self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'isUpdated'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'yes'</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'rca_flag'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'-1'</span>            self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'cur_amt'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'-1'</span>            self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'isUpdated'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'no'</span>            <span class="token comment">#_Log.error("yeModel is null !")</span>            <span class="token comment"># 更新url参数 </span>            url <span class="token operator">=</span> API_URL <span class="token operator">+</span> <span class="token string">"?openid="</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_openid <span class="token operator">+</span><span class="token string">"&amp;timestamp="</span> <span class="token operator">+</span> ret<span class="token punctuation">[</span><span class="token string">"timestamp"</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&amp;noncestr="</span> <span class="token operator">+</span> ret<span class="token punctuation">[</span><span class="token string">"noncestr"</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&amp;sign="</span> <span class="token operator">+</span> ret<span class="token punctuation">[</span><span class="token string">"sign"</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&amp;unionid="</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>_unionid <span class="token operator">+</span> <span class="token string">"&amp;userInfo=null"</span>             self<span class="token punctuation">.</span>_url <span class="token operator">=</span> url            <span class="token comment"># 保存参数至文本</span>            self<span class="token punctuation">.</span>_cfg<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"Param"</span><span class="token punctuation">,</span> <span class="token string">"timestamp"</span><span class="token punctuation">,</span> ret<span class="token punctuation">[</span><span class="token string">"timestamp"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>_cfg<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"Param"</span><span class="token punctuation">,</span> <span class="token string">"noncestr"</span><span class="token punctuation">,</span> ret<span class="token punctuation">[</span><span class="token string">"noncestr"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>_cfg<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">"Param"</span><span class="token punctuation">,</span> <span class="token string">"sign"</span><span class="token punctuation">,</span> ret<span class="token punctuation">[</span><span class="token string">"sign"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>_cfg<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'param.ini'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"send request error...."</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>如果重启会导致参数失效，所以插件把变动的参数保存了下来，每次插件更新的时候将相关的参数更新进去，这样重启时间不长的话就不需要重新抓包了。</p><h3 id="4-HA配置"><a href="#4-HA配置" class="headerlink" title="4.HA配置"></a>4.HA配置</h3><hr><p>在配置文件中加上如下内容：</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> gjdw<span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'电费'</span><span class="token key atrule">openid</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxxxx-xxxxxxxxx'</span><span class="token key atrule">noncestr</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxxxx'</span><span class="token key atrule">sign</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxxxx'</span><span class="token key atrule">unionid</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxxxx'</span><span class="token key atrule">timestamp</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxxxx'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>增加  <strong>param.ini</strong> 配置文件，文件内容如下</p><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token selector">[Param]</span><span class="token constant">timestamp</span> <span class="token attr-value"><span class="token punctuation">=</span> xxxxxxxxx</span><span class="token constant">noncestr</span> <span class="token attr-value"><span class="token punctuation">=</span> xxxxxxxxx</span><span class="token constant">sign</span> <span class="token attr-value"><span class="token punctuation">=</span> xxxxxxxxx</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-成果展示"><a href="#5-成果展示" class="headerlink" title="5.成果展示"></a>5.成果展示</h3><hr><p><img src="/img/20210406/dianfei.png" alt="插件展示"></p><h3 id="6-附件下载"><a href="#6-附件下载" class="headerlink" title="6.附件下载"></a>6.附件下载</h3><hr><p><a href="/download/%E7%94%B5%E8%B4%B9%E6%8F%92%E4%BB%B6.zip">点击下载</a> 插件</p><p>或者去论坛我发的 <a href="https://bbs.hassbian.com/thread-12037-1-1.html"><strong>电费插件-这次应该全国通用了吧</strong></a> 帖子下载。</p><h3 id="7-结语"><a href="#7-结语" class="headerlink" title="7.结语"></a>7.结语</h3><hr><p>自己写写插件还是挺好玩的，最近玩了玩Node-Red和MQTT，感觉这个搞插件还是快的。有几个写好的插件可以先看看，抓了美食杰和微博热搜的数据</p><p><img src="/img/20210406/info.png" alt="MQTT插件展示"></p>]]></content>
      
      
      <categories>
          
          <category> 智能家居 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> homeassistant </tag>
            
            <tag> python </tag>
            
            <tag> 插件 </tag>
            
            <tag> 电费 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小长假游记</title>
      <link href="jq-2021-qm.html"/>
      <url>jq-2021-qm.html</url>
      
        <content type="html"><![CDATA[<h3 id="0-假期安排"><a href="#0-假期安排" class="headerlink" title="0.假期安排"></a>0.假期安排</h3><p>​    三天的小长假，回家祭祖顺便带小孩玩玩。</p><h3 id="1-第一天"><a href="#1-第一天" class="headerlink" title="1.第一天"></a>1.第一天</h3><p>​     早上早早起床，想着早点走路上不会堵车，奈何走的还是不够早，9:00了才出门。在出城的路上还是堵了一会的，上了高速后就好了很多了。回去之后已经中午了，去喝了个鸭汤就回去休息了。鸭汤没有之前的好喝了，门面也变小了。[ 图片网上找的，还是之前的店面 ]</p><p><img src="/img/20210405/jangmuya0.jpg" alt="老鸭汤的店"></p><p>下午彤妈约了闺蜜出去玩，我就和彤宝一起睡觉休息了。这一睡就到4点多了。起来弄弄之后，去接彤妈之后，顺便带彤彤见见她的阿姨们。接着晚上又是一个小饭局。</p><h3 id="2-第二天"><a href="#2-第二天" class="headerlink" title="2.第二天"></a>2.第二天</h3><p>​    今天是清明，怕路上堵，早点起床回老家祭祖。回家的路上还好，不是特别的堵。早早就到家了。到了老家小家伙就开始挖挖土了。</p><p><img src="/img/20210405/IMG_1567.jpg" alt="爱挖土宝宝0"><img src="/img/20210405/IMG_1568.jpg" alt="爱挖土宝宝1"></p><p>​    祭祖后休息了一下，约了小伙伴一起遛娃。去了一个之前一直想去但是没去的地方，天气和风景都不错。彤宝到了之后还是先挖土<span class="github-emoji"><span>😄</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>。</p><p><img src="/img/20210405/IMG_1572.jpg" alt="爱挖土宝宝2"></p><p>之前小伙伴的宝宝在睡觉，没能一起参与，好在一会她就醒了，然后捡了个风筝，就一起玩了起来了。</p><p><img src="/img/20210405/yiqi.jpg" alt="一起放风筝"></p><h3 id="3-最后一天"><a href="#3-最后一天" class="headerlink" title="3.最后一天"></a>3.最后一天</h3><p>​    很快就要和小长假说拜拜了。最后一天要早点回南京，回去给他做点面包和饺子，这样平时可以吃吃。本来想着中午早点走回不堵的，事与愿违，依然堵。走的早些时间也充裕些。回家就开始干活了，一下是牛角包的成果图，还是可以的。饺子的图没拍。下次争取都图。</p><p><img src="/img/20210405/njb.jpg" alt="牛角包"></p><h3 id="4-总结"><a href="#4-总结" class="headerlink" title="4.总结"></a>4.总结</h3><p>   三天的小长假还算快乐，期待下次的游记。<span class="github-emoji"><span>😆</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f606.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 遛娃 </tag>
            
            <tag> 游玩 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HA南京水费插件</title>
      <link href="njwater.html"/>
      <url>njwater.html</url>
      
        <content type="html"><![CDATA[<h3 id="0-插件准备"><a href="#0-插件准备" class="headerlink" title="0.插件准备"></a>0.插件准备</h3><p>a) 登录<a href="http://www.jlwater.com/login.html">南京水务</a>的官网</p><p>b) 按住F12进入开发者模式</p><p>c) 拿到cookie和客户号</p><p>结果如图：</p><p><img src="/img/njwater/njwater01.png" alt="结果截图"></p><h3 id="1-配置HA"><a href="#1-配置HA" class="headerlink" title="1.配置HA"></a>1.配置HA</h3><p>将自定义插件上传到对应的目录下</p><p>custom_components<br>└─nanjing_water<br>        sensor.py<br>        __init__.py</p><p>接着在 configuration.yaml 中添加</p><p><strong>sensor:</strong></p><p>  <strong>- platform: nanjing_water</strong><br>     <strong>name: ‘水费’</strong><br>     <strong>custno: ‘XXXXX’</strong><br>     <strong>cookies: ‘XXXXXXXXXXXXXX’</strong></p><h3 id="2-重启HA"><a href="#2-重启HA" class="headerlink" title="2.重启HA"></a>2.重启HA</h3><h3 id="3-结果展示"><a href="#3-结果展示" class="headerlink" title="3.结果展示"></a>3.结果展示</h3><p><img src="/img/njwater/njwater02.png" alt="结果截图"></p><h3 id="4-代码展示"><a href="#4-代码展示" class="headerlink" title="4.代码展示"></a>4.代码展示</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""Support for nanjing water# Author: freefitter# Created: 2019-08-21"""</span><span class="token keyword">import</span> logging<span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>const <span class="token keyword">import</span> <span class="token punctuation">(</span>    CONF_API_KEY<span class="token punctuation">,</span> CONF_NAME<span class="token punctuation">,</span> ATTR_ATTRIBUTION<span class="token punctuation">,</span> CONF_ID    <span class="token punctuation">)</span><span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>helpers<span class="token punctuation">.</span>entity <span class="token keyword">import</span> Entity<span class="token keyword">import</span> homeassistant<span class="token punctuation">.</span>helpers<span class="token punctuation">.</span>config_validation <span class="token keyword">as</span> cv<span class="token keyword">import</span> voluptuous <span class="token keyword">as</span> vol<span class="token keyword">from</span> homeassistant<span class="token punctuation">.</span>components<span class="token punctuation">.</span>sensor <span class="token keyword">import</span> PLATFORM_SCHEMA<span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup_Log<span class="token operator">=</span>logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>DEFAULT_NAME <span class="token operator">=</span> <span class="token string">'nanjing_water'</span>COOKIES <span class="token operator">=</span> <span class="token string">'cookies'</span>CUSTNO <span class="token operator">=</span> <span class="token string">'custno'</span>PLATFORM_SCHEMA <span class="token operator">=</span> PLATFORM_SCHEMA<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>    vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>COOKIES<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>    vol<span class="token punctuation">.</span>Required<span class="token punctuation">(</span>CUSTNO<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span>    vol<span class="token punctuation">.</span>Optional<span class="token punctuation">(</span>CONF_NAME<span class="token punctuation">,</span> default<span class="token operator">=</span> DEFAULT_NAME<span class="token punctuation">)</span><span class="token punctuation">:</span> cv<span class="token punctuation">.</span>string<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>HEADERS <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">,</span>    <span class="token string">'Upgrade-Insecure-Requests'</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>    <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'</span><span class="token punctuation">,</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (iPhone; CPU iPhone OS 12_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 MicroMessenger/7.0.5(0x17000523) NetType/WIFI Language/zh_CN'</span><span class="token punctuation">,</span>    <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'http://www.jlwater.com/waterFee/waterWx'</span><span class="token punctuation">,</span>    <span class="token string">'Accept-Language'</span><span class="token punctuation">:</span> <span class="token string">'zh-cn'</span><span class="token punctuation">,</span>    <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip, deflate'</span><span class="token punctuation">}</span>API_URL <span class="token operator">=</span> <span class="token string">"http://www.jlwater.com/waterFee/detail"</span><span class="token keyword">def</span> <span class="token function">setup_platform</span><span class="token punctuation">(</span>hass<span class="token punctuation">,</span> config<span class="token punctuation">,</span> add_devices<span class="token punctuation">,</span> discovery_info<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    cookies <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>COOKIES<span class="token punctuation">)</span>    custno <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>CUSTNO<span class="token punctuation">)</span>    sensor_name <span class="token operator">=</span> config<span class="token punctuation">.</span>get<span class="token punctuation">(</span>CONF_NAME<span class="token punctuation">)</span>    query_dict <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">'consNo'</span><span class="token punctuation">:</span> custno<span class="token punctuation">,</span>    <span class="token punctuation">}</span>    HEADERS<span class="token punctuation">[</span><span class="token string">"Cookie"</span><span class="token punctuation">]</span> <span class="token operator">=</span> cookies    add_devices<span class="token punctuation">(</span><span class="token punctuation">[</span>NanjingWater<span class="token punctuation">(</span>sensor_name<span class="token punctuation">,</span>query_dict<span class="token punctuation">,</span>cookies<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">NanjingWater</span><span class="token punctuation">(</span>Entity<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Representation of a Nanjing water """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>sensor_name<span class="token punctuation">,</span>query_dict<span class="token punctuation">,</span>cookies<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>attributes <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token boolean">None</span>        self<span class="token punctuation">.</span>_query_dict <span class="token operator">=</span> query_dict        self<span class="token punctuation">.</span>_name <span class="token operator">=</span> sensor_name        self<span class="token punctuation">.</span>_cookies <span class="token operator">=</span> cookies    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the name of the sensor."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_name    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">state</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the state of the sensor."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_state    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">icon</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""返回mdi图标."""</span>        <span class="token keyword">return</span> <span class="token string">'mdi:cup-water'</span>    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">device_state_attributes</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the state attributes."""</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>attributes    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">unit_of_measurement</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Return the unit this state is expressed in."""</span>        <span class="token keyword">return</span> <span class="token string">"元"</span>    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>API_URL<span class="token punctuation">,</span>params<span class="token operator">=</span>self<span class="token punctuation">.</span>_query_dict<span class="token punctuation">,</span>headers <span class="token operator">=</span> HEADERS<span class="token punctuation">)</span>        <span class="token keyword">except</span> ReadTimeout<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Connection timeout...."</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> ConnectionError<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Connection Error...."</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> RequestException<span class="token punctuation">:</span>            _Log<span class="token punctuation">.</span>error<span class="token punctuation">(</span><span class="token string">"Unknown Error"</span><span class="token punctuation">)</span>        <span class="token comment"># res = response.content.decode('utf-8')</span>        soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">,</span><span class="token string">'html.parser'</span><span class="token punctuation">)</span>        waterFee <span class="token operator">=</span> soup<span class="token punctuation">.</span>select_one<span class="token punctuation">(</span><span class="token string">"#searchFrom &gt; div:nth-child(2) &gt; div:nth-child(1)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'￥'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        lajiFee <span class="token operator">=</span> soup<span class="token punctuation">.</span>select_one<span class="token punctuation">(</span><span class="token string">"#searchFrom &gt; div:nth-child(2) &gt; div:nth-child(2)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'￥'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        weiyueFee <span class="token operator">=</span> soup<span class="token punctuation">.</span>select_one<span class="token punctuation">(</span><span class="token string">"#searchFrom &gt; div:nth-child(2) &gt; div:nth-child(3)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'￥'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        shangqijieyuFee <span class="token operator">=</span> soup<span class="token punctuation">.</span>select_one<span class="token punctuation">(</span><span class="token string">"#searchFrom &gt; div:nth-child(2) &gt; div:nth-child(4)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'￥'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        qianfeiFee <span class="token operator">=</span> soup<span class="token punctuation">.</span>select_one<span class="token punctuation">(</span><span class="token string">"#searchFrom &gt; div:nth-child(2) &gt; div:nth-child(2)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'￥'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token comment">#_Log.info("waterFee=" + waterFee)</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> waterFee        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'lajiFee'</span><span class="token punctuation">]</span> <span class="token operator">=</span> lajiFee        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'weiyueFee'</span><span class="token punctuation">]</span> <span class="token operator">=</span> weiyueFee        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'shangqijieyuFee'</span><span class="token punctuation">]</span> <span class="token operator">=</span> shangqijieyuFee        self<span class="token punctuation">.</span>attributes<span class="token punctuation">[</span><span class="token string">'qianfeiFee'</span><span class="token punctuation">]</span> <span class="token operator">=</span> qianfeiFee<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-附件下载"><a href="#5-附件下载" class="headerlink" title="5. 附件下载"></a>5. 附件下载</h3><p>附件可以去论坛上下载 <a href="https://bbs.hassbian.com/thread-11955-1-1.html">南京水费插件</a></p>]]></content>
      
      
      <categories>
          
          <category> 智能家居 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> homeassistant </tag>
            
            <tag> python </tag>
            
            <tag> 插件 </tag>
            
            <tag> 水费 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>少儿编程之Scratch</title>
      <link href="scratch.html"/>
      <url>scratch.html</url>
      
        <content type="html"><![CDATA[<h3 id="0-Scratch安装体验"><a href="#0-Scratch安装体验" class="headerlink" title="0.Scratch安装体验"></a>0.<strong>Scratch</strong>安装体验</h3><p>少儿编程软件<strong>Scratch</strong>是美国麻省理工提供的一款软件，Scratch3.0可以更好的支持外部硬件模块，并且能够与Makey,micro,We Do 2.0机器人，乐高 EV3机器人交互。</p><h3 id="1-软件下载"><a href="#1-软件下载" class="headerlink" title="1.软件下载"></a>1.软件下载</h3><p>从<a href="https://scratch.mit.edu/download">Scratch官网下载</a>，当然你也可以先从<a href="https://scratch.mit.edu/projects/editor/?tutorial=getStarted">这个地址</a>开始尝试。下载的页面和尝试的页面如下：</p><p><img src="/img/20200706/scratchdownload.png" alt="scratch下载"></p><p><img src="/img/20200706/scratchinfo.png" alt="scratch信息"></p><p>安装后的界面如下：</p><p><img src="/img/20200706/scratchdesktop.png" alt="scratch软件界面"></p><p>和网页版的基本没差。</p><h3 id="2-开始HelloWord"><a href="#2-开始HelloWord" class="headerlink" title="2.开始HelloWord"></a>2.开始HelloWord</h3><p>第一个小玩意：</p><p>代码：</p><p><img src="/img/20200706/helloworld.png" alt="helloworld图"></p><p>效果：</p><p><img src="/img/20200706/helloworld.gif" alt="helloworld"></p><h3 id="3-后续想法"><a href="#3-后续想法" class="headerlink" title="3.后续想法"></a>3.后续想法</h3><p>结合硬件做一些东西</p>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Scratch </tag>
            
            <tag> 编程 </tag>
            
            <tag> 少儿 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>智能家居体验与感受</title>
      <link href="smartHome.html"/>
      <url>smartHome.html</url>
      
        <content type="html"><![CDATA[<h2 id="0-入坑原因："><a href="#0-入坑原因：" class="headerlink" title="0.入坑原因："></a>0.入坑原因：</h2><p>​        家里装修完了，然后想自己搞点不一样的东西，能够让自己偷偷懒，还能够方便家里人使用。一开始啥也不知道，也不知道选择啥。也没有想到自己的做，想着用成熟的东西搭建自己的智能家居。正好家附近有个小米之家，去看了看。然后就入手了<a href="https://www.mi.com/buy/detail?product_id=5708&amp;cfrom=search">米家智能套装</a>，是最早一批的智能的东西。<img src="/img/20200617/mihome.jpg" alt="米家智能套装"></p><p>从这开始便开始了智能家居之旅。紧接着又入手了很多的智能设备和智能开关。现在的设备已经达到80个之多。</p><h2 id="1-米家APP体验"><a href="#1-米家APP体验" class="headerlink" title="1.米家APP体验"></a>1.米家APP体验</h2><p>​      有了这些智能设备之后，如果要让它们能够联合起来做一些事情，你得自己编写一个智能，条件可以是你现在的传感器或者他自己提供的一些东西，操作的设备只能是你的智能设备或者你的手机了，米家App基本上能够满足大部分人的需求了，但是有些像设置更细节的东西，他就爱莫能助了。</p><h2 id="2-入坑HomeAssistant"><a href="#2-入坑HomeAssistant" class="headerlink" title="2.入坑HomeAssistant"></a>2.入坑HomeAssistant</h2><p>​     有了这些硬件设备，但是又不甘于被米家App束缚，所以就开始找有没有别的啥能够支持这些智能硬件，找着找着找到HA，这个东西还是很强大的。可以自己编写传感器，可定制化程度非常高，能够完成很多米家App不能完成的事情。可以去<a href="https://bbs.hassbian.com/">瀚思彼岸</a> 论坛学习各个神的操作。</p><h2 id="3-如今的智能设备"><a href="#3-如今的智能设备" class="headerlink" title="3.如今的智能设备"></a>3.如今的智能设备</h2><p>​     现在家里的智能设备已经80多个了，很多已经接入了HA，但是还有少数设备没有接入其中。后面陆陆续续的接入到当中去。因为一开始没有买小米全家桶，所以很多的都是使用智能开关来控制设备的，所以家中的智能插座和智能开关比较多。</p><h2 id="4-后话"><a href="#4-后话" class="headerlink" title="4. 后话"></a>4. 后话</h2><p>​     智能家居还是要从开始进行规划，等自己以后有能力在买一套的时候，一定要彻头彻尾的搞一次真正的智能家居</p>]]></content>
      
      
      <categories>
          
          <category> 智能家居 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 智能家居 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo博客搭建</title>
      <link href="startPage.html"/>
      <url>startPage.html</url>
      
        <content type="html"><![CDATA[<h2 id="搭建Hexo"><a href="#搭建Hexo" class="headerlink" title="搭建Hexo"></a>搭建Hexo</h2><p>之前自己搭建<a href="http://freefitter.com:1200/">wordpress</a>的博客，网上搜索下，还有人推荐Hexo的，然后就尝试着自己搞了个玩玩，发现并不复杂<br>参照了<a href="https://www.jianshu.com/p/4818be9093f5">这个教程</a>还有<a href="https://hexo.fluid-dev.com/docs/">官方的文档</a>。三下五除二干了起来。</p><h2 id="展示"><a href="#展示" class="headerlink" title="展示"></a>展示</h2><p>   搭建完成就是这样啦! <img src="/img/20200608/pre.png" alt="成果展示"> 赶脚还行。</p><h2 id="说在最后"><a href="#说在最后" class="headerlink" title="说在最后"></a>说在最后</h2><p>   自己瞎折腾，没事整点事</p>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> 博客 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
