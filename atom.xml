<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>宁静致远</title>
  
  <subtitle>静心整理/分享生活</subtitle>
  <link href="https://www.wangxingyang.com/atom.xml" rel="self"/>
  
  <link href="https://www.wangxingyang.com/"/>
  <updated>2023-09-03T12:31:04.521Z</updated>
  <id>https://www.wangxingyang.com/</id>
  
  <author>
    <name>彤爸比</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>我上幼儿园了</title>
    <link href="https://www.wangxingyang.com/dayshare230903.html"/>
    <image>https://freefitter.synology.me:6884/uploads/big/eacc792fbdebc29751df2696a42248c9.png</image>
    
    <id>https://www.wangxingyang.com/dayshare230903.html</id>
    <published>2023-09-03T11:29:52.000Z</published>
    <updated>2023-09-03T12:31:04.521Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>彤彤今天去幼儿园体验了，感觉现在的幼儿园真的太棒了，有小菜园，有鸡鸭鹅，有游乐场，有小桥流水等等，话不多说，直接上图。还有很多教室没有图，户外的地方还是比较吸引我的。</p></blockquote><h3 id="0-带你上幼儿园"><a href="#0-带你上幼儿园" class="headerlink" title="0.带你上幼儿园"></a>0.带你上幼儿园</h3><hr><p><img src="https://freefitter.synology.me:6884/uploads/medium/7acb52d6728fa2f9648a732d826f63e1.png" alt="小红花"></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/758ef74d120e26a9cc969d903e51610e.png" alt="运动"></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/6fde7065f7efd62d44a7ef3d555b5bb8.png" alt="就是玩"></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/c9cec6e71ac831cfe33c5d63ebfcc020.png" alt="还是玩"></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/d98785d3e44d43c17af6d89d55c428c0.png" alt="爱劳动的"></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/cf5199dacc5f6f7196a018af4644a9ea.png" alt="老师教做小绵羊"></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/40f190b149f5887cb50d1ef1fc8baba6.png" alt="看看我的作品"></p><p><img src="https://freefitter.synology.me:6884/uploads/big/4ada2aea6dcd0baeb01cdac63144df1a.png" alt="签到台"></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/0a02c33482724c52214a7bdcb935c97b.png" alt="山洞探索"></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/c0cf1efb5e563a90a6d106b7d3501ac0.png" alt="准备滑索"></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/0fe64161fcc357120cac681c6855ca20.png" alt="滑索"></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/42f8d6c8d6d04ffd0ad627bc33f4e648.png" alt="菜地"></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/76ced99b95f8dc9b7c2a20c3e58e9280.png" alt="鸡鸭鹅"></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/c364fc8e2baf10fc3808cddacc98daa4.png" alt="玩水"></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/dff6a34b68faf2a692706e926e2a9556.png" alt="骑车"></p><h3 id="1-感受"><a href="#1-感受" class="headerlink" title="1.感受"></a>1.感受</h3><hr><p>希望彤宝的幼儿园生活丰富多彩，开心快乐每一天。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;彤彤今天去幼儿园体验了，感觉现在的幼儿园真的太棒了，有小菜园，有鸡鸭鹅，有游乐场，有小桥流水等等，话不多说，直接上图。还有很多教室没有图，户外的地方还是比较吸引我的。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;0-带你上幼儿园&quot;&gt;&lt;a h</summary>
      
    
    
    
    <category term="生活" scheme="https://www.wangxingyang.com/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
    <category term="幼儿园" scheme="https://www.wangxingyang.com/tags/%E5%B9%BC%E5%84%BF%E5%9B%AD/"/>
    
    <category term="上学" scheme="https://www.wangxingyang.com/tags/%E4%B8%8A%E5%AD%A6/"/>
    
    <category term="小红花" scheme="https://www.wangxingyang.com/tags/%E5%B0%8F%E7%BA%A2%E8%8A%B1/"/>
    
  </entry>
  
  <entry>
    <title>openwrt编译</title>
    <link href="https://www.wangxingyang.com/openwrt.html"/>
    <image>https://freefitter.synology.me:6884/uploads/big/cff71c0472468acabb21343b3c59d453.png</image>
    
    <id>https://www.wangxingyang.com/openwrt.html</id>
    <published>2023-09-02T06:44:09.000Z</published>
    <updated>2023-09-02T06:57:59.503Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>今天想来折腾下怎么制作openwrt的固件，想自己做一个然后刷到AX6S上去，下面就来说说我的过程。</p></blockquote><h3 id="0-准备工作"><a href="#0-准备工作" class="headerlink" title="0.准备工作"></a>0.准备工作</h3><hr><p>要有一个能科学上网的环境，然后是liunx系统，这里用的是虚拟机</p><h3 id="1-开始编译"><a href="#1-开始编译" class="headerlink" title="1. 开始编译"></a>1. 开始编译</h3><hr><p>按照教程开始编译，虚机的内存和磁盘空间一定要给够，不然会失败的。别问我怎么知道的。教程在相关链接中。整个过程会非常的漫长，建议适时做好备份，这样不用从头再来。</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh"># 安装依赖sudo apt update -ysudo apt full-upgrade -ysudo apt install -y ack antlr3 asciidoc autoconf automake autopoint binutils bison build-essential \bzip2 ccache cmake cpio curl device-tree-compiler fastjar flex gawk gettext gcc-multilib g++-multilib \git gperf haveged help2man intltool libc6-dev-i386 libelf-dev libglib2.0-dev libgmp3-dev libltdl-dev \libmpc-dev libmpfr-dev libncurses5-dev libncursesw5-dev libreadline-dev libssl-dev libtool lrzsz \mkisofs msmtp nano ninja-build p7zip p7zip-full patch pkgconf python2.7 python3 python3-pyelftools \libpython3-dev qemu-utils rsync scons squashfs-tools subversion swig texinfo uglifyjs upx-ucl unzip \vim wget xmlto xxd zlib1g-dev python3-setuptools# 下载源码git clone https://github.com/coolsnowwolf/ledecd lede./scripts/feeds update -a./scripts/feeds install -a# 设置编译的配置make menuconfig# 下载 dl 库，编译固件make download -j8make V=s -j1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>编译时发现空间不够，使用<code>gparted</code>工具扩容遇到只读系统问题，解决方案如下:</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">sudo -imount -o remount -rw /mount -o remount -rw /var/snap/firefox/common/host-hunspell<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>下面是空间使用情况，除了系统外就是他了，没装别的，最好超过30G<br><img src="https://freefitter.synology.me:6884/uploads/big/955ef978c168f781c519b89953250c9b.png" alt="空间大小"><br>编译好的文件如下，也尝试刷了一下，没成功，最后有恢复了<br><img src="https://freefitter.synology.me:6884/uploads/big/b21494a1660151c2546b9bbaa7d38deb.png" alt="编译结果"><br>如果变砖了，用<a href="http://www1.miwifi.com/miwifi_download.html">小米路由器修复工具</a>恢复。</p><h3 id="2-总结"><a href="#2-总结" class="headerlink" title="2.总结"></a>2.总结</h3><hr><p>网络设备还是稳定的好，没事别折腾。后面想折腾，单独搞个路由器折腾，在用的还是稳定为好。不过好在最后也编译出了固件，知道了大概的流程，之后搞就会快很多。</p><h3 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h3><hr><ol><li><a href="https://mirror.tuna.tsinghua.edu.cn/help/ubuntu/">Ubuntu 软件仓库镜像使用帮助</a></li><li><a href="https://zhuanlan.zhihu.com/p/633718128">教你如何编译OpenWrt，定制属于自己的固件</a></li><li><a href="https://github.com/coolsnowwolf/lede">欢迎来到 Lean 的 LEDE 源码仓库</a></li><li><a href="https://blog.csdn.net/weixin_45730522/article/details/128661183">VMware Ubuntu使用gparted工具扩容，显示Unable to resize read-only file system</a></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;今天想来折腾下怎么制作openwrt的固件，想自己做一个然后刷到AX6S上去，下面就来说说我的过程。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;0-准备工作&quot;&gt;&lt;a href=&quot;#0-准备工作&quot; class=&quot;headerlink&quot; ti</summary>
      
    
    
    
    <category term="路由器" scheme="https://www.wangxingyang.com/categories/%E8%B7%AF%E7%94%B1%E5%99%A8/"/>
    
    
    <category term="openwrt" scheme="https://www.wangxingyang.com/tags/openwrt/"/>
    
    <category term="固件制作" scheme="https://www.wangxingyang.com/tags/%E5%9B%BA%E4%BB%B6%E5%88%B6%E4%BD%9C/"/>
    
  </entry>
  
  <entry>
    <title>小米AX6S刷openwrt</title>
    <link href="https://www.wangxingyang.com/ax6sopenwrt.html"/>
    <image>https://freefitter.synology.me:6884/uploads/big/bc105250750286782284f53ec6d05ccd.png</image>
    
    <id>https://www.wangxingyang.com/ax6sopenwrt.html</id>
    <published>2023-08-28T15:10:50.000Z</published>
    <updated>2023-09-02T06:53:40.442Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p> 前不久折腾了下香橙派，家里的小米AX6S我也想折腾一下，之前华硕刷了不稳定，看看这个行不行。</p></blockquote><h3 id="0-准备工作"><a href="#0-准备工作" class="headerlink" title="0.准备工作"></a>0.准备工作</h3><hr><p>刷机包和网线，需要提前配置好，相关软件可以在 <a href="https://github.com/YangWang92/AX6S-unlock/tree/master">AX6S-unlock</a> ，里面有刷机包、解码工具和教程。</p><h3 id="1-开始刷机"><a href="#1-开始刷机" class="headerlink" title="1.开始刷机"></a>1.开始刷机</h3><hr><p><img src="https://freefitter.synology.me:6884/uploads/big/c0dfd3253a9439d1462ef71fd8b7fd4f.png"></p><ol><li><p>首先需要刷入 <code>miwifi_rb03_firmware_stable_1.2.7.bin</code> 这个固件</p></li><li><p>根据 <em><strong>S/N</strong></em> 通过 <em><strong>unlock_pwd.py</strong></em> 这个程序解密出root密码</p></li><li><p>使用<em><strong>telnet</strong></em> 命令进入系统， 并输入一下命令</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">nvram set ssh_en=1 &amp;&amp; nvram set uart_en=1 &amp;&amp; nvram set boot_wait=on &amp;&amp; nvram set bootdelay=3 &amp;&amp; nvram set flag_try_sys1_failed=0 &amp;&amp; nvram set flag_try_sys2_failed=1nvram set flag_boot_rootfs=0 &amp;&amp; nvram set "boot_fw1=run boot_rd_img;bootm"nvram set flag_boot_success=1 &amp;&amp; nvram commit &amp;&amp; /etc/init.d/dropbear enable &amp;&amp; /etc/init.d/dropbear start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://freefitter.synology.me:6884/uploads/big/8b9d56843750874741c75d7ba165f789.png" title="进入系统"></p></li><li><p>上传刷机包<br>使用python来获得刷机包，刷机包放在执行的路径下面，执行如下命令：该命令在自己的电脑上执行</p><pre class="line-numbers language-py" data-language="py"><code class="language-py">python -m http.server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://freefitter.synology.me:6884/uploads/big/610476c98c17dc40fb52cc1efbf0c20d.png" alt="6ac7f9e94395e0d92dcc4290a763fb17.png" title="获得底包"><br>通过ssh连接到路由器，执行以下命令,IP需要更改成自己电脑的IP:</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">cd /tmpwget http://192.168.31.123:8000/factory.binmtd -r write factory.bin firmware<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://freefitter.synology.me:6884/uploads/big/7b93880bdc26eb6287e8e0fdbd1c2ecc.png" title="刷入底包"><br>等路由器重启结束就可以刷入升级包了。刷机成功后的界面。<br><img src="https://freefitter.synology.me:6884/uploads/big/d45a5ac1fd7ff1e66bbb1a24f7e1fb4d.png" alt="b9e12d453a9c9635e6bf3dd957b7ef01.png"></p></li></ol><h3 id="2-相关连接"><a href="#2-相关连接" class="headerlink" title="2.相关连接"></a>2.相关连接</h3><p><a href="https://github.com/YangWang92/AX6S-unlock/">AX6S-unlock</a><br><a href="https://forum.openwrt.org/t/adding-openwrt-support-for-xiaomi-redmi-router-ax6s-xiaomi-router-ax3200/111085">Adding OpenWrt support for Xiaomi “Redmi Router AX6S”/”Xiaomi Router AX3200”</a><br><a href="https://www.right.com.cn/forum/thread-8214026-1-1.html">[AX6S] [更新][220423]红米AX6S OpenWrt官方master分支自用养老固件 </a><br><a href="https://www.right.com.cn/forum/thread-8187405-1-1.html">[AX6S] [2-2]AX6S 闭源无线驱动Openwrt 刷机教程/固件下载</a><br><a href="https://openwrt.org/toh/xiaomi/ax3200">Xiaomi AX3200 / Redmi AX6S</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt; 前不久折腾了下香橙派，家里的小米AX6S我也想折腾一下，之前华硕刷了不稳定，看看这个行不行。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;0-准备工作&quot;&gt;&lt;a href=&quot;#0-准备工作&quot; class=&quot;headerlink&quot; title</summary>
      
    
    
    
    <category term="路由器" scheme="https://www.wangxingyang.com/categories/%E8%B7%AF%E7%94%B1%E5%99%A8/"/>
    
    
    <category term="AX6S" scheme="https://www.wangxingyang.com/tags/AX6S/"/>
    
    <category term="openwrt" scheme="https://www.wangxingyang.com/tags/openwrt/"/>
    
    <category term="小米" scheme="https://www.wangxingyang.com/tags/%E5%B0%8F%E7%B1%B3/"/>
    
  </entry>
  
  <entry>
    <title>香橙派</title>
    <link href="https://www.wangxingyang.com/orangepi.html"/>
    <image>https://freefitter.synology.me:6884/uploads/big/512e78f14d8db780dca635dd7a2472c2.png</image>
    
    <id>https://www.wangxingyang.com/orangepi.html</id>
    <published>2023-08-15T13:59:00.000Z</published>
    <updated>2023-08-15T14:23:22.769Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>最近入手了一个香橙派，收到了就给他烧了<code>Ubuntu</code>的系统，装上了<a href="https://shumeipai.nxez.com/2017/08/31/pi-dashboard-released.html">Pi Dashboard</a> 和 <a href="https://pi-hole.net/">Pi-hole</a>，这样可以直观的看到派的状态和进行广告拦截，下面是折腾的历程。</p></blockquote><h3 id="0-准备工作"><a href="#0-准备工作" class="headerlink" title="0.准备工作"></a>0.准备工作</h3><hr><p><strong>硬件：</strong> <code>香橙派</code>，<code>TF内存卡</code>，<code>读卡器</code>，<code>5V3A/5V2A C口的电源和数据线</code>，<code>外壳</code><br><strong>软件：</strong>  <em><a href="http://www.orangepi.cn/html/hardWare/computerAndMicrocontrollers/service-and-support/Orange-Pi-Zero-3.html">Orange Pi Zero3相关软件</a>  ， <a href="https://etcher.balena.io/">balenaEtcher</a></em><br>软件在官网都是有的，可以直接下载</p><p><em><strong>购物清单：</strong></em></p><p><img src="https://freefitter.synology.me:6884/uploads/medium/cdbdf89e28897269626dac5bad8a0979.png" alt="购物清单" title="购物清单"></p><h3 id="1-烧录系统"><a href="#1-烧录系统" class="headerlink" title="1.烧录系统"></a>1.烧录系统</h3><hr><p>下载完成之后，用<code>balenaEtcher</code>把镜像烧进去，烧完之后给派插上<strong>内存卡</strong>和<strong>网线</strong>，加电启动。查看路由器的控制台，找到派的IP地址，通过 <em><strong>Xshell</strong></em> 连接到派。派的默认用户名密码可以在官网的用户手册中查到。</p><table><thead><tr><th align="center">账号</th><th align="center">密码</th></tr></thead><tbody><tr><td align="center">root</td><td align="center">orangepi</td></tr><tr><td align="center">orangepi</td><td align="center">orangepi</td></tr></tbody></table><p>查到之后就可以登录到<code>派</code>进行操作了。连接<code>WIFI</code>使用下面命令bash</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 扫描wifi</span>nmcli dev wifi<span class="token comment"># 连接wifi</span><span class="token function">sudo</span> nmcli dev wifi connect WIFI_NAME password WIFI_PW<span class="token comment"># 查看连接地址</span><span class="token function">ip</span> addr show wlan0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-安装软件"><a href="#2-安装软件" class="headerlink" title="2.安装软件"></a>2.安装软件</h3><hr><h4 id="①-Pi-Dashboard-Pi-仪表盘"><a href="#①-Pi-Dashboard-Pi-仪表盘" class="headerlink" title="①. Pi Dashboard - Pi 仪表盘"></a>①. Pi Dashboard - Pi 仪表盘</h4><p>安装<a href="https://shumeipai.nxez.com/2017/08/31/pi-dashboard-released.html">Pi Dashboard</a>的教程在这，参看这个就可以安装成功。如果php找不到包，可以执行以下命令：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 如果php找不到相关包，执行以下命令</span><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> software-properties-common<span class="token function">sudo</span> add-apt-repository ppa:ondrej/php<span class="token function">sudo</span> <span class="token function">apt</span> update<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>安装成功后如图：<br><img src="https://freefitter.synology.me:6884/uploads/big/8694b239745db43a45f641d5712a5962.png" title="安装完成"><br>树莓派的图：<br><img src="https://freefitter.synology.me:6884/uploads/big/2db2490951d000bab082d648c38ace97.png" title="树莓派"></p><h4 id="②-Pi-hole-广告屏蔽助手"><a href="#②-Pi-hole-广告屏蔽助手" class="headerlink" title="②. Pi-hole - 广告屏蔽助手"></a>②. Pi-hole - 广告屏蔽助手</h4><p>安装<a href="https://pi-hole.net/">Pi-hole</a>广告拦截，这个安装比较慢，需要科学上网，配置好梯子之后使用下面的命令进行代理：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">http_proxy</span><span class="token operator">=</span><span class="token string">"http://192.2.33.22:10987"</span><span class="token builtin class-name">export</span> <span class="token assign-left variable">https_proxy</span><span class="token operator">=</span><span class="token string">"http://192.2.33.22:10987"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>安装完成需要配置下路由器，华硕的路由可以参看<a href="https://www.asus.com.cn/support/FAQ/1046062/">[无线路由器] 在华硕无线路由器中如何设置Pi-Hole?</a><br>配置完成后就能够看到如下的界面了：<br><img src="https://freefitter.synology.me:6884/uploads/big/3bf34851e830380151aff1a3c427d4bd.png" alt="完成截图" title="完成截图"></p><h3 id="3-总结"><a href="#3-总结" class="headerlink" title="3.总结"></a>3.总结</h3><hr><p>之前这两个软件都安装过，现在的树莓派上运行着<code>Pi dashboard</code> 、<code>v2rayA</code> 、<code>Node-Red</code> 和 <code>Homebridge</code>，这么多的软件运行相当的稳定，占用也不多。后续加东西可以再香橙派上折腾，看看它稳不稳。</p><h3 id="4-相关Blocklists"><a href="#4-相关Blocklists" class="headerlink" title="4.相关Blocklists"></a>4.相关Blocklists</h3><hr><p><a href="https://firebog.net/">The Big Blocklist Collection</a><br><a href="https://avoidthehack.com/best-pihole-blocklists">Avoid The Hack: The Best Pi-Hole Blocklists (2023)</a><br><a href="https://github.com/topics/pihole-ads-list">pihole-ads-list</a><br><a href="https://filterlists.com/">filterlists</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;最近入手了一个香橙派，收到了就给他烧了&lt;code&gt;Ubuntu&lt;/code&gt;的系统，装上了&lt;a href=&quot;https://shumeipai.nxez.com/2017/08/31/pi-dashboard-released.html&quot;&gt;Pi D</summary>
      
    
    
    
    <category term="香橙派" scheme="https://www.wangxingyang.com/categories/%E9%A6%99%E6%A9%99%E6%B4%BE/"/>
    
    
    <category term="Pi-hole" scheme="https://www.wangxingyang.com/tags/Pi-hole/"/>
    
    <category term="pi-dashboard" scheme="https://www.wangxingyang.com/tags/pi-dashboard/"/>
    
    <category term="香橙派" scheme="https://www.wangxingyang.com/tags/%E9%A6%99%E6%A9%99%E6%B4%BE/"/>
    
  </entry>
  
  <entry>
    <title>M5Core-Ink初体验</title>
    <link href="https://www.wangxingyang.com/m5stack-coreink.html"/>
    <image>https://freefitter.synology.me:6884/uploads/big/48cc683cbf88d62315b021aae426bac3.png</image>
    
    <id>https://www.wangxingyang.com/m5stack-coreink.html</id>
    <published>2023-05-16T13:19:15.000Z</published>
    <updated>2023-05-16T13:55:17.922Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>先前在海鲜市场买了一个M5Core-Ink，准备折腾一下，准备整个天气和基金的涨跌显示。</p></blockquote><h3 id="0、准备工作"><a href="#0、准备工作" class="headerlink" title="0、准备工作"></a>0、准备工作</h3><hr><p>需要按照官方的要求安装相关驱动以及开发工具。<a href="https://docs.m5stack.com/zh_CN/quick_start/coreink/arduino">Arduino IDE 环境搭建 - M5Core-Ink</a>，链接在这里，按照上面进行配置就行了，期间可能需要魔法，可以参看之前的博客。配置的地方在<strong>File -&gt; Preferences –&gt; Network</strong>这里配置。<br><img src="https://freefitter.synology.me:6884/uploads/big/a3e93b04ba96c7bf636e38da0f9b0af1.png"></p><h3 id="1、开始编码"><a href="#1、开始编码" class="headerlink" title="1、开始编码"></a>1、开始编码</h3><hr><p>先去GitHub上找找有没有类似的项目，直接搜索<strong>coreink</strong>能找到一些项目，因为自己之前也没怎么写过，所以找了一个<a href="https://github.com/wararyo/coreink-weather">CoreInk-Weather</a>进行改写。期间也看了一下其他的，因为这个不能显示中文，所以还参看了<a href="https://github.com/massaJPN/M5COREINK_CLOCK">M5COREINK_CLOCK</a>这个项目。之前获得天气的api不能用，所以换了一个之前自己用的，其他的就没啥了。代码也不是很复杂，搞搞就能显示了。下面是代码：</p><pre class="line-numbers language-i" data-language="i"><code class="language-i">#include &lt;WiFi.h&gt;#include &lt;HTTPClient.h&gt;#include &lt;ArduinoJson.h&gt;#include &lt;Preferences.h&gt;#include "M5CoreInk.h"#include "esp_adc_cal.h"#include "images/cloudy.c"#include "images/rainy.c"#include "images/rainyandcloudy.c"#include "images/snow.c"#include "images/sunny.c"#include "images/sunnyandcloudy.c"#include "font/efontEnableCn.h" #include "font/efont.h"#include "font/efontM5StackCoreInk.h" //https://github.com/tanakamasayuki/efontInk_Sprite weatherSprite(&amp;M5.M5Ink);Ink_Sprite fundSprite(&amp;M5.M5Ink);  //创建 M5Ink实例Ink_Sprite temperatureSprite(&amp;M5.M5Ink);// 天气接口const char* endpoint = "http://www.nmc.cn/rest/weather?stationid=58238";uint8_t hour = 0 ,minutes = 0;RTC_TimeTypeDef RTCtime;Preferences preferences;void setup() {    M5.begin(); //Initialize CoreInk. 初始化 CoreInk    if( !M5.M5Ink.isInit()){  //check if the initialization is successful. 检查初始化是否成功      Serial.printf("Ink Init faild");      while (1) delay(100);    }    M5.M5Ink.clear(); //clear the screen. 清屏    Serial.begin(115200);    WiFi.begin("DDNT","1234567890");    //weatherSprite.creatSprite(0,0,200,200);    //fundSprite.creatSprite(0,0,200,200);    //temperatureSprite.creatSprite(0,0,200,200);    weatherSprite.creatSprite(0,0,120,105);    temperatureSprite.creatSprite(120,0,80,105);    fundSprite.creatSprite(0,105,200,64);    while (WiFi.status() != WL_CONNECTED) {        delay(2500);        Serial.println("Connecting to WiFi..");    }    Serial.println("Connected to the WiFi network");    //drawWeather();    //drawFund();    //WiFi.disconnect();    M5.update();}void flushTimePage(){    Serial.printf("update page....");    while(1)    {        M5.rtc.GetTime(&amp;RTCtime);        if( minutes != RTCtime.Minutes )        {            minutes = RTCtime.Minutes;            while (WiFi.status() != WL_CONNECTED) {              WiFi.reconnect();              delay(2500);            }            drawWeather();             drawFund();            if( hour != RTCtime.Hours){              hour = RTCtime.Hours;              weatherSprite.clear( CLEAR_DRAWBUFF | CLEAR_LASTBUFF );              temperatureSprite.clear( CLEAR_DRAWBUFF | CLEAR_LASTBUFF );            }            fundSprite.clear( CLEAR_DRAWBUFF | CLEAR_LASTBUFF );            if(WiFi.status() == WL_CONNECTED){              WiFi.disconnect();            }            Serial.println ("ShutDown");            M5.shutdown(48); //original 58 -&gt; 53            //it only is reached when the USB is connected            Serial.println ("USB Power");            delay(45*1000);  // original 55 -&gt;50            Serial.println ("Restart");            ESP.restart();        }        M5.update();        if( M5.BtnPWR.wasPressed())        {            digitalWrite(LED_EXT_PIN,LOW);            saveBool("clock_suspend",false);            M5.shutdown();        }        if( M5.BtnMID.wasPressed()){          M5.M5Ink.clear(); //clear the screen. 清屏        };        if( M5.BtnDOWN.wasPressed()) break;    }    weatherSprite.clear( CLEAR_DRAWBUFF | CLEAR_LASTBUFF );    fundSprite.clear( CLEAR_DRAWBUFF | CLEAR_LASTBUFF );    temperatureSprite.clear( CLEAR_DRAWBUFF | CLEAR_LASTBUFF );}void loop() {    flushTimePage();    if( M5.BtnPWR.wasPressed())    {        Serial.printf("Btn %d was pressed \r\n",BUTTON_EXT_PIN);        digitalWrite(LED_EXT_PIN,LOW);        M5.shutdown();    }    M5.update();}void saveBool(String key, bool value){    preferences.begin("M5CoreInk", false);    preferences.putBool(key.c_str(), value);    preferences.end();}bool loadBool(String key) {    preferences.begin("M5CoreInk", false);    bool keyvalue =preferences.getBool(key.c_str(),false);    preferences.end();    return keyvalue;}float getBatVoltage(){    analogSetPinAttenuation(35,ADC_11db);    esp_adc_cal_characteristics_t *adc_chars = (esp_adc_cal_characteristics_t *)calloc(1, sizeof(esp_adc_cal_characteristics_t));    esp_adc_cal_characterize(ADC_UNIT_1, ADC_ATTEN_DB_11, ADC_WIDTH_BIT_12, 3600, adc_chars);    uint16_t ADCValue = analogRead(35);    uint32_t BatVolmV  = esp_adc_cal_raw_to_voltage(ADCValue,adc_chars);    float BatVol = float(BatVolmV) * 25.1 / 5.1 / 1000;    return BatVol;}void drawWeather() {    Serial.println("start drawWeather");    DynamicJsonDocument weatherdata(20000);    if ((WiFi.status() == WL_CONNECTED)) {        HTTPClient http;        http.begin(endpoint);        int httpCode = http.GET();        if (httpCode &gt; 0) {            String jsonString = http.getString();            deserializeJson(weatherdata, jsonString);        } else {            Serial.println("Error on HTTP request");        }        http.end();     }    String weather = weatherdata["data"]["real"]["weather"]["info"];    if (weather.indexOf("雨") != -1) {        if (weather.indexOf("多云") != -1) {            weatherSprite.drawBuff(5,5,108,96,rainyandcloudy);        } else {            weatherSprite.drawBuff(5,5,108,96,rainy);        }    } else if (weather.indexOf("晴") != -1) {        if (weather.indexOf("多云") != -1) {            weatherSprite.drawBuff(5,5,108,96,sunnyandcloudy);        } else {            weatherSprite.drawBuff(5,5,108,96,sunny);        }    } else if (weather.indexOf("雪") != -1) {            weatherSprite.drawBuff(5,5,108,96,snow);    } else if (weather.indexOf("多云") != -1) {            weatherSprite.drawBuff(5,5,108,96,sunnyandcloudy);    }else{      weatherSprite.drawBuff(5,5,108,96,sunny);    }    weatherSprite.pushSprite();    String maxTemperature = weatherdata["data"]["real"]["weather"]["temperature"]; //温度    String minTemperature = weatherdata["data"]["real"]["weather"]["feelst"]; // 体感温度    String humidity = weatherdata["data"]["real"]["weather"]["humidity"]; // 湿度    String wind = weatherdata["data"]["real"]["wind"]["power"]; // 风速    float f=getBatVoltage();    String tmp = "天气:"+ weather ;    printEfont(&amp;temperatureSprite, const_cast&lt;char*&gt;(tmp.c_str()), 0, 10 + 16*0);    tmp = "温度:" + maxTemperature;    printEfont(&amp;temperatureSprite, const_cast&lt;char*&gt;(tmp.c_str()), 0, 10 + 16*1);    tmp = "体感:" + minTemperature;    printEfont(&amp;temperatureSprite, const_cast&lt;char*&gt;(tmp.c_str()), 0, 10 +16*2);    tmp = "湿度:" + humidity;    printEfont(&amp;temperatureSprite, const_cast&lt;char*&gt;(tmp.c_str()), 0, 10 +16*3);    tmp = "风速:" + wind;    printEfont(&amp;temperatureSprite, const_cast&lt;char*&gt;(tmp.c_str()), 0, 10 +16*4);    char s[10];    String dy = dtostrf(f,1,2,s);    tmp = "电压:" + dy;    printEfont(&amp;temperatureSprite, const_cast&lt;char*&gt;(tmp.c_str()), 0, 10 +16*5);    temperatureSprite.pushSprite();}void drawFund() {  // http://fundgz.1234567.com.cn/js/007380.js  Serial.println("start drawFund");  String prefix = "http://fundgz.1234567.com.cn/js/";  String code ="007380";  String postfix =".js";   String url = prefix + code + postfix;  const char* fundUrl = url.c_str();  Serial.println(fundUrl);  DynamicJsonDocument funddata(1000);  if ((WiFi.status() == WL_CONNECTED)) {    HTTPClient http;    http.begin(fundUrl);    int httpCode = http.GET();    if(httpCode &gt; 0) {      String jsonString = http.getString();      jsonString.replace("jsonpgz(","");      jsonString.replace(");","");      deserializeJson(funddata, jsonString);    }else{      Serial.println("Error on HTTP request");    }    http.end();   }  String fundcode = funddata["fundcode"] ;  String name = funddata["name"];  String gszzl = funddata["gszzl"];  String tmp = fundcode + " | " + gszzl;  printEfont(&amp;fundSprite, const_cast&lt;char*&gt;(tmp.c_str()), 0, 0);  printEfont(&amp;fundSprite, const_cast&lt;char*&gt;(name.c_str()), 0, 0 + 16*1);  code = "000217";  url = prefix + code + postfix;  const char* fundUrl1 = url.c_str();  Serial.println(fundUrl1);  if ((WiFi.status() == WL_CONNECTED)) {    HTTPClient http;    http.begin(fundUrl1);    int httpCode = http.GET();    if(httpCode &gt; 0) {      String jsonString = http.getString();      jsonString.replace("jsonpgz(","");      jsonString.replace(");","");      deserializeJson(funddata, jsonString);    }else{      Serial.println("Error on HTTP request");    }    http.end();   }  String fundcode1 = funddata["fundcode"];  String name1 = funddata["name"];  String gszzl1 = funddata["gszzl"];  String tmp1 = fundcode1 + " | " + gszzl1;  printEfont(&amp;fundSprite, const_cast&lt;char*&gt;(tmp1.c_str()), 0, 0 + 16 * 2);  printEfont(&amp;fundSprite, const_cast&lt;char*&gt;(name1.c_str()), 0, 0 + 16 * 3);  fundSprite.pushSprite();}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2、难点坑点"><a href="#2、难点坑点" class="headerlink" title="2、难点坑点"></a>2、难点坑点</h3><hr><p><strong>问题1：</strong> 中文显示用了<a href="https://github.com/tanakamasayuki/efont">efont</a>  这个项目，但是他的中文太大了，空间不够。<br><strong>解决方案:</strong> 把之前文件里的<em><strong>efontEnableCn</strong></em>清空，然后自己用什么字，加什么字。</p><p><strong>问题2：</strong> 之前联网是用的自己手机开的热点，想用电脑开热点，但是开的是<strong>5G</strong>的，根本搜不到。连不上网就没啥意思了。<br><strong>解决方案:</strong> 参看这个链接<a href="https://zhidao.baidu.com/question/1802499461195297227.html">我的联想笔记本电脑打开热点只有5G，我想改为2.4G怎么办，系统是win10的</a><br>你可以试试把无线网卡的频段改成有线2.4G试试。</p><ol><li>右键右下角网络图标，选择“打开网络共享中心”。</li><li>选择左侧“更改适配器设置”。</li><li>在“WLAN”上右键，选择“属性”’。</li><li>在弹出的窗口上点击右侧“配置”。</li><li>标签栏选择“高级”。</li><li>拖动滚动条，可以看到“首选频带”，更改为首选2.4G频带。</li></ol><h3 id="3、成果展示"><a href="#3、成果展示" class="headerlink" title="3、成果展示"></a>3、成果展示</h3><hr><p><img src="https://freefitter.synology.me:6884/uploads/medium/3ab3a7ba8e125d00b8967fb5d80d4d8c.png" alt="成果展示"></p><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><hr><p><a href="https://github.com/tanakamasayuki/efont">efont</a><br><a href="https://github.com/wararyo/coreink-weather">CoreInk-Weather</a><br><a href="https://github.com/erikflowers/weather-icons">weather-icons</a><br><a href="https://github.com/massaJPN/M5COREINK_CLOCK">M5COREINK_CLOCK</a><br><a href="https://zhidao.baidu.com/question/1802499461195297227.html">我的联想笔记本电脑打开热点只有5G，我想改为2.4G怎么办，系统是win10的</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;先前在海鲜市场买了一个M5Core-Ink，准备折腾一下，准备整个天气和基金的涨跌显示。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;0、准备工作&quot;&gt;&lt;a href=&quot;#0、准备工作&quot; class=&quot;headerlink&quot; title=&quot;0</summary>
      
    
    
    
    <category term="学习" scheme="https://www.wangxingyang.com/categories/%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="M5Stack" scheme="https://www.wangxingyang.com/tags/M5Stack/"/>
    
    <category term="墨水屏" scheme="https://www.wangxingyang.com/tags/%E5%A2%A8%E6%B0%B4%E5%B1%8F/"/>
    
    <category term="ESP32" scheme="https://www.wangxingyang.com/tags/ESP32/"/>
    
  </entry>
  
</feed>
